BF_ShareEmail=function(){this.ERR_MESS=local.t("Please enter two email addresses.");this.current_button=null;this.from_email="";this.vertical="";this.init=function(){shareEmail.current_button=null;shareEmail.assign_handlers();shareEmail.draw_catcha()};this.assign_handlers=function(){universal_dom.assign_handler({bucket:"share-email-submit",handler:shareEmail.submit,event:"click"});universal_dom.assign_handler({bucket:"share-email-cancel",handler:shareEmail.hide_email_form,event:"click"});universal_dom.assign_handler({bucket:"newsletter_checkbox",handler:shareEmail.newsletter_checkbox,event:"click"});universal_dom.assign_handler({bucket:"email-signup",handler:shareEmail.email_signup,event:"click"});Element.observe(window,"resize",shareEmail.move_to_visible_area)};this.move_to_visible_area=function(){if($("share_email")&&$("share_email").visible()){var parent=$("share_email").up(".share-box");if(typeof(parent)=="undefined"){parent=$("share_email").up(".share_tools_list")}if(typeof(parent)!="undefined"){var email_button=parent.select(".sub-buzz-email-share");if(!email_button.length){email_button=parent.select(".mail .share-icon")}if(email_button.length){if($("share_email").up(".buzz_superlist_item_update")){$("share_email").addClassName("top-arrow");var left_offset=(email_button[0].offsetLeft+email_button[0].getWidth()/2)-($("share_email").getWidth()/2);$("share_email").setStyle({left:left_offset+"px"});$("share_email").setStyle({top:50+"px"})}else{var top_offset=(email_button[0].offsetTop+email_button[0].getHeight()/2)-($("share_email").getHeight()/2);$("share_email").setStyle({left:45+"px"});$("share_email").setStyle({top:top_offset+"px"})}}}else{var share_email_offset=$("share_email").viewportOffset();if(share_email_offset.left<=0){if(!$("share_email").getAttribute("data:originOffset")){$("share_email_form").addClassName("hide-arrow");$("share_email").setAttribute("data:originOffset",$("share_email").offsetLeft)}$("share_email").setStyle({left:($("share_email").offsetLeft-share_email_offset.left)+"px"})}else{if($("share_email").getAttribute("data:originOffset")){if(($("share_email").offsetLeft-share_email_offset.left)>=$("share_email").getAttribute("data:originOffset")){$("share_email").setStyle({left:($("share_email").offsetLeft-share_email_offset.left)+"px"})}else{$("share_email_form").removeClassName("hide-arrow");$("share_email").setStyle({left:$("share_email").getAttribute("data:originOffset")+"px"});$("share_email").removeAttribute("data:originOffset")}}}}}};this.hide_email_form=function(){shareEmail.current_button=null;$("share_email").hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}if(typeof bpage!="undefined"){bpage.hide_all_popups()}};this.locate_form_and_share_email=function(target,buzz_id,no_scroll){$("share_email").removeAttribute("data:originOffset");$("share_email_form").removeClassName("hide-arrow");$("newsletter_signup_form").hide();$("share_email_error").hide();$("share_email_confirm").hide();$("share_email_form").show();var emailBoxPos={top:0,left:0};if(shareEmail.current_button==target){shareEmail.hide_email_form();return false}else{shareEmail.current_button=target}var is_inline_share=target.ancestors().indexOf($("inline_shares_box"))>=0;var btn={left:Number($(target).offsetLeft),top:Number($(target).offsetTop),height:Number($(target).getHeight()),width:Number($(target).getWidth())};var arrows=$$("#share_email #top_arrow .arrow");if(BF_STATIC.tt_page!="Videos"){buzz_id=buzz_id.split("_")}$("bid").value=buzz_id[0];if("videopromo" in window&&videopromo!="undefined"&&videopromo.buzz_id){$("bid").value=parseInt(videopromo.buzz_id)}$("share_email").show();if(typeof bf_rdio!="undefined"){bf_rdio.disable()}$("share_email_form").addClassName("share-email-form");$("share_email_form").reset();$("share_email").setOpacity(1);$("share_email_message").hide();$(target).insert({after:$("share_email")});arrow={height:is_inline_share?20:10,width:is_inline_share?20:10};var box={width:$("share_email").getWidth(),height:$("share_email").getHeight()};if(is_inline_share){emailBoxPos.top=btn.top-parseInt(box.height/2)+parseInt(btn.height/2);emailBoxPos.left=btn.left+btn.width+parseInt(arrow.width)}else{emailBoxPos.top=btn.top+btn.height+parseInt(arrow.height/2);emailBoxPos.left=btn.left-parseInt(box.width/2)+parseInt(btn.width/2)}$("share_email").setStyle({left:emailBoxPos.left+"px",top:emailBoxPos.top+"px"});arrows.each(function(a,i){var arrowPos={top:0,left:0};if(is_inline_share){arrowPos.left=(i-arrow.width);if(i==1){arrowPos.left+=2}arrowPos.top=parseInt(box.height/2)-parseInt(arrow.height/2)}else{arrowPos.left=parseInt(box.width/2)-arrow.width+i;arrowPos.top=i-arrow.height+1}$(a).setStyle({left:arrowPos.left+"px",top:arrowPos.top+"px"})});shareEmail.move_to_visible_area();if(!no_scroll){BF_Effect.ScrollIntoView("share_email")}};this.newsletter_checkbox=function(obj){if(obj.id){$(obj.id).toggleClassName("checkOff");$(obj.id).toggleClassName("checkOn");var cat=gtrack.findCatLabel(obj.id);var act=$(obj.id)[bfjs.read_attr](bfjs.gtrack_act);gtrack.track_events(cat,act+"/"+($(obj.id).hasClassName("checkOff")?"uncheck":"check"),"(no label)")}};this.email_signup=function(){var categories=[];if(shareEmail.from_email==""){return false}var email=shareEmail.from_email;$$("#newsletter_signup_form .checkBox.checkOn").each(function(el){var cat=$(el).getAttribute("id").replace("_signup","");categories.push(cat)});if(!categories.length){if($("email_sent_success_message")){$("email_sent_success_message").hide()}if($("empty_sign_up_message")){$("empty_sign_up_message").removeClassName("hidden")}return}else{if($("empty_sign_up_message")){$("empty_sign_up_message").addClassName("hidden")}}new Ajax.Request("/buzzfeed/_email/",{method:"get",parameters:{email:email,category:categories},onSuccess:function(transport){if($("email_sent_success_message")){$("email_sent_success_message").removeClassName("hidden")}if(transport.responseText.match(/Email added/)){shareEmail.confirm_message("Great! You'll get your first email soon.")}else{shareEmail.fail_message("Sorry! We weren't able to sign you up.")}},onFailure:function(transport){if(BF_STATIC.bf_env=="dev"&&transport.responseText){shareEmail.fail_message(transport.responseText)}else{shareEmail.fail_message("Sorry! We weren't able to sign you up.")}}})};this.submit=function(obj){$("share_email_submit").disabled=true;if(obj.vertical){shareEmail.vertical=obj.vertical}if(shareEmail.validate()){var params={};params.bf=$F("bf").strip();params.b2=$F("b2").strip();params.note=$F("note").strip();params.bid=$F("bid");params.sub_buzz_id=$F("sub_buzz_id");if(BF_STATIC.tt_page=="Video"&&videopage.is_videopage){params.video_page=1}if($("hash_tag")){params.hash_tag=$F("hash_tag")}if(typeof pound!="undefined"&&!BF_STATIC.mobile_app){params.tracking_url=pound.urls.unescaped.queryStringOnly()}if("buzzDetails" in window&&"postTags" in buzzDetails){params.testing=buzzDetails.postTags.split(",").indexOf("--enable-email-catcha")>-1?"on":"off"}(new BF_Request()).request("/buzzfeed/share_email",{method:"post",parameters:params,onSuccess:function(resp){shareEmail.share_submit_success(resp)},onFailure:function(resp){shareEmail.fail(resp)},onCatcha:function(resp){$("share_email_submit").disabled=false;if(bf_catcha.catcha_answer){$("share_email_message").className="message error";$("share_email_message").innerHTML="Please enter the correct Cat-cha answer.";$("share_email_message").show()}}});(new BF_Targetting_Pixel()).add("email");gtrack.trackShares(22,"numSharesEmail");var gtrack_cat_label=gtrack.findCatLabel($("share_email_submit"));gtrack.track_events((gtrack_cat_label?gtrack_cat_label:""),"share/email/send","")}};this.share_submit_success=function(resp){$("share_email_submit").disabled=false;var obj=eval("("+resp.responseText+")");obj.sent=obj.sent==true||obj.sent=="true";if(obj&&obj.sent&&obj.sent==true){if(tracker){tracker.add({type:tracker.types.SHARE_EMAIL});tracker.run()}if($("bf")){$("bf").value=""}if($("b2")){$("b2").value=""}if($("note")){$("note").value=""}if($("sub_buzz_id")){$("sub_buzz_id").value=""}if(obj.from_email){if($("newsletter_signup_form")){$("newsletter_signup_form").addClassName("share-email-form")}if($("from_address")){$("from_address").innerHTML=obj.from_email}shareEmail.from_email=obj.from_email;if($("newsletter_signup_form")){$("newsletter_signup_form").show()}if($("empty_sign_up_message")){$("empty_sign_up_message").addClassName("hidden")}if($("email_sent_success_message")){$("email_sent_success_message").show()}if($("share_email_form")){$("share_email_form").hide()}}else{BF_Effect.FadeOut("share_email",50)}shareEmail.move_to_visible_area()}else{shareEmail.fail(resp)}};this.fail=function(resp){try{var obj=eval("("+resp.responseText+")");if(obj&&obj.error&&obj.message&&(obj.error=="blacklist"||obj.error=="spam")){shareEmail.fail_message(obj.message)}}catch(e){console.log(e)}};this.fail_message=function(message){$("share_email_error_text").update(message);console.log("share email failure: "+message);$("share_email_submit").disabled=false;$("share_email_form").hide();$("newsletter_signup_form").hide();$("share_email_error").show();shareEmail.move_to_visible_area()};this.confirm_message=function(message){$("share_email_confirm_text").update(message);console.log("share email confirm: "+message);$("share_email_submit").disabled=false;$("share_email_form").hide();$("newsletter_signup_form").hide();$("share_email_error").hide();$("share_email_confirm").show();shareEmail.move_to_visible_area()};this.validate=function(){var status=true;if($F("bf").strip()==""||$F("b2").strip()==""){$("share_email_message").className="message error";$("share_email_message").innerHTML=shareEmail.ERR_MESS;$("share_email_message").show();var status=false;$("share_email_submit").disabled=false}return status};this.draw_catcha=function(){if("buzzDetails" in window&&"postTags" in buzzDetails&&buzzDetails.postTags.split(",").indexOf("--enable-email-catcha")==-1){return}if(BFW_Util.getCookie("catcha-email_a_friend")){universal_dom.get_bucket_elements("catcha-email_a_friend").each(function(el){el.show();bf_catcha.set_image_and_question({service:"email_a_friend",image_element:el.getElementsByTagName("IMG")[0],question_element:el.getElementsByTagName("SPAN")[0]})})}}};shareEmail=new BF_ShareEmail();BuzzLoader.register(function(){shareEmail.init()},1);var BF_HashTrack=function(){this.TYPE_FN={turn:function(b){hashtrack.ping(b)},google:function(b){hashtrack.google(b)}};this.google_regex=new RegExp("/([^/]*)/([^/]*)(?:#|\\?.*fb_ref=)(H[^0-9]+)([0-9]+)??$","i");this.redir_regex=new RegExp("/ht/([^/]*)/([^/]*)/(H[^0-9]+)([0-9]+)??$","i");this.primary_regex=new RegExp("/([^/]*)/([^/]*)(?:#|\\?.*fb_ref=)(H[^0-9]+)1??$","i");this.hashtrack2_regex=new RegExp("/h2/([a-z0-9]+)/([^/]+)/([^/]+)","i");this.tracked_params=false;this.init=function(){this.oldschool_hashtrack=window.location.href.match(hashtrack.hashtrack2_regex)?false:true;var b=hashtrack.hash_tag(window.location.href);if(b){b=b.toUpperCase();var d=unescape(bfjs.read_cookie("HT_PRIMARY"));var c=2;if(d&&d.split(",").length>3){c=hashtrack._process_cookie(d,b)}else{if(hashtrack.redir_regex.test(document.referrer)||hashtrack.primary_regex.test(window.location.href)){c=1;hashtrack._process_without_cookie()}}if(c==0){return}if(b&&!("hash_track" in window)){var g=window.location.href.match(hashtrack.google_regex);if(g&&g.length==5){hashtrack.setup_google({user:g[1],uri:g[2],code:g[3].toUpperCase(),number:c})}}if(b&&!("hash_track" in window)){var f=window.location.href.match(hashtrack.hashtrack2_regex);if(f&&f.length==4){hashtrack.setup_google({user:f[2],uri:f[3],code:f[1].toUpperCase(),number:c})}}if(this.oldschool_hashtrack){b=b.replace(/\d$/,c)}else{b+=c}if(!bfjs.isMobile()){(new BF_Targetting_Pixel()).hashtrack_pixel(window.location.toString(),c)}}if(b&&typeof hash_track!="undefined"&&typeof hash_track[b]!="undefined"){var e=hashtrack.TYPE_FN[hash_track[b].type||"turn"];if(typeof e!="undefined"){var h=hash_track[b].conversion;e(h.id);if(!b.toUpperCase().match(/^H/)){b="H"+b}hashtrack.track(b);hashtrack.tracked_hash_tag=b;if(this.oldschool_hashtrack){bfjs.onPageLoad(function(){try{hashtrack.do_rewrites(b.replace(/1$/,2))}catch(j){console.error(j)}})}}}else{if(this.oldschool_hashtrack){bfjs.onPageLoad(this.fixup_share_buttons)}}};this._process_without_cookie=function(){var c=hashtrack.google_regex.exec(document.location.href);var b={user:c[1],uri:c[2],code:c[3].toUpperCase()};if(b.code.match(/^H.*/)){window.IS_HASH_WIDGET_CLICK=true}};this._process_cookie=function(g,j){var b=g.split(",");var h=b.shift();var m=b.shift();var c=b.shift();var d=new RegExp(".*/"+m+"/"+c+".*");var l=b.shift();var k=b.join(",");var f=2;var e=this.oldschool_hashtrack?"2":"";if(l&&d.exec(document.location.href)&&(l+e)==j){if(h=="UNCOUNTED"){f=1}window.IS_HASH_WIDGET_CLICK=true;if(k){window.HASH_REFER=k}bfjs.write_cookie("HT_PRIMARY",["COUNTED",m,c,l,k].join(","),600)}return f};this.setup_google=function(d){var b=d.code+d.number;var c=["_ga","hashtrack",d.user,d.uri,d.code,d.number];hash_track={};hash_track[b]={type:"google",conversion:{id:"/"+c.join("/")}}};this.hash_tag=function(b){return hashtrack.parse_hash_tag(b)};this.parse_hash_tag=function(c){var b=undefined;if(c.indexOf("/h2/")){var d=c.match("/h2/([^/]+)");if(d&&d.length>0){b=d[1]}}if(!b&&c.indexOf("#")+1>0){var d=c.substring(c.indexOf("#")+1);if(d.length>0){b=d}}if(!b&&c.indexOf("?")>-1){var e=bfjs.isMobile()?hashtrack._params_unserialize(c):c.toQueryParams();if(e.fb_ref){b=e.fb_ref}}if(!!b&&b.indexOf("?")>-1){b=b.substr(0,b.indexOf("?"))}return b};this.regex=new RegExp("(/[^/]+/[^/]+$)");this.do_rewrites=function(b,f){var c=window.location.href,g=!!f?f.getElementsByTagName("fb:like"):document.getElementsByTagName("fb:like");if(g.length==0){g=!!f?f.getElementsByTagName("like"):document.getElementsByTagName("like")}for(var d=0;d<g.length;d++){g[d].setAttribute("ref",b);hashtrack._swap_node(g[d])}var e=!!f?f.getElementsByTagName("A"):document.getElementsByTagName("A");for(var d=0;d<e.length;d++){if(e[d].className.match(/twitter-share-button/)){var c=e[d].getAttribute("data-url");if(!c||c==""){c=window.location.href}e[d].setAttribute("data-url",c+"#"+b);e[d].setAttribute("data-counturl",c);hashtrack._swap_node(e[d])}}var j=!!f?f.getElementsByTagName("IFRAME"):document.body.getElementsByTagName("IFRAME");for(var d=0;d<j.length;d++){if(!!j[d].getAttribute("bf_src")){var c=hashtrack._get_hashtrack_share_url(j[d],b);hashtrack._swap_node(j[d],"src",c)}}var c=window.location.href,g=!!f?f.getElementsByTagName("g:plusone"):document.getElementsByTagName("g:plusone");if(g.length==0){g=!!f?f.getElementsByTagName("plusone"):document.getElementsByTagName("plusone")}for(var d=0;d<g.length;d++){g[d].setAttribute("href",hashtrack._add_hashtrack_to_url(g[d].getAttribute("href"),b));hashtrack._swap_node(g[d])}if($("share_email_form")){var h=new Element("input",{type:"hidden",value:b,name:"hash_tag",id:"hash_tag"});$("share_email_form").appendChild(h)}};this._swap_node=function(d,e,c){var b=d.cloneNode(true);if(c){b.setAttribute(e,c)}d.parentNode.replaceChild(b,d)};this._params_unserialize=function(g){var d={},c=g.replace(/^\?/,"").split("&"),b=c.length,e=0,f;for(;e<b;e++){if(!c[e]){continue}f=c[e].split("=");d[f[0]]=f[1]}return d},this._get_hashtrack_share_url=function(e,b){var d=e.getAttribute("bf_src");var c=d.indexOf("?")+1;var g=d.substring(c);var f=bfjs.isMobile()?hashtrack._params_unserialize(g):g.toQueryParams();if(typeof f.url!="undefined"){f.url=hashtrack._add_hashtrack_to_url(f.url,b);d=d.replace(g,$H(f).toQueryString())}return d};this._add_hashtrack_to_url=function(e,c){var d=new RegExp("(/[^/]+/[^/]+$)");var b=e.match(d);e=e.replace(d,"/ht"+b[0]+"/"+c);return e};this.fixup_share_buttons=function(e){var f=!!e&&typeof e=="object"?e.getElementsByTagName("fb:like"):document.getElementsByTagName("fb:like");for(var d=0;d<f.length;d++){var k=document.createElement("fb:like");var b=f[d].attributes;for(var c=0;c<b.length;c++){k.setAttribute(b[c].name,b[c].value)}f[d].parentNode.replaceChild(k,f[d])}var g=!!e&&typeof e=="object"?e.getElementsByTagName("IFRAME"):document.getElementsByTagName("IFRAME");for(var d=0;d<g.length;d++){if(!!g[d].getAttribute("bf_src")){var h=g[d].cloneNode(true);h.setAttribute("src",g[d].getAttribute("bf_src"));g[d].parentNode.replaceChild(h,g[d])}}};this.ping=function(c){var b="&";if(c.indexOf("?")==-1){b="?"}b+="rnd="+(new Date()).getTime();(new Image()).src=c+b};this.track=function(h){var c=document.createElement("img");var b,g;if(bfjs.isMobile()){b=$("#buzz")[bfjs.read_attr]("data-buzz-id");g=$("#buzz")[bfjs.read_attr]("data-user-id")}else{b=$$("head meta[property=bf:buzzid]");g=$$("head meta[property=bf:userid]");if(b){b=b.first().getAttribute("content")}if(g){g=g.first().getAttribute("content")}}if(b&&g){try{var f={buzzid:b,userid:g,hp:h,referrer:(typeof window.HASH_REFER!="undefined")?window.HASH_REFER:document.referrer,z:(new Date).getTime()};hashtrack.tracked_params=f;(new Image()).src="http://"+(Cloud.servers[Math.floor(Math.random()*Cloud.servers.length)])+"/hp.gif?"+(bfjs.isMobile()?$.param(f):Object.toQueryString(f));if(Cloud.staging.sample>0&&(Math.random()<=Cloud.staging.sample)){(new Image()).src="http://"+Cloud.staging.server+"/hp.gif?"+(bfjs.isMobile()?$.param(f):Object.toQueryString(f))}}catch(d){console.error(d)}}};this.google=function(d,b){return}};var hashtrack=new BF_HashTrack();(function(){function A(b){console.log("$f.fireEvent",[].slice.call(b))}function t(b){if(!b||typeof b!="object"){return b}var d=new b.constructor();for(var c in b){if(b.hasOwnProperty(c)){d[c]=t(b[c])}}return d}function p(b,e){if(!b){return}var g,f=0,d=b.length;if(d===undefined){for(g in b){if(e.call(b[g],g,b[g])===false){break}}}else{for(var c=b[0];f<d&&e.call(c,f,c)!==false;c=b[++f]){}}return b}function E(b){return document.getElementById(b)}function w(b,c,d){if(typeof c!="object"){return b}if(b&&c){p(c,function(f,e){if(!d||typeof e!="function"){b[f]=e}})}return b}function o(b){var d=b.indexOf(".");if(d!=-1){var e=b.slice(0,d)||"*";var f=b.slice(d+1,b.length);var c=[];p(document.getElementsByTagName(e),function(){if(this.className&&this.className.indexOf(f)!=-1){c.push(this)}});return c}}function B(b){b=b||window.event;if(b.preventDefault){b.stopPropagation();b.preventDefault()}else{b.returnValue=false;b.cancelBubble=true}return false}function u(b,d,c){b[d]=b[d]||[];b[d].push(c)}function C(){return"_"+(""+Math.random()).slice(2,10)}var z=function(c,e,d){var f=this,g={},b={};f.index=e;if(typeof c=="string"){c={url:c}}w(this,c,true);p(("Begin*,Start,Pause*,Resume*,Seek*,Stop*,Finish*,LastSecond,Update,BufferFull,BufferEmpty,BufferStop").split(","),function(){var k="on"+this;if(k.indexOf("*")!=-1){k=k.slice(0,k.length-1);var j="onBefore"+k.slice(2);f[j]=function(l){u(b,j,l);return f}}f[k]=function(l){u(b,k,l);return f};if(e==-1){if(f[j]){d[j]=f[j]}if(f[k]){d[k]=f[k]}}});w(this,{onCuepoint:function(j,k){if(arguments.length==1){g.embedded=[null,j];return f}if(typeof j=="number"){j=[j]}var l=C();g[l]=[j,k];if(d.isLoaded()){d._api().fp_addCuepoints(j,e,l)}return f},update:function(k){w(f,k);if(d.isLoaded()){d._api().fp_updateClip(k,e)}var l=d.getConfig();var j=(e==-1)?l.clip:l.playlist[e];w(j,k,true)},_fireEvent:function(m,H,l,k){if(m=="onLoad"){p(g,function(J,I){if(I[0]){d._api().fp_addCuepoints(I[0],e,J)}});return false}k=k||f;if(m=="onCuepoint"){var n=g[H];if(n){return n[1].call(d,k,l)}}if(H&&"onBeforeBegin,onMetaData,onStart,onUpdate,onResume".indexOf(m)!=-1){w(k,H);if(H.metaData){if(!k.duration){k.duration=H.metaData.duration}else{k.fullDuration=H.metaData.duration}}}var j=true;p(b[m],function(){j=this.call(d,k,H,l)});return j}});if(c.onCuepoint){var h=c.onCuepoint;f.onCuepoint.apply(f,typeof h=="function"?[h]:h);delete c.onCuepoint}p(c,function(k,j){if(typeof j=="function"){u(b,k,j);delete c[k]}});if(e==-1){d.onCuepoint=this.onCuepoint}};var s=function(g,e,f,c){var h=this,d={},b=false;if(c){w(d,c)}p(e,function(k,j){if(typeof j=="function"){d[k]=j;delete e[k]}});w(this,{animate:function(n,m,j){if(!n){return h}if(typeof m=="function"){j=m;m=500}if(typeof n=="string"){var k=n;n={};n[k]=m;m=500}if(j){var l=C();d[l]=j}if(m===undefined){m=500}e=f._api().fp_animate(g,n,m,l);return h},css:function(k,j){if(j!==undefined){var l={};l[k]=j;k=l}e=f._api().fp_css(g,k);w(h,e);return h},show:function(){this.display="block";f._api().fp_showPlugin(g);return h},hide:function(){this.display="none";f._api().fp_hidePlugin(g);return h},toggle:function(){this.display=f._api().fp_togglePlugin(g);return h},fadeTo:function(m,j,k){if(typeof j=="function"){k=j;j=500}if(k){var l=C();d[l]=k}this.display=f._api().fp_fadeTo(g,m,j,l);this.opacity=m;return h},fadeIn:function(j,k){return h.fadeTo(1,j,k)},fadeOut:function(j,k){return h.fadeTo(0,j,k)},getName:function(){return g},getPlayer:function(){return f},_fireEvent:function(l,m,k){if(l=="onUpdate"){var n=f._api().fp_getPlugin(g);if(!n){return}w(h,n);delete h.methods;if(!b){p(n.methods,function(){var I=""+this;h[I]=function(){var K=[].slice.call(arguments);var J=f._api().fp_invoke(g,I,K);return J==="undefined"||J===undefined?h:J}});b=true}}var j=d[l];if(j){var H=j.apply(h,m);if(l.slice(0,1)=="_"){delete d[l]}return H}return h}})};function F(K,f,l){var e=this,g=null,n=false,j,m,h=[],c={},d={},k,I,M,H,N,L;w(e,{id:function(){return k},isLoaded:function(){return(g!==null&&g.fp_play!==undefined&&!n)},getParent:function(){return K},hide:function(O){if(O){K.style.height="0px"}if(e.isLoaded()){g.style.height="0px"}return e},show:function(){K.style.height=L+"px";if(e.isLoaded()){g.style.height=N+"px"}return e},isHidden:function(){return e.isLoaded()&&parseInt(g.style.height,10)===0},load:function(O){if(!e.isLoaded()&&e._fireEvent("onBeforeLoad")!==false){var Q=function(){if(j&&!flashembed.isSupported(f.version)){K.innerHTML=""}if(O){O.cached=true;u(d,"onLoad",O)}flashembed(K,f,{config:l})};var P=0;p(G,function(){this.unload(function(R){if(++P==G.length){Q()}})})}return e},unload:function(O){if(j.replace(/\s/g,"")!==""){if(e._fireEvent("onBeforeUnload")===false){if(O){O(false)}return e}n=true;try{if(g){g.fp_close();e._fireEvent("onUnload")}}catch(Q){}var P=function(){g=null;K.innerHTML=j;n=false;if(O){O(true)}};if(/WebKit/i.test(navigator.userAgent)&&!/Chrome/i.test(navigator.userAgent)){setTimeout(P,0)}else{P()}}else{if(O){O(false)}}return e},getClip:function(O){if(O===undefined){O=H}return h[O]},getCommonClip:function(){return m},getPlaylist:function(){return h},getPlugin:function(Q){var O=c[Q];if(!O&&e.isLoaded()){var P=e._api().fp_getPlugin(Q);if(P){O=new s(Q,P,e);c[Q]=O}}return O},getScreen:function(){return e.getPlugin("screen")},getControls:function(){return e.getPlugin("controls")._fireEvent("onUpdate")},getLogo:function(){try{return e.getPlugin("logo")._fireEvent("onUpdate")}catch(O){}},getPlay:function(){return e.getPlugin("play")._fireEvent("onUpdate")},getConfig:function(O){return O?t(l):l},getFlashParams:function(){return f},loadPlugin:function(P,Q,U,O){if(typeof U=="function"){O=U;U={}}var R=O?C():"_";e._api().fp_loadPlugin(P,Q,U,R);var S={};S[R]=O;var T=new s(P,null,e,S);c[P]=T;return T},getState:function(){return e.isLoaded()?g.fp_getState():-1},play:function(P,Q){var O=function(){if(P!==undefined){e._api().fp_play(P,Q)}else{e._api().fp_play()}};if(e.isLoaded()){O()}else{if(n){setTimeout(function(){e.play(P,Q)},50)}else{e.load(function(){O()})}}return e},getVersion:function(){var O="flowplayer.js 3.2.8";if(e.isLoaded()){var P=g.fp_getVersion();P.push(O);return P}return O},_api:function(){if(!e.isLoaded()){throw"Flowplayer "+e.id()+" not loaded when calling an API method"}return g},setClip:function(O){p(O,function(Q,P){if(typeof P=="function"){u(d,Q,P);delete O[Q]}else{if(Q=="onCuepoint"){$f(K).getCommonClip().onCuepoint(O[Q][0],O[Q][1])}}});e.setPlaylist([O]);return e},getIndex:function(){return M},bufferAnimate:function(O){g.fp_bufferAnimate(O===undefined||O);return e},_swfHeight:function(){return g.clientHeight}});p(("Click*,Load*,Unload*,Keypress*,Volume*,Mute*,Unmute*,PlaylistReplace,ClipAdd,Fullscreen*,FullscreenExit,Error,MouseOver,MouseOut").split(","),function(){var P="on"+this;if(P.indexOf("*")!=-1){P=P.slice(0,P.length-1);var O="onBefore"+P.slice(2);e[O]=function(Q){u(d,O,Q);return e}}e[P]=function(Q){u(d,P,Q);return e}});p(("pause,resume,mute,unmute,stop,toggle,seek,getStatus,getVolume,setVolume,getTime,isPaused,isPlaying,startBuffering,stopBuffering,isFullscreen,toggleFullscreen,reset,close,setPlaylist,addClip,playFeed,setKeyboardShortcutsEnabled,isKeyboardShortcutsEnabled").split(","),function(){var O=this;e[O]=function(Q,R){if(!e.isLoaded()){return e}var P=null;if(Q!==undefined&&R!==undefined){P=g["fp_"+O](Q,R)}else{P=(Q===undefined)?g["fp_"+O]():g["fp_"+O](Q)}return P==="undefined"||P===undefined?e:P}});e._fireEvent=function(T){if(typeof T=="string"){T=[T]}var S=T[0],V=T[1],X=T[2],Y=T[3],Z=0;if(l.debug){A(T)}if(!e.isLoaded()&&S=="onLoad"&&V=="player"){g=g||E(I);N=e._swfHeight();p(h,function(){this._fireEvent("onLoad")});p(c,function(P,O){O._fireEvent("onUpdate")});m._fireEvent("onLoad")}if(S=="onLoad"&&V!="player"){return}if(S=="onError"){if(typeof V=="string"||(typeof V=="number"&&typeof X=="number")){V=X;X=Y}}if(S=="onContextMenu"){p(l.contextMenu[V],function(P,O){O.call(e)});return}if(S=="onPluginEvent"||S=="onBeforePluginEvent"){var ac=V.name||V;var ab=c[ac];if(ab){ab._fireEvent("onUpdate",V);return ab._fireEvent(X,T.slice(3))}return}if(S=="onPlaylistReplace"){h=[];var W=0;p(V,function(){h.push(new z(this,W++,e))})}if(S=="onClipAdd"){if(V.isInStream){return}V=new z(V,X,e);h.splice(X,0,V);for(Z=X+1;Z<h.length;Z++){h[Z].index++}}var U=true;if(typeof V=="number"&&V<h.length){H=V;var aa=h[V];if(aa){U=aa._fireEvent(S,X,Y)}if(!aa||U!==false){U=m._fireEvent(S,X,Y,aa)}}p(d[S],function(){U=this.call(e,V,X);if(this.cached){d[S].splice(Z,1)}if(U===false){return false}Z++});return U};function J(){if($f(K)){$f(K).getParent().innerHTML="";M=$f(K).getIndex();G[M]=e}else{G.push(e);M=G.length-1}L=parseInt(K.style.height,10)||K.clientHeight;k=K.id||"fp"+C();I=f.id||k+"_api";f.id=I;j=K.innerHTML;if(typeof l=="string"){l={clip:{url:l}}}l.playerId=k;l.clip=l.clip||{};if(K.getAttribute("href",2)&&!l.clip.url){l.clip.url=K.getAttribute("href",2)}m=new z(l.clip,-1,e);l.playlist=l.playlist||[l.clip];var Q=0;p(l.playlist,function(){var S=this;if(typeof S=="object"&&S.length){S={url:""+S}}p(l.clip,function(U,T){if(T!==undefined&&S[U]===undefined&&typeof T!="function"){S[U]=T}});l.playlist[Q]=S;S=new z(S,Q,e);h.push(S);Q++});p(l,function(S,T){if(typeof T=="function"){if(m[S]){m[S](T)}else{u(d,S,T)}delete l[S]}});p(l.plugins,function(S,T){if(T){c[S]=new s(S,T,e)}});if(!l.plugins||l.plugins.controls===undefined){c.controls=new s("controls",null,e)}c.canvas=new s("canvas",null,e);j=K.innerHTML;function O(S){if(/iPad|iPhone|iPod/i.test(navigator.userAgent)&&!/.flv$/i.test(h[0].url)&&!P()){return true}if(!e.isLoaded()&&e._fireEvent("onBeforeClick")!==false){e.load()}return B(S)}function P(){return e.hasiPadSupport&&e.hasiPadSupport()}function R(){if(j.replace(/\s/g,"")!==""){if(K.addEventListener){K.addEventListener("click",O,false)}else{if(K.attachEvent){K.attachEvent("onclick",O)}}}else{if(K.addEventListener&&!P()){K.addEventListener("click",B,false)}e.load()}}setTimeout(R,0)}if(typeof K=="string"){var b=E(K);if(!b){throw"Flowplayer cannot access element: "+K}K=b;J()}else{J()}}var G=[];function D(c){this.length=c.length;this.each=function(d){p(c,d)};this.size=function(){return c.length};var b=this;for(name in F.prototype){b[name]=function(){var d=arguments;b.each(function(){this[name].apply(this,d)})}}}window.flowplayer=window.$f=function(){var f=null;var g=arguments[0];if(!arguments.length){p(G,function(){if(this.isLoaded()){f=this;return false}});return f||G[0]}if(arguments.length==1){if(typeof g=="number"){return G[g]}else{if(g=="*"){return new D(G)}p(G,function(){if(this.id()==g.id||this.id()==g||this.getParent()==g){f=this;return false}});return f}}if(arguments.length>1){var b=arguments[1],e=(arguments.length==3)?arguments[2]:{};if(typeof b=="string"){b={src:b}}b=w({bgcolor:"#000000",version:[9,0],expressInstall:"http://static.flowplayer.org/swf/expressinstall.swf",cachebusting:false},b);if(typeof g=="string"){if(g.indexOf(".")!=-1){var c=[];p(o(g),function(){c.push(new F(this,t(b),t(e)))});return new D(c)}else{var d=E(g);return new F(d!==null?d:t(g),t(b),t(e))}}else{if(g){return new F(g,t(b),t(e))}}}return null};w(window.$f,{fireEvent:function(){var c=[].slice.call(arguments);var b=$f(c[0]);return b?b._fireEvent(c.slice(1)):null},addPlugin:function(c,b){F.prototype[c]=b;return $f},each:p,extend:w});if(typeof jQuery=="function"){jQuery.fn.flowplayer=function(b,c){if(!arguments.length||typeof arguments[0]=="number"){var d=[];this.each(function(){var e=$f(this);if(e){d.push(e)}});return arguments.length?d[arguments[0]]:new D(d)}return this.each(function(){$f(this,t(b),c?t(c):{})})}}})();(function(){var n=document.all,l="http://www.adobe.com/go/getflashplayer",t=typeof jQuery=="function",p=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,u={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:true,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:false,cachebusting:false};if(window.attachEvent){window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){}})}function m(b,c){if(c){for(var d in c){if(c.hasOwnProperty(d)){b[d]=c[d]}}}return b}function w(d,e){var b=[];for(var c in d){if(d.hasOwnProperty(c)){b[c]=e(d[c])}}return b}window.flashembed=function(d,b,c){if(typeof d=="string"){d=document.getElementById(d.replace("#",""))}if(!d){return}if(typeof b=="string"){b={src:b}}return new s(d,m(m({},u),b),c)};var o=m(window.flashembed,{conf:u,getVersion:function(){var b,d;try{d=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(e){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");d=b&&b.GetVariable("$version")}catch(g){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");d=b&&b.GetVariable("$version")}catch(c){}}}d=p.exec(d);return d?[d[1],d[3]]:[0,0]},asString:function(c){if(c===null||c===undefined){return null}var d=typeof c;if(d=="object"&&c.push){d="array"}switch(d){case"string":c=c.replace(new RegExp('(["\\\\])',"g"),"\\$1");c=c.replace(/^\s?(\d+\.?\d*)%/,"$1pct");c=c.replace(/(%)/g,"%25").replace(/'/g,"\\u0027").replace(/"/g,"\\u0022").replace(/&/g,"%26");return'"'+c+'"';case"array":return"["+w(c,function(g){return o.asString(g)}).join(",")+"]";case"function":return'"function()"';case"object":var b=[];for(var e in c){if(c.hasOwnProperty(e)){b.push('"'+e+'":'+o.asString(c[e]))}}return"{"+b.join(",")+"}"}return String(c).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(h,c){h=m({},h);var j='<object width="'+h.width+'" height="'+h.height+'" id="'+h.id+'" name="'+h.id+'"';if(h.cachebusting){h.src+=((h.src.indexOf("?")!=-1?"&":"?")+Math.random())}if(h.w3c||!n){j+=' data="'+h.src+'" type="application/x-shockwave-flash"'}else{j+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'}j+=">";if(h.w3c||n){j+='<param name="movie" value="'+h.src+'" />'}h.width=h.height=h.id=h.w3c=h.src=null;h.onFail=h.version=h.expressInstall=null;for(var b in h){if(h[b]){j+='<param name="'+b+'" value="'+h[b]+'" />'}}var g="";if(c){for(var e in c){if(c[e]){var d=c[e];g+=e+"="+(/function|object/.test(typeof d)?o.asString(d):d)+"&"}}g=g.slice(0,-1);j+='<param name="flashvars" value=\''+g+"' />"}j+="</object>";return j},isSupported:function(b){return f[0]>b[0]||f[0]==b[0]&&f[1]>=b[1]}});var f=o.getVersion();function s(d,e,b){if(o.isSupported(e.version)){d.innerHTML=o.getHTML(e,b)}else{if(e.expressInstall&&o.isSupported([6,65])){d.innerHTML=o.getHTML(m(e,{src:e.expressInstall}),{MMredirectURL:encodeURIComponent(location.href),MMplayerType:"PlugIn",MMdoctitle:document.title})}else{if(!d.innerHTML.replace(/\s/g,"")){d.innerHTML="<h2>Flash version "+e.version+" or greater is required</h2><h3>"+(f[0]>0?"Your version is "+f:"You have no flash plugin installed")+"</h3>"+(d.tagName=="A"?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+l+"'>here</a></p>");if(d.tagName=="A"){d.onclick=function(){location.href=l}}}if(e.onFail){var c=e.onFail.call(this);if(typeof c=="string"){d.innerHTML=c}}}}if(n){window[e.id]=document.getElementById(e.id)}m(this,{getRoot:function(){return d},getOptions:function(){return e},getConf:function(){return b},getApi:function(){return d.firstChild}})}if(t){jQuery.tools=jQuery.tools||{version:"3.2.8"};jQuery.tools.flashembed={conf:u};jQuery.fn.flashembed=function(b,c){return this.each(function(){$(this).data("flashembed",flashembed(this,b,c))})}}})();var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var b;var c;var d;try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");b=c.GetVariable("$version")}catch(d){}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");b="WIN 6,0,21,0";c.AllowScriptAccess="always";b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b="WIN 3,0,18,0"}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b="WIN 2,0,0,11"}catch(d){b=-1}}return b}function GetSwfVer(){var h=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var g=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var b=navigator.plugins["Shockwave Flash"+g].description;var f=b.split(" ");var d=f[2].split(".");var j=d[0];var c=d[1];var e=f[3];if(e==""){e=f[4]}if(e[0]=="d"){e=e.substring(1)}else{if(e[0]=="r"){e=e.substring(1);if(e.indexOf("d")>0){e=e.substring(0,e.indexOf("d"))}}}var h=j+"."+c+"."+e}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){h=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){h=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){h=2}else{if(isIE&&isWin&&!isOpera){h=ControlVersion()}}}}}return h}function DetectFlashVer(g,e,d){versionStr=GetSwfVer();if(versionStr==-1){return false}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=versionStr.split(".")}var f=versionArray[0];var b=versionArray[1];var c=versionArray[2];if(f>parseFloat(g)){return true}else{if(f==parseFloat(g)){if(b>parseFloat(e)){return true}else{if(b==parseFloat(e)){if(c>=parseFloat(d)){return true}}}}}return false}}}function AC_AddExtension(c,b){if(c.indexOf("?")!=-1){return c.replace(/\?/,b+"?")}else{return c+b}}function AC_Generateobj(f,e,b){var d="";if(isIE&&isWin&&!isOpera){d+="<object ";for(var c in f){d+=c+'="'+f[c]+'" '}for(var c in e){d+='><param name="'+c+'" value="'+e[c]+'" /> '}d+="></object>"}else{d+="<embed ";for(var c in b){d+=c+'="'+b[c]+'" '}d+="> </embed>"}document.write(d)}function AC_FL_RunContent(){var b=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(b.objAttrs,b.params,b.embedAttrs)}function AC_GetArgs(c,f,h,e,j){var b=new Object();b.embedAttrs=new Object();b.params=new Object();b.objAttrs=new Object();for(var d=0;d<c.length;d=d+2){var g=c[d].toLowerCase();switch(g){case"classid":break;case"pluginspage":b.embedAttrs[c[d]]=c[d+1];break;case"src":case"movie":c[d+1]=AC_AddExtension(c[d+1],f);b.embedAttrs.src=c[d+1];b.params[h]=c[d+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":b.objAttrs[c[d]]=c[d+1];break;case"id":case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":b.embedAttrs[c[d]]=b.objAttrs[c[d]]=c[d+1];break;default:b.embedAttrs[c[d]]=b.params[c[d]]=c[d+1]}}b.objAttrs.classid=e;if(j){b.embedAttrs.type=j}return b}var BF_ANNOUNCEMENT={announcement:false,cookie_name:"bf_announce",set:function(d,c,b){if(typeof(b)=="undefined"){b={}}if(!b.close){b.close=false}BF_ANNOUNCEMENT.announcement={id:d,text:c,close:(close?true:false)};if(BF_ANNOUNCEMENT._get_cookie(BF_ANNOUNCEMENT.cookie_name)!=BF_ANNOUNCEMENT.announcement.id){document.write('<div id="bar_announcement"><div id="bar_announcement_area" class="c">'+(b.close?'<a id="announcement_close" class="close" href="javascript:;">'+b.close.text+"</a>":"")+"<p>"+c+"</p></div></div>");if(b.close){$("announcement_close").observe("click",function(f){if(b.close.handler){try{b.close.handler(f)}catch(f){}}else{}return false})}if($$(".react")){$$(".react").each(function(f,e){f.observe("click",function(h){var g=h.target.getAttribute("rel:reaction");if(typeof g!="undefined"){BF_ANNOUNCEMENT.react(g)}})})}if($("feedback_email")){$("feedback_email").observe("click",function(f){gtrack.track_events(BF_ANNOUNCEMENT.announcement.id+":announcement_bar","feedback/email","")})}}},react:function(b){gtrack.track_events(BF_ANNOUNCEMENT.announcement.id+":announcement_bar","feedback/"+b,"");$("announcement_bar_react").hide();$("announcement_bar_thanks").show()},close:function(b){var c=BF_ANNOUNCEMENT.announcement.expires;if(!c){c=2592000000}BF_ANNOUNCEMENT._set_cookie(BF_ANNOUNCEMENT.cookie_name,BF_ANNOUNCEMENT.announcement.id);$("bar_announcement").hide()},_get_cookie:function(c){if(BF_ANNOUNCEMENT._has_cookie(c)){var b=document.cookie.match("(^|;) ?"+c+"=([^;]*)(;|$)");return unescape(b[2])}else{return false}},_has_cookie:function(d,b){var c=document.cookie.match("(^|;) ?"+d+"=([^;]*)(;|$)");if(b&&typeof(b)=="string"){b=RegExp(RegExp.escape(b))}return(c?(b&&b!=""?unescape(c[2]).match(b):(c[2]!=this.cookies_cancel)):false)},_set_cookie:function(m,c,j,g){var f=31536000000,b="",l="";if(j||j==0){f=parseInt(j)}if(f!=0){var k=new Date();k.setTime(k.getTime()+f);b="; expires="+k.toGMTString()}l=escape(m)+"="+escape(c)+b+"; path=/; domain=."+(g?escape(g):"buzzfeed.com");document.cookie=l}};var BF_Quiz=function(){this.quizes={};this.answerResponse="#{a} is the correct answer.";this.messages={generic:{tally:"You got #{x} out of #{y} right!",fb:"I got #{score} out of #{total}! How do you measure up?",tw:"I got #{score} out of #{total} on #{title}!",email_subject:"#{title}",email_body:"I got #{score} out of #{total}! \n\n #{link}"},personality:{fb:"I got #{result}! #{title}",tw:"I got #{result}! #{title}",email_body:"I got #{result}! \n\n #{link}"},checklist:{tally:local.t("You#{result_verb} #{checked} out of #{total}#{result_subject}"),fb:local.t("I#{result_verb} #{checked} out of #{total}#{result_subject} #{title}"),tw:local.t("I#{result_verb} #{checked} out of #{total}#{result_subject} #{title}"),email_body:local.t("I#{result_verb} #{checked} out of #{total}#{result_subject} \n\n #{link}")},"3397410":{fb_title:"I Got: #{result}! #{title}",fb_description:"#{outcome} - that’s why I’m doing Mute A Mate for Cancer Research UK! I’ve donated £3 by texting MUTE to 70200 and I promise #{fb_promise} for at least a week. Take the quiz to find out what your sin is, donate and pass it on! <b>Text costs £3 plus 1 standard rate text. CRUK receives £2.93. UK mobiles 16+ only. T&Cs @ cruk.org/text. Queries? 0300 1231861</b>",tw:"I Got #{result}! #{title} Let's #MuteAMate for Cancer Research UK! ",email_subject:"Quiz: #{title}",email_body:"I Got: #{result}! #{title}\n\n#{link}\n\n#{outcome} – that’s why I’m doing Mute A Mate for Cancer Research UK! I’ve donated £3 by texting MUTE to 70200 and I promise #{email_promise} for at least a week. Take the quiz to find out what your sin is, donate and pass it on!\nText costs £3 plus 1 standard rate text. CRUK receives £2.93. UK mobiles 16+ only. T&Cs @ cruk.org/text. Queries? 0300 1231861"}};this.init=function(){var b=$(document.body)[bfjs.selector]("#buzz_sub_buzz .quiz");bfjs.universal_each(b,function(d,m){var k=$(d)[bfjs.read_attr]("rel:quiz_type");var c=$(d)[bfjs.read_attr]("rel:id");var f=$(d)[bfjs.read_attr]("rel:swap")=="1"?true:false;var g=$(d)[bfjs.selector](".quiz_question");var j=(k=="single question")?".quiz_reveal":".quiz_result";var h=$(d)[bfjs.selector](j);var e=$(d)[bfjs.read_attr]("rel:question_count");var l=$(d)[bfjs.selector](".quiz_result_area").first();bf_quiz.quizes[m]={};bf_quiz.quizes[m]["id"]=c;bf_quiz.quizes[m]["type"]=k;bf_quiz.quizes[m]["swap"]=f;bf_quiz.quizes[m]["el"]=$(d);bf_quiz.quizes[m]["questions"]={};bf_quiz.quizes[m]["results"]={};bf_quiz.quizes[m]["question_count"]=e;bf_quiz.quizes[m]["quiz_result_area_el"]=l;bf_quiz.quizes[m]["completed"]=false;bf_quiz.quizes[m]["result_verb"]=$(d)[bfjs.read_attr]("rel:result_verb");bf_quiz.quizes[m]["result_subject"]=$(d)[bfjs.read_attr]("rel:result_subject");bf_quiz.quizes[m]["answer_positions"]=[];bf_quiz.quizes[m]["el"][bfjs.add_class](bf_quiz.quizes[m]["type"].replace(" ","_")+"_quiz");if(bf_quiz.isChecklist(bf_quiz.quizes[m]["type"])){bf_quiz.quizes[m].el[bfjs.selector](".show_results").first()[bfjs.observer]("click",function(n){$(n.target)[bfjs.up](".show_results_container").hide();bf_quiz.quiz_shares(bf_quiz.quizes[m]);bf_quiz.show_results(bf_quiz.quizes[m]);bf_quiz.quiz_complete(bf_quiz.quizes[m]);bfjs.universal_each(bf_quiz.quizes[m].questions[0].answers,function(p,o){if($(p)[bfjs.has_class]("selected")){return}bfjs.toggleClass(p,"deactivated",true)})})}bfjs.universal_each(g,function(s,u){var n=$(s)[bfjs.read_attr]("rel:id");var z=$(s)[bfjs.selector](".quiz_answer");var w=$(s)[bfjs.selector](".quiz_reveal");var p=$(s)[bfjs.read_attr]("rel:question_type");var t=bf_quiz.quizes[m]["questions"];t[u]={};t[u]["id"]=n;t[u]["el"]=$(s);t[u]["answers"]=z;t[u]["image"]=$(s)[bfjs.selector](".quiz_img").first();t[u]["reveal"]=w;t[u]["type"]=p;t[u]["response"]=null;t[u]["correct"]=null;t[u]["personality_index"]=null;var o=$(s)[bfjs.selector](".quiz_un_reveal");if(o.length>0){o.first()[bfjs.observer]("click",function(H){var B=$(t[u]["image"])[bfjs.read_attr]("rel:question_src");var F=$(t[u]["image"])[bfjs.read_attr]("rel:reveal_src");var A=$(t[u]["image"])[bfjs.read_attr]("src");var C=$(t[u]["image"])[bfjs.read_attr]("rel:attr");var E=$(t[u]["image"])[bfjs.read_attr]("rel:reveal_attr");var G=$(t[u]["image"])[bfjs.up]()[bfjs.selector](".buzz_attribution").first();var D="";if(F&&A==F){$(t[u]["image"])[bfjs.write_attr]("src",B);if(C){D=C}$(H.target)[bfjs.update_html]("Show new image")}else{if(F){if(E){D=E}$(t[u]["image"])[bfjs.write_attr]("src",F);$(H.target)[bfjs.update_html]("Show original image")}}if(G){G[bfjs.update_html](D)}})}bfjs.universal_each(z,function(B,A){var C=$(B);C[bfjs.observer]("mouseover",function(E){var D=E||window.event;if(!E.relatedTarget&&E.fromElement){E.relatedTarget=E.fromElement===E.target?E.toElement:E.fromElement}if((E.relatedTarget&&$(E.relatedTarget)[bfjs.up](".quiz_answer")==B)||B===t[u].response){return}if(B===t[u].response||(bf_quiz.isChecklist(bf_quiz.quizes[m].type)&&C[bfjs.has_class]("selected"))){return}bf_quiz.style(0,t[u],B)});C[bfjs.observer]("mouseout",function(E){var D=E||window.event;if(!E.target){E.target=E.srcElement||document}if(!E.relatedTarget&&E.fromElement){E.relatedTarget=E.fromElement===E.target?E.toElement:E.fromElement}if(bf_quiz.isChecklist(bf_quiz.quizes[m].type)&&C[bfjs.has_class]("selected")){return}if((E.relatedTarget&&$(E.relatedTarget)[bfjs.up](".quiz_answer")!=B)&&(E.target==B||$(E.target)[bfjs.up](".quiz_answer")==B)){bf_quiz.style(1,t[u],B)}});C[bfjs.observer]("click",function(D){if(D.target.nodeName.toLowerCase()=="a"&&$(D.target)[bfjs.up]()[bfjs.has_class]("sub_buzz_source_via")){return true}if(bf_quiz.isChecklist(bf_quiz.quizes[m].type)){return bf_quiz.toggleSelection(m,u,A)}bf_quiz.answered(m,u,A);bf_quiz.submit_quiz(bf_quiz.quizes[m])})})});bfjs.universal_each(h,function(n,o){var s=$(n)[bfjs.read_attr]("rel:range_start");var u=$(n)[bfjs.read_attr]("rel:range_end");var p=bf_quiz.quizes[m]["results"];var t=$(n)[bfjs.read_attr]("rel:id");p[o]={};p[o]["id"]=t;p[o]["el"]=$(n);p[o]["range_start"]=s;p[o]["range_end"]=u})})};this.style=function(b,c,f){var e=(typeof window.jQuery!="undefined")?"parents":"up";var d=$(c.el)[e](".quiz")[bfjs.read_attr]("rel:quiz_type");if(bf_quiz.isChecklist(d)){if(b==2){bfjs.toggleClass(f,"selected",true)}else{if(b==1){bfjs.toggleClass(f,"selected")}}}if((b==2||b>=4)&&c.response&&f==bfjs.getFirstEl(c.response)){bfjs.toggleClass(f,"selected",true)}if(b==0){bfjs.toggleClass(f,"deactivated")}else{if(b==1){if(!bfjs.universal_compare_els($(c.response),$(f))){bfjs.toggleClass(f,"selected");bfjs.toggleClass(f,"def_answer");if((c.type=="text"||c.type=="image")&&c.correct!=null){bfjs.toggleClass(f,"deactivated",true)}else{bfjs.toggleClass(f,"deactivated")}}}else{if(b==2){$(f)[bfjs.add_class]("selected");bfjs.toggleClass(f,"deactivated")}else{if(b==4){$(f)[bfjs.add_class]("correct_answer");bfjs.toggleClass(f,"deactivated")}else{if(b==5){$(f)[bfjs.add_class]("wrong_answer");bfjs.toggleClass(f,"deactivated",true)}}}}}};this.toggleSelection=function(l,e,j){var d=bf_quiz.quizes[l];var g=d.questions[e];var h=g.answers;var k=g.answers[j];var c=$(h[j])[bfjs.read_attr]("rel:id");var f=g.id;var b=$(k)[bfjs.has_class]("selected")?1:2;bf_quiz.style(b,g,k);if(b==2){bf_quiz.gaTrack("[ttp]:content","quiz-answer",[f,c].join("="))}};this.answered=function(k,e,j){var d=bf_quiz.quizes[k];var g=d.questions[e];var h=g.answers;var c=$(h[j])[bfjs.read_attr]("rel:id");var f=g.id;var b=1;d.answer_positions[e]=j;g.response=$(h[j]);g.correct=$(g.response)[bfjs.read_attr]("rel:correct")=="1"?true:false;g.personality_index=$(g.response)[bfjs.read_attr]("rel:personality_index");bfjs.universal_each(h,function(l){b=l===bfjs.getFirstEl(g.response)?2:1;bf_quiz.style(b,g,l)});if(d.type=="single question"){bf_quiz.show_answers(g,d);bf_quiz.show_results(d)}else{if(d.type=="standard"){bf_quiz.show_answers(g,d)}}bf_quiz.gaTrack("[ttp]:content","quiz-answer",[f,c].join("="))};this.submit_quiz=function(d){if(bf_quiz.quiz_complete(d)&&!d.completed){if(d.type!="single question"){bf_quiz.quiz_shares(d)}bf_quiz.show_results(d);d.completed=true;var b=bf_quiz.get_completed_quiz_result(d);if(d.answer_positions.length==d.question_count){var e=d.answer_positions}if(bfjs.isMobile()){var c=$.Event("quiz_complete");c.answer_data=d.answer_positions;c.el=b.el;$(document).trigger(c)}else{EventManager.fire("quiz_complete",e,b.el)}}};this.show_answers=function(b,d){var e=b.answers;var c=d?d.type:null;bf_quiz.disable_question(b);bfjs.universal_each(e,function(f){if(d.type=="single question"&&e.length<=1){return}if(c!="personality"){if($(f)[bfjs.read_attr]("rel:correct")=="1"){bf_quiz.style(4,b,f)}else{if(f===bfjs.getFirstEl(b.response)){bf_quiz.style(5,b,f)}}}});if(c=="single question"||c=="standard"){bf_quiz.reveal(b,d)}};this.save=function(d){if(typeof BF_Pixel=="undefined"){return false}var g={};g.quiz=d.id;if(bf_quiz.isChecklist(d.type)){var f=new Array;for(x in d.questions){var b=d.questions[x];for(y in b.answers){var e=b.answers[y];if(typeof e=="object"){var c=$(e)[bfjs.has_class]("selected"),h=$(e)[bfjs.read_attr]("rel:id");if(c){f.push(h)}}}}g.answers=f.join()}else{for(x in d.questions){var b=d.questions[x];g[b.id]=$(b.response)[bfjs.read_attr]("rel:id")}}BF_Pixel.save({dir:"quiz",params:g})};this.show_results=function(d){var e=d.swap;var g=d.questions;var h=d.results;var n=bf_quiz.get_completed_quiz_result(d);var c=n?$(n.el)[bfjs.selector](".answer_response").first():null;for(q in g){bf_quiz.disable_question(g[q])}if($(d.quiz_result_area_el)){$(d.quiz_result_area_el).show()}if(d.type=="personality"){if(n){$(d.el)[bfjs.selector](".quiz_tally_results").first().show();$(d.el)[bfjs.selector](".quiz_tally").first().hide();$(n.el).show();if(typeof window.BF_Effect!="undefined"){BF_Effect.ScrollIntoView($(n.el))}if(n){c.hide()}}}else{if(d.type=="single question"){if(d.questions[0].answers.length>1){var f=d.questions[0];var l=$(f.el)[bfjs.selector](".answer_response");var m=bf_quiz.correct_answer(f);var b=f.correct?"Correct! ":"Wrong! ";if(l.size()>0){$(l[0])[bfjs.add_class](f.correct?"correct":"wrong")[bfjs.selector](".message_text").first()[bfjs.update_html](b)}else{if(n){c.hide()}}}}else{if(bf_quiz.isChecklist(d.type)){var k=bf_quiz.get_message("checklist","tally",{"#{result_verb}":d.result_verb,"#{result_subject}":d.result_subject});k=local.t(k,{variables:{total:d.questions[0].answers.length,checked:bf_quiz.number_selected(d)}});var j=$(d.el)[bfjs.selector](".quiz_tally").first();$(j)[bfjs.update_html](k);$(d.el)[bfjs.selector](".quiz_tally_results").first().show();if(n){$(n.el).show();if(typeof window.BF_Effect!="undefined"){BF_Effect.ScrollIntoView($(n.el))}c.hide()}}else{var k=bf_quiz.get_message("generic","tally",{"#{x}":bf_quiz.number_correct(d),"#{y}":d.question_count});var j=$(d.el)[bfjs.selector](".quiz_tally").first();$(j)[bfjs.update_html](k);$(d.el)[bfjs.selector](".quiz_tally_results").first().show();if(d.type=="percentage"){for(q in d.questions){bf_quiz.show_answers(d.questions[q],d)}}if(n){c.hide();$(n.el).show()}}}}};this.disable_question=function(b){var c=b.answers;for(a in c){if(typeof c[a]!="object"||!$(c[a])){continue}$(c[a])[bfjs.stop_observing]("mouseover");$(c[a])[bfjs.stop_observing]("mouseout");$(c[a])[bfjs.stop_observing]("click");bfjs.setStyle($(c[a]),{cursor:"default"})}};this.get_message=function(e,b,f){var d=bf_quiz.messages.generic[b];if(bf_quiz.messages.hasOwnProperty(e)&&bf_quiz.messages[e].hasOwnProperty(b)){d=bf_quiz.messages[e][b]}d=local.t(d);for(var c in f){if(!f.hasOwnProperty(c)){continue}f[c]=typeof(f[c])=="string"?f[c].replace("$","$/"):f[c];d=d.replace(c,f[c])}d=d.replace("$/","$");return d};this.get_completed_quiz_result=function(f){var e=f.results;if(f.type=="personality"){var g=bf_quiz.personality(f);return e[g[0]]}else{if(f.type=="single question"){return e[0]}else{if(bf_quiz.isChecklist(f.type)){var d=bf_quiz.percent_checked(f);for(var c in e){var b=e[c];if(d>=b.range_start&&d<=b.range_end){return b}}}else{var d=bf_quiz.percent_correct(f);for(c in e){var b=e[c];if(d>=b.range_start&&d<=b.range_end){return b}}}}}return false};this.reveal=function(b,g){var h,e,d;if(b.reveal){if(b.image&&b.image[bfjs.read_attr]("rel:reveal_src")){b.image[bfjs.write_attr]("rel:question_src",b.image[bfjs.read_attr]("src"));b.image[bfjs.write_attr]("src",b.image[bfjs.read_attr]("rel:reveal_src"));d=b.image[bfjs.read_attr]("rel:reveal_attr");if(d){h=b.image[bfjs.up]()[bfjs.selector](".buzz_attribution").first();if(h){e=bfjs.getFirstEl(h).innerText||bfjs.getFirstEl(h).textContent;if(e){b.image[bfjs.write_attr]("rel:attr",e.replace('"',"&quot;"))}h[bfjs.update_html](d)}}}if($(b.el)[bfjs.selector](".reveal_embed").length>0){$(b.el)[bfjs.selector](".reveal_embed").first().show();$(b.el)[bfjs.selector](".question_embed").first().hide()}bfjs.universal_each(b.reveal,function(k){$(k).show()})}if(g.type!="single question"||(g.type=="single question"&&b.answers.length>1)){var j=$(b.el)[bfjs.selector](".answer_response");var c=bf_quiz.correct_answer(b);var f=b.correct?local.t("Correct!"):local.t("Wrong!");if(j.size()>0){$(j[0])[bfjs.add_class](b.correct?"correct":"wrong")[bfjs.selector](".message_text").first()[bfjs.update_html](f)}}};this.correct_answer=function(b){bfjs.universal_each(b.answers,function(c){if($(c)[bfjs.read_attr]("rel:correct")=="1"){return $(c)}});return null};this.personality=function(g){var c=0;var e=[];for(f in g.results){e[f]=0}for(f in g.questions){var d=g.questions[f];e[d.personality_index]++;c++}var b=0;for(var f=e.length-1;f>=0;f--){if(e[f]>b){b=e[f]}}var h=[];for(var f=e.length-1;f>=0;f--){if(e[f]==b){h.push(f)}}return h};this.percent_checked=function(d){var c=bf_quiz.number_selected(d);var b=d.questions[0].answers.length;return Math.round((c/b)*100)};this.percent_correct=function(d){var b=0;var e=0;for(i in d.questions){var c=d.questions[i];b++;if(c.correct==true){e++}}return Math.round((e/b)*100)};this.number_selected=function(b){return b.el[bfjs.selector](".quiz_answer.selected").length};this.number_correct=function(c){var d=0;for(i in c.questions){var b=c.questions[i];if(b.correct==true){d++}}return d};this.quiz_complete=function(e){var d=bf_quiz.GALabel(e),c="quiz-complete";if(!bf_quiz.isChecklist(e.type)){for(i in e.questions){var b=e.questions[i];if(b.correct==null){return false}}}if(e.type=="personality"){if(bf_quiz.personality(e).length>1){c="quiz-complete-ties"}}if(bfjs.isMobile()){$(".answer_shares_buttons a").each(function(){$(this).attr("data-label",d)})}bf_quiz.gaTrack("[ttp]:content",c,d);bf_quiz.save(e);return true};this.GALabel=function(d){var b="";if(d.type=="personality"){var f=bf_quiz.personality(d),e=[];for(var c=0;c<f.length;c++){e.push(d.results[f[c]]["id"])}b=d.id+"="+e.join(",")}else{if(bf_quiz.isChecklist(d.type)){b=bf_quiz.number_selected(d)+" out "+d.questions[0].answers.length}else{b=bf_quiz.number_correct(d)+" out "+d.question_count}}return b};this.isChecklist=function(b){var c=["checklist","image checklist"];return c.indexOf(b)>-1};this.quiz_shares=function(b){try{if(bf_quiz.isLegacyApp()){$(b.el)[bfjs.selector](".answer_shares").hide();return false}var m=bf_quiz.get_completed_quiz_result(b),l,e=m&&m.el?$(m.el)[bfjs.read_attr]("rel:description"):"";var h={el:$(b.el)[bfjs.selector](".answer_shares .answer_shares_buttons").first(),buzz_uri:(BF_STATIC.mobile_app?$(b.el).attr("rel:buzz_uri"):window.location),buzz_name:(bfjs.isMobile()?$("<div/>").html(BF_STATIC.buzz_name).text():BF_UI.renderEntities(BF_STATIC.buzz_name)),buzz_blurb:(bfjs.isMobile()?$("<div/>").html(BF_STATIC.buzz_blurb).text():BF_UI.renderEntities(BF_STATIC.buzz_blurb)),picture:m&&$(m.el)[bfjs.selector](".result_img").size()>0?$(m.el)[bfjs.selector](".result_img")[0].src:"",result_description:(bfjs.isMobile()?$("<div/>").html(e).text():BF_UI.renderEntities(e)),fb_title:"",fb_blurb:"",tw_blurb:"",tw_hashtags:typeof ad_tw_hashtags!="undefined"?ad_tw_hashtags:"",tw_via:$(b.el)[bfjs.selector](".quiz_tally_results").first()[bfjs.read_attr]("rel:tweet_via")||"BuzzFeed",email_subject:"",email_body:""};if(typeof pound!="undefined"){h.buzz_uri={href:pound.urls.unescaped.queryStringOnly(),toString:pound.urls.unescaped.queryStringOnly}}var g={"#{title}":h.buzz_name,"#{link}":h.buzz_uri,"#{result_verb}":b.result_verb,"#{result_subject}":b.result_subject};if(b.type=="personality"&&!bf_quiz.post_rec){g["#{result}"]=$(m.el)[bfjs.read_attr]("rel:name");h.fb_title=bf_quiz.get_message("personality","fb",g);h.fb_blurb=h.result_description?h.result_description:h.buzz_blurb;h.tw_blurb=bf_quiz.get_message("personality","tw",g);h.email_subject=bf_quiz.get_message("personality","email_subject",g);if(!unescape(h.email_subject).match("Quiz:")){h.email_subject="Quiz: "+h.email_subject}h.email_body=bf_quiz.get_message("personality","email_body",g)}else{if(b.type=="personality"&&bf_quiz.post_rec){g["#{result}"]=$(m.el)[bfjs.read_attr]("rel:name");h.fb_title=h.buzz_name;h.fb_blurb=h.buzz_blurb;h.tw_blurb=h.buzz_name;h.email_subject=h.buzz_name;if(!unescape(h.email_subject).match("Quiz:")){h.email_subject="Quiz: "+h.email_subject}h.email_body=h.buzz_name+"  "+(h.buzz_uri.href||h.buzz_uri)}else{if(bf_quiz.isChecklist(b.type)){g["#{checked}"]=bf_quiz.number_selected(b);g["#{total}"]=b.questions[0].answers.length;h.fb_title=bf_quiz.get_message("checklist","fb",g);h.fb_blurb=h.result_description||h.buzz_blurb;h.tw_blurb=bf_quiz.get_message("checklist","tw",g);h.email_subject=bf_quiz.get_message("checklist","email_subject",g);if(!unescape(h.email_subject).match("Quiz:")){h.email_subject="Quiz: "+h.email_subject}h.email_body=bf_quiz.get_message("checklist","email_body",g)}else{g["#{score}"]=bf_quiz.number_correct(b);g["#{total}"]=b.question_count;h.fb_title=h.buzz_name;h.fb_blurb=bf_quiz.get_message("generic","fb",g);h.tw_blurb=bf_quiz.get_message("generic","tw",g);h.email_subject=bf_quiz.get_message("generic","email_subject",g);if(!unescape(h.email_subject).match("Quiz:")){h.email_subject="Quiz: "+h.email_subject}h.email_body=bf_quiz.get_message("generic","email_body",g)}}}if(BF_STATIC.campaignid=="1931201"){var k="Remember to eat your cereal, not your serial killers.";h.fb_blurb=k;h.tw_blurb=h.buzz_name+" "+k;h.tw_hashtags="ripperstreet";h.email_subject=bf_quiz.get_message("generic","email_subject",{"#{title}":h.buzz_name});h.email_body=k+" "+escape(h.buzz_uri)}if(BF_STATIC.campaignid=="3397410"){var c={"Constant Commentator":"I’m an over-sharer and proud","Too Proud Parent":"I’m all about my brilliant brood",Failosopher:"I love getting deep and meaningful",Animaniac:"I admit it, I’m all about the cute animals","Smug Couple":"I’m loved up and you’re tired of seeing it","Score Bore":"I’ve been boring you with my gym brags","Social Show-Off":"I’ve been flaunting the high life on here too long","Foodie Fanatic":"I’ve been over-sharing my food snaps",Lurker:"Okay, I spend too much time looking at other peoples’ updates"};var f={"Constant Commentator":"to stop my constant updates","Too Proud Parent":"to stop boasting about my babies",Failosopher:"to stop posting deep and meaningful messages",Animaniac:"to stop all the animal pictures","Smug Couple":"to stop updating you all on my love life","Score Bore":"to stop boasting about my gym time","Social Show-Off":"to stop showing-off","Foodie Fanatic":"to stop posting food photos",Lurker:"to stop lurking"};var j={"Constant Commentator":"to stop these posts","Too Proud Parent":"to stop these posts",Failosopher:"to stop these posts",Animaniac:"to stop these posts","Smug Couple":"to stop these posts","Score Bore":"to stop these posts","Social Show-Off":"to stop these posts","Foodie Fanatic":"to stop these posts",Lurker:"to stop lurking"};g["#{outcome}"]=c[g["#{result}"]];g["#{fb_promise}"]=f[g["#{result}"]];g["#{email_promise}"]=j[g["#{result}"]];h.fb_title=bf_quiz.get_message("3397410","fb_title",g);h.fb_blurb=bf_quiz.get_message("3397410","fb_description",g);h.email_subject=bf_quiz.get_message("3397410","email_subject",g);h.email_body=bf_quiz.get_message("3397410","email_body",g);g["#{title}"]="What's Your Social Media Sin?";g["#{link}"]=escape(h.buzz_uri);h.tw_blurb=bf_quiz.get_message("3397410","tw",g)}$(h.el).show();if(bfjs.isMobile()){$(document.body)[bfjs.selector](".share-buttons.position-lower")[bfjs.add_class]("hidden");$(document.body)[bfjs.selector](".share-buttons.position-quiz .fb-share-dialog a")[bfjs.observer]("click",function(o){o.preventDefault();var n={name:unescape(h.fb_title),description:unescape(h.fb_blurb),link:h.buzz_uri.toString(),picture:h.picture,parent_id:"share-buttons-quiz"};n.parent_id="subbuzz-share";n.category="MobileBuzz:content";n.action=$(o).data("action");n.legacy_url=n.link.replace(/^http\:\/\/[a-z\.]*\//,"/");Share.facebook(n)});$(document.body)[bfjs.selector](".share-buttons.position-quiz .tweet_btn a")[bfjs.observer]("click",function(o){o.preventDefault();var n={text:h.tw_blurb,url:h.buzz_uri,via:h.tw_via,parent_id:"share-buttons-quiz",legacy_url:document.URL.replace(/[?#].*$/g,"")};n.category="MobileBuzz:content";n.action=$(o).data("action");Share.twitter(n)});$(document.body)[bfjs.selector](".share-buttons.position-quiz .pin a")[bfjs.observer]("click",function(o){o.preventDefault();var n={media:h.picture,description:h.tw_blurb,url:h.buzz_uri,parent_id:"share-buttons-quiz",legacy_url:document.URL.replace(/[?#].*$/g,"")};n.category="MobileBuzz:content";n.action=$(o).data("action");Share.pinterest(n)});$(document.body)[bfjs.selector](".share-buttons.position-quiz .email a")[bfjs.observer]("click",function(o){o.preventDefault();var n={subject:h.email_subject,body:h.email_body,parent_id:"share-buttons-quiz"};Share.email(n)})}else{sharing.buttons.facebook_share({parentNode:h.el,url:h.buzz_uri,blurb:h.fb_blurb,picture:h.picture,title:h.fb_title,gt_label:bf_quiz.GALabel(b)});sharing.buttons.twitter({parentNode:h.el,url:h.buzz_uri,blurb:h.tw_blurb,hashtags:h.tw_hashtags,via:h.tw_via,gt_label:bf_quiz.GALabel(b)});sharing.buttons.email({method:"mailto",parentNode:h.el,subject:h.email_subject,body:h.email_body,gt_label:bf_quiz.GALabel(b)})}}catch(d){console.error(d)}};this.gaTrack=function(b,c,d){if(typeof gtrack!="undefined"){gtrack.track_events(b,c,d)}};this.isLegacyApp=function(){var f=false;if(BF_STATIC.mobile_app){switch(BF_STATIC.os){case"ios":var d=navigator.userAgent.toLowerCase(),b=/(buzzfeed\/)([^\s]+)/,c=33000,g,e;e=b.exec(d);g=(e)?parseInt(e[2]):0;f=g<=c;break;case"android":f=typeof buzzshare!=="undefined";break}}return f}};var bf_quiz=new BF_Quiz();bfjs.onPageLoad(bf_quiz.init);BF_Related=function(){this.related_links_controller="/buzzfeed/_related_links";this.init=function(){if(!acl.user_can("general_admin")){return}related.assign_handlers()};this.assign_handlers=function(){universal_dom.assign_handler({bucket:"update-related",handler:related.update_related,event:"click"});universal_dom.assign_handler({bucket:"related-cancel",handler:related.related_cancel,event:"click"});universal_dom.assign_handler({bucket:"related-save",handler:related.save_related,event:"click"})};this.update_related=function(args){if(args.buzz_id){var dialog=$$(".update_related")[0];var dialogWidth=dialog.getWidth();var dialogHeight=dialog.getHeight();var topPos=args.clientY;related.show_body_overlay();dialog.show();if((topPos+dialogHeight)>BF_UTIL.browser.dimensions.height()){topPos=BF_UTIL.browser.dimensions.height()-dialogHeight}dialog.setStyle({left:args.clientX+"px",top:topPos+"px",position:"fixed"})}else{console.log("update_related: Invalid buzz id")}};this.related_cancel=function(){if($("bodyOverlay")){document.body.removeChild($("bodyOverlay"))}$("save_spinner").hide();var dialog=$$(".update_related")[0];dialog.hide()};this.show_body_overlay=function(){var bodyHeight=document.body.getHeight();var bodyWidth=document.body.getWidth();if(!$("bodyOverlay")){var overlay=document.createElement("div");overlay.setAttribute("id","bodyOverlay");overlay.setStyle({width:bodyWidth+"px",height:bodyHeight+"px"});document.body.appendChild(overlay)}};this.save_related=function(args){if(args.buzz_id){$("save_spinner").show();var newRelated=new Array();var related_input=$$(".related_input");for(var i=related_input.length;i>=1;i--){if($("related"+i)!=undefined&&$("related"+i).value!==undefined&&$("related"+i).value!=""){newRelated.push($("related"+i).value)}}var params={action:"validate_and_save",campaignid:args.buzz_id,related_urls:JSON.stringify(newRelated)};(new BF_Request()).request("/buzzfeed/_related_links",{method:"get",parameters:params,onSuccess:function(r){var obj=eval("("+r.responseText+")");console.log(obj.number);if(obj.success==0){related.error(obj.message)}else{if(obj.number==0){related.error("No urls could be validated. Must be buzzfeed.com links.")}else{if(newRelated.length>obj.number){related.error("Only "+obj.number+" out of "+newRelated.length+" urls could be validated.")}}}related.related_cancel()},onFailure:function(r){var obj=eval("("+r.responseText+")");related.error(obj.message||"save_related: validate and save failure")}})}else{console.log("save_related: Invalid buzz id")}};this.error=function(message){console.log("related.error");(new BF_Request()).alert(message)}};var related=new BF_Related();BuzzLoader.register(function(){related.init()},2);var BF_user_page=function(){this.init=function(){user_page.resize_embeds()};this.resize_embeds=function(){if(BF_STATIC.tt_page=="User"){$$(".buzz_superlist_item_embed").each(function(d){var c=d.select("iframe")[0];if(c){var e=c.getAttribute("height");var f=c.getAttribute("width");if(f>625){c.setAttribute("width",625);var b=(625/f);e=Math.floor(e*b);c.setAttribute("height",e)}}})}}};var user_page=new BF_user_page();BuzzLoader.register(user_page.init,5);var BF_bpage=function(){this.lastScrollPos=0;this.more_loaded=false;this.init=function(){if($$(".graphic_image_wrapper")[0]){$$(".graphic_image_wrapper").each(function(k){bpage.set_box_blur(k)})}universal_dom.assign_handler({bucket:"bpage_tweet",event:"click",handler:bpage.tweet});universal_dom.assign_handler({bucket:"more_shares",event:"mouseover",handler:bpage.load_more_shares});universal_dom.assign_handler({bucket:"share_link",event:"click",handler:bpage.copy_link});universal_dom.assign_handler({bucket:"pinterest",event:"click",handler:bpage.pinterest});universal_dom.assign_handler({bucket:"sticky_popup_button",event:"click",handler:bpage.hide_other_popups});universal_dom.assign_handler({bucket:"print_btn",event:"click",handler:bpage.show_popup});universal_dom.assign_handler({bucket:"toggleBreakingSummary",event:"click",handler:bpage.toggleBreakingSummary});bpage.update_bottom_shares();bpage.dedupe_buzz();bpage.update_upper_shares();bpage.arrange_badges();bpage.loadSummary();var h=abtest.abVariations.split(",");if(h.indexOf("promo_var_1")!=-1){console.log(h.indexOf("promo_var_1"))}if(h.indexOf("promo_var_1")!=-1){if($("bpage-bottom-dfp")){$("bpage-bottom-dfp").removeClassName("bpage-lower-dfp");var d=$("bpage-bottom-dfp").select(".bf-image-big")[0];d.width=125;d.height=83}}var c=abtest.abVariations.split(","),f=["sharing_vertical","sharing_ref"],j,g;bpage.show_dfp(c);if(c.intersect(f)[0]!=undefined){var b=c.intersect(f)[0];if(b=="sharing_ref"){$(b).select(".share_div").each(function(k){if(!k.hasClassName("hidden")){j=k.select("#link_parent")[0];g=k.select(".link_bottom")[0]}})}else{if(b=="sharing_vertical"){j=$(b).select("#link_parent")[0];g=$(b).select(".link_bottom")[0]}}}if(c.indexOf("related_two")!=-1){bpage.related_img_reset()}if(c.indexOf("related_two")!=-1){var e=$("related_two").select(".subbuzzpromo li")[3];if(e){e.removeClassName("hidden")}}if(isIE8()){bpage.set_quote_style()}EventManager.observe("badge_vote:vote_init",function(k){bpage.custom_badge_vote(k)});if(BF_STATIC.tt_page=="Buzz"){Event.observe(window,"scroll",function(l){var k=$$(".PageFooter")[0].viewportOffset().top+100;if((k<document.viewport.getHeight())&&!bpage.more_loaded){bpage._more_stuff_init()}})}if(typeof(BF_KeyControls)=="function"){bpage.keycontrols()}bpage.dedupe_sidebar();bpage.hide_indepth_buzz();bpage.load_hot_on_pinterest()};this.show_popup=function(){window.print()};this.referrer=function(b){var b=document.referrer;if(b.match("pinterest")){return"pinterest"}else{if(b.match("t.co")){return"tweet"}else{return null}}};this.update_bottom_shares=function(){if(!$$(".bottom_shares .shareBtn").length){setTimeout(this.update_bottom_shares,250);return}var f=$$(".bottom_shares").first();var d=$$(".bottom_shares .referrer_shares .shareBtn");var b=$$(".bottom_shares .vertical_shares .shareBtn");var l=$$(".bottom_shares .other_shares .shareBtn");var e=$$(".bottom_shares #more_shares_box .shareBtn");var g=bpage.referrer();var j=(g)?g+"_share":null;var c=objExists(BF_STATIC.vertical)?BF_STATIC.vertical:"";var k=$("buzz_sub_buzz")&&$("buzz_sub_buzz").hasClassName("suplist_long")?true:false;var h=[];if(!d||!b||!f){return false}if(f.hasClassName("hidden")){f.removeClassName("hidden")}d.each(function(n){var o=$(n).findParent("div"),m=null;if(o){if(g){m=j}else{m="fb_share"}$(o).hasClassName(m)?h.push(m):$(o).remove()}});b.each(function(n){var o=$(n).findParent("div"),m=null;if(o){if(j=="pinterest_share"||j=="tweet_share"){m="fb_share"}else{m="tweet_share"}$(o).hasClassName(m)?h.push(m):$(o).remove()}});l.each(function(m){var n=$(m).findParent("div");if(n&&j){if($(n).hasClassName(j)){$(n).remove()}}});bpage.remove_dupe_shares(e,h)};this.remove_dupe_shares=function(b,c){c.each(function(d){b.each(function(g){var f=$(g).findParent("div");if($(f).hasClassName(d)){$(f).remove()}})})};this.copy_link=function(j){var d=j.element;if(!d){return false}if($("shares-copy-link").visible()){$("shares-copy-link").hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}return false}var h=$(d).getAttribute("rel:link");var c={left:Number($(d).positionedOffset()[0]),top:Number($(d).positionedOffset()[1]),height:Number($(d).getHeight()),width:Number($(d).getWidth())};var f={width:300};var g={height:10,width:10};var b=$$("#shares-copy-link .arrow");$(d).insert({after:$("shares-copy-link")});$("shares-copy-link").setStyle({left:(c.left-(f.width/2))+"px",top:(c.top+c.height+(g.height/2))+"px"});b.each(function(e,k){$(e).setStyle({left:(175-g.width+k)+"px",top:(k-g.height)+"px"})});$$("#shares-copy-link input")[0].setAttribute("value",h);$("shares-copy-link").show();Selector.findChildElements($("shares-copy-link"),["input"])[0].select();if(typeof bf_rdio!="undefined"){bf_rdio.disable()}BF_Effect.ScrollIntoView("shares-copy-link")};this.dedupe_buzz=function(){var d=$$('meta[property="bf:buzzid"]'),b=d.length?d[0].readAttribute("content"):null;if(b){$$(".sidebar_featured_unit .small-posts").each(function(e){if($(e).hasAttribute("rel:buzz_id")){if($(e).getAttribute("rel:buzz_id")==b){$(e).remove()}}});if($("next_on_1")){if($("next_on_1").hasAttribute("rel:buzz_id")){var c=$("next_on_1").readAttribute("rel:buzz_id");if(b==c){if($("next_on_1")){$("next_on_1").hide()}if($("next_on_2")){$("next_on_2").show()}}}}}};this.update_upper_shares=function(){var d=bpage.referrer(),b=$("pin_ref"),c=$("tweet_ref"),e=$("share_control");if(!b||!e){return}if(d=="pinterest"){b.removeClassName("hidden");e.addClassName("hidden")}else{if(d=="tweet"){c.removeClassName("hidden");e.addClassName("hidden")}else{if(!b.hasClassName("hidden")){b.addClassName("hidden")}if(e.hasClassName("hidden")){e.removeClassName("hidden")}}}};this.tweet=function(f){data=f.target;var c=f.target.getAttribute("rel:tw_url");var g=escape(f.target.getAttribute("rel:tw_text"));var b=f.target.getAttribute("rel:tw_via");var d="http://twitter.com/intent/tweet?url="+c+"&text="+g+"&via="+b;window.open(d,"_blank","width=600, height=300")};this.pinterest=function(){var u=function(A,B){var z=200;var C=200;var e="";if(A>B){z=A/(B/200);e="margin-left: "+(0-(z-200)/2)+"px"}else{if(A<B){C=B/(A/200);e="margin-top: "+(0-(C-200)/2)+"px"}}return{img_width:z,img_height:C,img_style:e}};var p=function(){var e=document.createElement("SPAN");e.addClassName("pin_image");e.innerHTML='<span class="loading_pin_image"></span>';return e};var g=function(z){var e=0,A=0;if(isIE7()||isIE8()){e=z.width;A=z.height}else{e=z.naturalWidth;A=z.naturalHeight}return{w:e,h:A}};var d=function(G,C,I,w,F,A,H,D,e,z,B){var E=new Template($("pin_img_template").innerHTML);return E.evaluate({img_style:G,img_src:C,img_width:I,img_height:w,img_n_width:F,img_n_height:A,ieheight:H,scroll_pos:D,url:e,media:z,desc:B})};bpage.lastScrollPos=$(document.viewport).getScrollOffsets().top;window.scrollTo(0,0);var n=BF_UTIL.browser.dimensions.height();$("pin_bg").setStyle({height:n+"px"});$("pin_bd").setStyle({height:n+"px"});document.body.appendChild($("pin_bg").show());document.body.appendChild($("pin_bd").show());var f=BF_STATIC.page="Videos"&&typeof videopromo!="undefined"?videopromo:$("post-"+BF_STATIC.campaignid).readAttribute("rel:data").evalJSON();var h=undefined;if(typeof pound!="undefined"){h=pound.urls.queryStringOnly()}else{if(BF_STATIC.tt_page=="Videos"&&videopromo!=undefined&&videopromo.uri){h="http://www.buzzfeed.com/"+videopromo.uri}else{h="http://www.buzzfeed.com/"+BF_STATIC.username+"/"+f.uri}}if($("pin_img_container").innerHTML){$("pin_img_container").innerHTML=""}var t=Prototype.Browser.IE?636:336;var j=$s("title").innerHTML.replace(/'/g,"%27").replaceAll("&nbsp;"," ").unescapeHTML().stripTags().trim();var m=function(e,z,w){e.remove()};var c=function(){if($("pin_bg")){$("pin_bg").hide()}if($("pin_bd")){$("pin_bd").hide()}};var o=function(e,D,z,C){var E=g(this);var A=u(E.w,E.h);var G=A.img_width,w=A.img_height,F=A.img_style;var B=d(F,D,G,w,E.w,E.h,t,bpage.lastScrollPos,z,D,C);e.innerHTML=B.replaceAll("&lt;","<").replaceAll("&gt;",">");if(typeof pound=="undefined"){if(e.select("a").length){e.select("a")[0].observe("click",c)}}};var k=$$(".buzz_superlist_item_image,.buzz_superlist_item_grid_row,.buzz_superlist_item_video.video_instagram,.buzz_superlist_item_photoslider");if(k.length&&BF_STATIC.page!="Video"){k.each(function(z){var e,w;var A=z.id;if(A){e=A.split("superlist_")[1];z=z.select("img")}if(h.indexOf("?")>-1){w=encodeURIComponent(h+(e?"&sub="+e:""))}else{w=encodeURIComponent(h+(e?"?sub="+e:""))}z.each(function(D){var E="";var C=p();$("pin_img_container").appendChild(C);var B=new Image();B.onload=function(){var G=A?D.readAttribute("rel:bf_image_src"):$$('link[rel="image_src"]')[0].href;if(D.up(".buzz_superlist_item").select("h2").length){var F=Element.clone(D.up(".buzz_superlist_item").select("h2")[0],true);if(F.select("span.buzz_superlist_number_inline").length){F.select("span.buzz_superlist_number_inline")[0].remove()}E=F.innerHTML.stripTags().unescapeHTML().trim()}if(j){E=E?E+" | "+j:j}E=encodeURIComponent(E);o.apply(this,[C,G,w,E])};B.onabort=m.bind(null,C,l,1);B.onerror=m.bind(null,C,l,2);if(D.readAttribute("rel:bf_image_src")){B.src=D.readAttribute("rel:bf_image_src")}else{B.src=D.src}})})}else{var l=BF_STATIC.big_image_root+"/static/images/global/buzzfeed-logo.png";if($$('meta[property="og:image"]').length>0){l=$$('meta[property="og:image"]')[0].attributes.content.value}if(BF_STATIC.tt_page=="Videos"){l=videopromo.promo_image}var b=p();$("pin_img_container").appendChild(b);var s=new Image();s.onload=function(){o.apply(this,[b,l,encodeURIComponent(h),encodeURIComponent(j)])};s.onabort=m.bind(null,b,l,1);s.onerror=m.bind(null,b,l,2);s.src=l}};this.related_img_reset=function(){var e=$$(".related_var_2 .subbuzzpromo li.wide")[0];var c=e.select("img")[0];var d=c.getAttribute("src");var b=d.replace("_wide.jpg",".jpg");c.setAttribute("src",b)};this.show_dfp=function(c){var d=["related_control","related_one","related_two"];var b=c.intersect(d)[0];if(b=="related_two"){if($("related_one")){$("related_one").select(".related_dfp")[0].remove()}}else{if(b=="related_one"){if($("related_two")){$("related_two").select(".related_dfp")[0].remove()}}}};this.load_more_shares=function(n){var l,k,f,m,c=n.element,d=function(t){try{if(t){return t.className.match("arrow")}}catch(u){console.warn(u);return false}},j=function(t){try{if(t){return t===p||t.ancestors().indexOf(p)>=0}}catch(u){console.warn(u);return false}},o=function(t){try{if(t){return t===l||t.firstChild===l||t.ancestors().indexOf(l)>=0}}catch(u){console.warn(u);return false}};if(!c){return false}bpage.hide_all_popups();var p=$("more_shares_box");c.insert({after:p});var p=$("more_shares_box");var h=p.select(".shareBtn:not(.hidden)");if(h.length){if(h.length==1){p.setStyle({width:"104px"})}else{if(Math.floor(h.length/2)==(h.length/2)&&Math.floor(h.length/3)!=(h.length/3)){p.setStyle({width:"208px"})}}}var g={width:Number(p.getWidth())};var b={left:Number($(c).positionedOffset()[0]),top:Number($(c).positionedOffset()[1]),height:Number($(c).getHeight()),width:Number($(c).getWidth())};var s=p.select(".arrow");p.setStyle({left:(b.left-(g.width/2)+(b.width/2))+"px",top:(b.top+b.height)+"px"});s.each(function(e,t){$(e).setStyle({left:((g.width/2)-10+t)+"px",top:(t-10)+"px"})});p.show();if(typeof bf_rdio!="undefined"){bf_rdio.disable()}k=$(c).on("mouseout",function(u){var t=u.toElement?u.toElement:u.relatedTarget;if(d(t)||j(t)){return}k.stop();p.hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}});f=$(p).on("mouseout",function(u){var t=u.toElement?u.toElement:u.relatedTarget;l=$$(".gc-bubbleDefault").first();if(d(t)||j(t)){return}if(l){if(!m){m=$(l).on("mouseout",function(z){var w=z.toElement?z.toElement:z.relatedTarget;if(j(w)||o(w)){return}m.stop();p.hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}})}if(o(t)){return}}f.stop();p.hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}})};this.arrange_badges=function(){var c=$$(".wrap_badge");if(!c.length){return}c.each(function(g){if(g.hasClassName("disapprove")){var h=c.indexOf(g);c.splice(h,1);c.unshift(g);if(c.length>10){var f=c.length-10}}});var e=55;for(var d=0;d<=c.length;d++){if(c[d]){var b=getWidth(c[d].select("img")[0]);if(b>50){e=b+5}if(d!=0){c[d].setStyle({left:e+"px"});e+=55}}}};this.hide_other_popups=function(d){var c=d.element,b=$$(".sticky-popup"),f=c.nextSiblings(".sticky-popup")[0];if(c.getAttribute("rel:gt_act")!=="share/email"){shareEmail.current_button=null}b.each(function(e){if(e!==f){e.setStyle({display:"none"})}})};this.hide_all_popups=function(){shareEmail.current_button=null;$$(".sticky-popup").each(function(b){if(b.getStyle("display")==="block"){b.hide()}});if(typeof bf_rdio!="undefined"){bf_rdio.enable()}};this.set_quote_style=function(){$$(".buzz_superlist_item_quote").each(function(b){var c=new Element("span",{"class":"ie-quote-before"});var d=new Element("span",{"class":"ie-quote-after"});b.select("blockquote p")[0].insert({before:c});b.select("blockquote p")[(b.select("blockquote p").length-1)].insert(d);if(b.select("blockquote p").length>=2){b.addClassName("long-quote")}if(b.select("blockquote p").length<=1){b.addClassName("short-quote")}})};this.set_box_blur=function(c){var h=c.getOffsetParent(),g=h.select(".graphic_image_warning")[0],e=c.select("img.graphic_image")[0],k=h.select(".click_to_blur")[0],b=((Prototype.Browser.WebKit&&!isSafari5())||isIE8()||isIE9()),d=(Prototype.Browser.Gecko&&!isIE11()),j=isIE11(),f="";if(j){g.style.top=(e.getAttribute("height")/2*-1)+"px";e.remove();e=c.select("svg")[0];e.style.display=""}if(h.hasClassName("rubbable-container")){$s("#"+h.identify()+" .animatedgifs").addClassName("hidden")}if(BF_STATIC.bf_env=="dev"||BF_STATIC.bf_env=="live"){f=BF_STATIC.image_root+"/static/images/public/quickpost/blur.svg#blur30"}else{if(BF_STATIC.bf_env=="stage"){f="http://stage.buzzfeed.com/static/images/public/quickpost/blur.svg#blur30"}}if(b){e.addClassName("graphic_image")}else{if(d){e.setAttribute("style","filter:url("+f+");")}else{$s("#"+h.identify()+" .image_block").removeClassName("hidden")}}if(!isIE11()){e.addClassName("box_blur")}c.observe("click",function(){if(b){e.removeClassName("graphic_image")}else{if(d){e.setAttribute("style","")}else{if(j){$$("#"+e.id+" image")[0].style.filter=""}else{$s("#"+h.identify()+" .image_block").addClassName("hidden")}}}g.addClassName("hidden");k.removeClassName("hidden");if(h.hasClassName("rubbable-container")){var l=h.select("iframe");if(l.length){e.addClassName("hidden");l[0].removeClassName("hidden")}$s("#"+h.identify()+" .animatedgifs").removeClassName("hidden")}h.addClassName("no_blur")});k.observe("click",function(){if(b){e.addClassName("graphic_image")}else{if(d){e.setAttribute("style","filter:url("+f+");")}else{if(j){$$("#"+e.id+" image")[0].style.filter="url(#blur-effect-"+e.id.replace("svg-image-blur-","")+")"}else{h.select(".image_block")[0].removeClassName("hidden")}}}g.removeClassName("hidden");k.addClassName("hidden");if(h.hasClassName("rubbable-container")){var l=h.select("iframe");if(l.length){e.removeClassName("hidden");l[0].addClassName("hidden")}h.select(".animatedgifs")[0].addClassName("hidden")}h.removeClassName("no_blur")})};this.custom_badge_vote=function(b){if(b){b=b.toLowerCase();if(b=="kaching"){BFAudio.player("/sounds/kaching.mp3")}}};this._more_stuff_init=function(){if(document.location.href.match("/video/")){return}var c=$$(".Content")[0].getHeight()+200,b=$$(".Column2")[0].getHeight();if(c>=b&&$("lower-more-content")){bpage._more_stuff_request()}};this._more_stuff_request=function(){bpage.more_loaded=true;var c=$("lower-more-content"),f=c.getAttribute("rel:plugin_version"),b,e=new BF_Request(),d=parseInt((Math.random()*10)+1);if(!f){return}var g="";if(typeof BFW_Util=="object"&&(BFW_Util.getCookie("country")=="uk"||BFW_Util.getCookie("country")=="au")){g="/country:"+BFW_Util.getCookie("country")}b=BF_STATIC.web_root+"/plugin/infinitesidebar/v:"+f+g+"/p:"+d;if(BF_STATIC.bf_env=="dev"&&BF_STATIC.bf_test_mode==true){b=BF_STATIC.web_root+"/plugin/infinitesidebar/v:"+f+"/p:3"}e.request(b,{onSuccess:function(h){if(h.responseText){bpage.load_more_stuff(h.responseText)}},onFailure:function(h){console.error(h)}})};this.load_more_stuff=function(b){if($("lower-more-content")){$("lower-more-content").insert(b);$$("#lower-more-content .post img.thumb").each(function(d,c){d.src=d.getAttribute("rel:bf_image_src")})}};this.toggleBreakingSummary=function(d){var c=$("breaking_news_summary_content"),b=$("toggleBreakingSummary"),d=typeof d!="boolean"?(c.hasClassName("hidden")?true:false):d;if(c&&b){if(d){if(c.hasClassName("hidden")){c.removeClassName("hidden")}b.innerHTML="Hide summary"}else{if(!c.hasClassName("hidden")){c.addClassName("hidden")}b.innerHTML="Show summary";BF_Effect.ScrollIntoView(b,0)}}if(BF_STATIC.campaignid){$.jStorage.set(BF_STATIC.campaignid+"_summary",d)}};this.loadSummary=function(){if(BF_STATIC.campaignid){if($.jStorage.get(BF_STATIC.campaignid+"_summary")==false){bpage.toggleBreakingSummary(false)}}};this.hide_indepth_buzz=function(){var c=BF_STATIC&&BF_STATIC.campaignid?BF_STATIC.campaignid:null,b=universal_dom&&universal_dom._bucket&&universal_dom._bucket.indepth_buzz?universal_dom._bucket.indepth_buzz.elements:[];if(!c||!b.length){return}b.each(function(d){if(d.data&&d.data.indepth_buzz_id&&d.data.indepth_buzz_id==c){d.element.addClassName("hidden")}})};this.keycontrols=function(){var b=new BF_KeyControls();b.init();if(b){b.commands.push({name:"r",keys:[82],target:"social-actions",_track:"buzz"});b.commands.push({name:"c",keys:[67],target:"respond",_track:"buzz"});b.scroll={items:"ul#top-list li",_track:"buzz"};b.scroll={items:".buzz_superlist_item",_track:"buzz",reject_items:["buzz_superlist_item_text","buzz_superlist_item_link"]}}};this.dedupe_sidebar=function(){var g=new Array("promoted");var b=window.location.href.replace(/bf2\//,"");b=b.replace(/http:\/\/.*?\/.*?\/(.*)/,"$1");var f=new Array(/#.*/,/\/.*/,/\?.*/);for(var e=0;e<f.length;e++){if(b.match(f[e])){b=b.replace(f[e],"")}}for(var e=0;e<g.length;e++){var d=$(g[e]+"-"+b);if(d){d.hide();var c=$(g[e]+"-extra-hidden");if(c){c.show()}}}};this.load_hot_on_pinterest=function(){var b=$("hotOnPinterestWrap");widget_loaded=false;if(b&&("bf_pinterest_referer" in window)&&!isMSIE()){e()}function e(){var f=["diy","food"],g=(bf_pinterest_referer&&bf_pinterest_referer.COOKIE)?readCookie(bf_pinterest_referer.COOKIE):null;if((BF_STATIC.tt_page=="Buzz"&&BF_STATIC.vertical&&f.indexOf(BF_STATIC.vertical.toLowerCase())!="-1")||(document.referrer||"").match(/pinterest.com/)||(location.search||"").match(/\?referer=pinterest.com/)||(document.referrer||"").match(/blog.pinterest.com/)||(location.search||"").match(/\?referer=blog.pinterest.com/)||g){d();Event.observe(window,"scroll",function(){d()})}}function d(){if(!widget_loaded&&((b.viewportOffset().top+100)<document.viewport.getHeight())){widget_loaded=true;c();EventManager.fire("load_hot_on_pinterest")}}function c(){var g=BF_STATIC.vertical?BF_STATIC.vertical.toLowerCase():null,f=BF_STATIC.web_root+"/plugin/pinterestunit/v:1.2"+(g?"/vt:"+g:"")+"/p:1",h=new BF_Request();b.update('<div class="hot-on-pinterest-loader"></div>');h.request(f,{onSuccess:function(k){if(!k||!k.responseText){return}b.update(k.responseText);universal_dom.update(b);if(typeof(bf_prog_load)!="undefined"){var j=b.select("ul li img");if(j.length){j.each(function(l){if(l.readAttribute("rel:bf_image_src")){bf_prog_load.load_image(l,l.readAttribute("rel:bf_image_src"))}})}}},onFailure:function(j){console.error(j)}})}}};document.observe("dom:loaded",function(){if($("buzz_sub_buzz")&&($("buzz_sub_buzz").hasClassName("suplist_long")||$("buzz_sub_buzz").hasClassName("suplist_article"))){var b=new BF_InlineSharing();b.init();var c=new BF_ReadLater();c.init()}});$(document).observe("click",function(c){if(typeof(c.target)=="undefined"||!isHTMLElement(c.target)){return}var b=false,d=c.toElement?c.toElement:(c.relatedTarget||c.target),f=function(h){var k=$(h).getAttribute("rel:bf_bucket");var l=$(h).getAttribute("rel:bf_bucket_data");var g=$(h).hasClassName("sticky-popup");var e=(k&&k.match("sticky_popup_button")!==null);var j=(l&&l.match("email-share")!==null);return g||e||j};if(!d||f(d)){return}d.ancestors().each(function(e){if(!b){b=f(e)}});if(b){return}bpage.hide_all_popups()});$(document).observe("keyup",function(b){if(b.keyCode==Event.KEY_ESC){bpage.hide_all_popups()}});var bpage=new BF_bpage();BuzzLoader.register(bpage.init,5);BF_Queue=function(){var active_buzz;var active_promotion;var active_splash_page;var active_area_id;var active_area_name;var active_queue_id;var listObj={};this.draggableLists=["queue_list"];this.controller="/buzzfeed/queue";this.splash_controller="/buzzfeed/splash_queue";this.bigstory_controller="/buzzfeed/bigstory_queue";this.init=function(){queue.make_drag_lists(queue.draggableLists);if(queue.init_params()){queue.assign_handlers();queue.override_post_tools();queue.init_tabs();ukBackground()}};this.assign_handlers=function(){this.global_queue_handlers();this.splash_queue_handlers();universal_dom.assign_handler({bucket:"inline-edit",handler:queue.inline_edit,event:"click"});universal_dom.assign_handler({bucket:"update-queue-time",handler:queue.update_queue_time,event:"click"});universal_dom.assign_handler({bucket:"delete-from-queue",handler:queue.delete_from_queue,event:"click"});universal_dom.assign_handler({bucket:"delete-cancel",handler:queue.delete_cancel,event:"click"});universal_dom.assign_handler({bucket:"show-queue-types",handler:queue.show_queue_types,event:"click"});universal_dom.assign_handler({bucket:"tab",handler:queue.show_tab,event:"click"});$$(".schedule_form select").each(function(el){if(el.parentElement){var radioBtn=el.parentElement.select(".queue_for input")[0];el.on("change",function(){if(!radioBtn.checked){radioBtn.checked="checked"}})}})};this.splash_queue_handlers=function(){universal_dom.assign_handler({bucket:"delete-splash-from-queue",handler:queue.delete_splash_from_queue,event:"click"})};this.global_queue_handlers=function(){universal_dom.assign_handler({bucket:"confirm-delete",handler:queue.show_alert,event:"click"});universal_dom.assign_handler({bucket:"schedule-submit",handler:queue.schedule_submit,event:"click"});universal_dom.assign_handler({bucket:"schedule-cancel",handler:queue.schedule_cancel,event:"click"});universal_dom.assign_handler({bucket:"hide_alerts",handler:queue.hide_alerts,event:"click"})};this.init_params=function(){params=document.location.search.replace(/^\?/,"").toQueryParams();if(typeof params!="undefined"){if(params.tab){if(params.tab=="splash_queue"&&acl.user_can("homepage_edit")){queue.current_fieldset="splash_queue"}else{if(params.tab=="flow_suggestions"){queue.current_fieldset="flow_suggestions"}}}if(params.types){var queue_types=params.types.split("+");if(queue_types.length>0){var queue_type_form=$("queue_type_form").select("input");queue_type_form.each(function(el){$(el).checked=false;queue_types.each(function(tp){if(tp==$(el).name){$(el).checked=true}})})}}}return queue.show_queue_types()};this.show_queue_types=function(){var queueTypes=new Array();var queue_type_form=$("queue_type_form"),queue_type_form_inputs=queue_type_form?queue_type_form.select("input"):[];queue_type_form_inputs.each(function(el){if($(el).checked){queueTypes.push($(el).name)}});if(!queue_type_form_inputs.length){return false}queue.filter(queueTypes);return true};this.queue_types_string=function(){var types_string=new Array();if($("queue_type_form")){var queue_type_form=$("queue_type_form").select("input");queue_type_form.each(function(el){if($(el).checked){if(types_string==""){types_string=$(el).name}else{types_string+="+"+$(el).name}}});return types_string}else{return false}};this.override_post_tools=function(){bf_post_tools.load_flexpro=function(e){var buzz_info=e.target.getAttribute("rel:data").evalJSON();var owner=e.target.getAttribute("rel:owner");if(buzz_info.status=="draft"&&buzz_info.buzz_id){window.open("/buzzfeed/_draft/"+buzz_info.buzz_id)}else{if(buzz_info.uri&&owner){window.open(BF_STATIC.web_root+"/"+owner+"/"+buzz_info.uri,"_new")}else{alert("Invalid ID ("+buzz_info.buzz_id+")")}}};bf_post_tools.delete_quickpost=function(e,type){if(e.event){e=e.event}e.stop();var username=(new BF_User()).getUserInfo().username;var el=e.target;var owner=el.getAttribute("rel:owner");var buzz_data=el.getAttribute("rel:data");var buzz_data=eval("("+buzz_data+")");if(buzz_data.area_id){var args={area_id:buzz_data.area_id,buzz_id:buzz_data.buzz_id}}else{var args={buzz_id:buzz_data.buzz_id};if(typeof buzz_data.queue_id!=="undefined"){args.queue_id=buzz_data.queue_id}}queue.show_alert(args)}};this.make_drag_lists=function(lists){for(var i=0;i<lists.length;i++){var queueList="queueList"+i;var lastDragOrder="lastDragOrder"+i;listObj[lists[i]]={qlist:queueList,lastOrder:lastDragOrder};queue[queueList+i]=new Array();queue[lastDragOrder]=new Array()}};this.list_make_sortable=function(listName){if(!$(listName)){return false}queue.list_destroy_sortable(listName);if($$("#"+listName+" .queue_item:not(.hidden)").length>1){Sortable.create(listName,{only:"queue_item",scroll:window,onChange:function(e){queue.drag_change(listName)}});Draggables.addObserver({onStart:function(eventName,draggable,e){draggable.element.addClassName("dragging")},onEnd:function(eventName,draggable,e){draggable.element.removeClassName("dragging");queue.drag_end(listName)}});$(listName).addClassName("is_draggable")}};this.list_destroy_sortable=function(listName){if(!$(listName)){return false}$(listName).removeClassName("is_draggable");Sortable.destroy(listName)};this.drag_change=function(listName){var newDragOrder=queue.get_new_queue_order(listName);var lastDragOrder=queue.get_last_drag_order(listName);var myQueueList=queue.get_queue_list(listName);for(var i=0;i<newDragOrder.length;i++){if(newDragOrder[i]!=lastDragOrder[i]){var firstElement=$$("#"+newDragOrder[i]+" .queue_time .text")[0];var secondElement=$$("#"+myQueueList[i]+" .queue_time .text")[0];firstElement.innerHTML=secondElement.id}}queue.set_last_drag_order(listName,newDragOrder)};this.drag_end=function(listName){var newOrder=queue.get_new_queue_order(listName);var myQueueList=queue.get_queue_list(listName);var newTimesHash={};var usedTimesHash={};for(var i=0;i<newOrder.length;i++){var postId=JSON.parse($$("#"+newOrder[i])[0].getAttribute("rel:data")).queue_id;var newTime=JSON.parse($$("#"+myQueueList[i])[0].getAttribute("rel:data")).unix_time;var timeUpdated=false;var secondsTime=newTime;while(usedTimesHash[secondsTime]==1){secondsTime=parseInt(secondsTime)+1;timeUpdated=true}usedTimesHash[secondsTime]=1;if((newOrder[i]!=myQueueList[i])||timeUpdated){newTimesHash[postId]=secondsTime}}queue.set_queue_list(listName,newOrder);if(Object.keys(newTimesHash).length>0){queue.show_body_overlay();var controller=queue.get_controller(listName);var params={action:"update_times",new_times:JSON.stringify(newTimesHash)};try{var ajax=new BF_Request();ajax.request(controller,{method:"get",parameters:params,onSuccess:function(o){queue.reload_page()}})}catch(err){dumpError(err)}}};this.get_controller=function(listName){if(listName=="splash_queue_list"||listName=="bigstory_homepage_queue_list"){return queue.splash_controller}else{return queue.controller}};this.update_list_order=function(listName){var myQueueList=queue.get_new_queue_order(listName);queue.set_queue_list(listName,myQueueList);queue.set_last_drag_order(listName,myQueueList)};this.get_new_queue_order=function(listName){var newQueueList=new Array();$$("#"+listName+" .queue_item:not(.hidden)").each(function(el){newQueueList.push($(el).id)});return newQueueList};this.get_last_drag_order=function(listName){if(listObj[listName]){return queue[listObj[listName].lastOrder]}else{return 0}};this.set_last_drag_order=function(listName,newDragOrder){if(listObj[listName]){queue[listObj[listName].lastOrder]=newDragOrder}};this.get_queue_list=function(listName){if(listObj[listName]){return queue[listObj[listName].qlist]}else{return 0}};this.set_queue_list=function(listName,newQueueList){if(listObj[listName]){queue[listObj[listName].qlist]=newQueueList}};this.filter=function(queueTypes){universal_dom.get_bucket_elements("queue_item").each(function(el){el.addClassName("hidden")});universal_dom.get_bucket_elements("queue_item").each(function(el){queueTypes.each(function(qt){if(el.hasClassName(qt)){el.removeClassName("hidden")}})});for(var i=0;i<queue.draggableLists.length;i++){queue.update_list_order(queue.draggableLists[i])}};this.update_queue_time=function(args){if(args.buzz_id||args.buzz_promotion_id){var date_radio=$$(".schedule_form")[0].run_at_type[1];var post_id;var uList="";if(args.bigstory_homepage_suggestion&&args.bigstory_homepage_suggestion==1){if(args.buzz_promotion_id){post_id=args.buzz_promotion_id;uList="#bigstory_homepage_suggestions_list ";active_promotion=args.buzz_promotion_id}else{if(args.buzz_id){post_id=args.buzz_id;active_buzz=args.buzz_id}}$("current_status").innerHTML="";$$(".vertical_options")[0].hide();$$(".queue_alert_title")[0].innerHTML="Add To Big Story Queue";date_radio.show()}else{if(args.splash_page){post_id=args.buzz_promotion_id;uList="#splash_queue_list ";active_promotion=args.buzz_promotion_id;active_area_id=args.area_id;if(args.buzz_id){active_buzz=args.buzz_id}$("current_status").innerHTML="";$$(".vertical_options")[0].hide();if(queue.current_fieldset=="bigstory_homepage_queue"){$$(".queue_alert_title")[0].innerHTML="Edit Big Story Queue Status"}else{var title=(args.splash_page)?"Edit "+args.splash_page+" Splash Queue Status":"Edit Splash Queue Status";active_splash_page=(args.splash_page)?args.splash_page:"Frontpage";$$(".queue_alert_title")[0].innerHTML=title}date_radio.show()}else{if(args.buzz_id){post_id=args.buzz_id;active_buzz=args.buzz_id;active_area_id=args.area_id;if(args.vertical&&args.date){$("current_status").innerHTML="(Currently queued into the "+args.vertical+".)"}else{$("current_status").innerHTML="(Not Currently Queued)"}date_radio.checked=true;$$(".vertical_options")[0].show();var area_name=(args.area)?args.area:(args.vertical)?args.vertical:(args.vertical_name)?args.vertical_name:"Publish";active_area_name=area_name;var queue_name=(area_name=="Publish")?"Publish":(area_name.indexOf("Homepage")!=-1)?"Homepage":"Vertical";$$(".queue_alert_title")[0].innerHTML="Edit "+queue_name+" Queue Status";date_radio.show();if(queue.current_fieldset=="flow_suggestions"){$$(".queue_alert_title")[0].innerHTML="Move to Homepage Flow Queue"}}}}if(!args.date){var next=new Date();if(next.getMinutes()>=0&&next.getMinutes()<10){next.setMinutes(15)}else{if(next.getMinutes()>=10&&next.getMinutes()<25){next.setMinutes(30)}else{if(next.getMinutes()>=25&&next.getMinutes()<40){next.setMinutes(45)}else{if(next.getMinutes()>=40&&next.getMinutes()<55){next.setMinutes(60)}else{next.setMinutes(75)}}}}args.date=dateFormat(next,"yyyy-mm-dd HH:MM:ss")}if(args.date){var t=args.date.toString().split(/[- :]/);var datetime=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]);var month=datetime.getMonth()+1;var date=datetime.getFullYear()+"/"+month+"/"+datetime.getDate();var min=(datetime.getMinutes()<=9)?"0"+datetime.getMinutes():datetime.getMinutes();var hours=datetime.getHours();var time=hours+":"+min+":0";if(date&&time){for(var i=0;i<$$("#day")[0].options.length;i++){if($$("#day")[0].options[i].value==date){$$("#day")[0].selectedIndex=i}}for(var i=0;i<$$("#time")[0].options.length;i++){if($$("#time")[0].options[i].value==time){$$("#time")[0].selectedIndex=i}}$("pin_it").checked=(args.pin&&args.pin=="true")?true:false;$("add_to_homepage").checked=(args.hp&&args.hp=="true")?true:false}date_radio.checked=true}var dialog=$$(".update_queue_time")[0];var dialogWidth=dialog.getWidth();var dialogHeight=dialog.getWidth();var editBtn=$(args.target);var editBtnHeight=editBtn.getHeight();var editBtnLeft=Math.max(editBtn.offsetLeft,dialogWidth);var editBtnTop=editBtn.offsetTop;var post=$$(""+uList+"#post-"+post_id)[0];var postTop=(post)?post.offsetTop:0;var top=(postTop+editBtnTop+editBtnHeight+5);var left=(editBtnLeft-dialogWidth);var viewport=document.viewport.getDimensions();var scroll=document.viewport.getScrollOffsets();if(!post||top>800){top=(scroll.top+(viewport.height-dialogHeight))/2;left=scroll.left+(viewport.width-dialogWidth)/2}left=scroll.left+(viewport.width-dialogWidth)/2;if(typeof args.add_to_homepage!="undefined"&&args.add_to_homepage==1){$("add_to_homepage").checked=true}queue.show_body_overlay();dialog.show();dialog.setStyle({left:left+"px",top:top+"px"})}else{}};this.show_body_overlay=function(){var bodyHeight=document.body.getHeight();var bodyWidth=document.body.getWidth();if(!$("bodyOverlay")){var overlay=document.createElement("div");overlay.setAttribute("id","bodyOverlay");overlay.setStyle({width:bodyWidth+"px",height:bodyHeight+"px",zIndex:99});document.body.appendChild(overlay)}};this.hide_alerts=function(){if($("bodyOverlay")){document.body.removeChild($("bodyOverlay"))}$$(".update_queue_time")[0].hide();$$(".alert_box").each(function(el){el.hide()})};this.schedule_cancel=function(){if($("quickpost-queue")){$("quickpost-queue").checked=false}queue.hide_alerts()};this.schedule_submit=function(){var bad_date=false;var run_at_type=$$(".schedule_form")[0].run_at_type;var run_at=getCheckedValue(run_at_type);if(run_at=="date"){run_at=$$("#day")[0].options[$$("#day")[0].selectedIndex].value+" "+$$("#time")[0].options[$$("#time")[0].selectedIndex].value;var right_now=new Date();var selected_date=new Date(run_at);if(right_now>selected_date){$$(".bad_date")[0].show();bad_date=true}run_at=""+Math.round(selected_date.getTime()/1000)}else{if(run_at="next"){run_at=""+(Math.round(Date.now()/1000)+900)}}if(!bad_date){if(queue.current_fieldset=="splash_queue"){queue.schedule_splash(run_at)}else{if(queue.current_fieldset=="bigstory_homepage_queue"){queue.schedule_bigstory(run_at)}else{queue.schedule_flow(run_at)}}queue.hide_alerts()}};this.schedule_flow=function(run_at){var current_buzz=active_buzz;bf_post_tools.current_buzz=current_buzz;if($$("#post-"+active_buzz+" .ptool_spinner")[0]){$$("#post-"+active_buzz+" .ptool_spinner")[0].show()}else{if(superlist){superlist.toggle_disable_actions()}}queue.show_body_overlay();$$(".update_queue_time")[0].hide();var params={action:"schedule",buzz_id:current_buzz,area_id:active_area_id,page:active_area_name,run_at:run_at};try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"post",parameters:params,onSuccess:function(o){if(queue.current_fieldset!="flow_suggestions"){queue.reload_page()}else{var message="addedtoqueue";(typeof BF_STATIC!=="undefined"&&BF_STATIC.country!=="undefined"&&BF_STATIC.country=="uk")?queue.reload_page(message):queue.delete_from_flow_suggestions(message)}}})}catch(err){dumpError(err)}};this.schedule_splash=function(run_at){bf_post_tools.current_buzz=active_promotion;if($$("#splash_queue_list #post-"+active_buzz+" .ptool_spinner")[0]){$$("#splash_queue_list #post-"+active_buzz+" .ptool_spinner")[0].show()}queue.show_body_overlay();$$(".update_queue_time")[0].hide();var params={action:"schedule",buzz_id:active_buzz,area_id:active_area_id,run_at:run_at};params.splash_page=active_splash_page;try{var ajax=new BF_Request();ajax.request(queue.splash_controller,{method:"post",parameters:params,onSuccess:function(o){queue.reload_page()}})}catch(err){dumpError(err)}};this.schedule_bigstory=function(run_at){return;var params={action:"schedule",run_at:run_at};var controller=queue.bigstory_controller;if(queue.current_fieldset=="bigstory_homepage_suggestions"){bf_post_tools.current_buzz=active_buzz;if($$("#bigstory_homepage_suggestions_list #post-"+active_buzz+" .ptool_spinner")[0]){$$("#bigstory_homepage_suggestions_list #post-"+active_buzz+" .ptool_spinner")[0].show()}params.buzz_id=active_buzz}else{if(queue.current_fieldset=="bigstory_homepage_queue"){bf_post_tools.current_buzz=active_promotion;if($$("#bigstory_homepage_queue_list #post-"+active_promotion+" .ptool_spinner")[0]){$$("#bigstory_homepage_queue_list #post-"+active_promotion+" .ptool_spinner")[0].show()}params.promotion_id=active_promotion;controller=queue.splash_controller}}queue.show_body_overlay();$$(".update_queue_time")[0].hide();try{var ajax=new BF_Request();ajax.request(controller,{method:"post",parameters:params,onSuccess:function(o){queue.reload_page()}})}catch(err){dumpError(err)}};this.show_alert=function(args){if(args.buzz_id){var item;if(args.buzz_id){active_buzz=args.buzz_id;item=$$("#post-"+args.buzz_id)[0];active_area_id=args.area_id?args.area_id:0;active_queue_id=args.queue_id?args.queue_id:0}var itemTop=item.offsetTop;var dialog=$$(".alert_box")[0];var dialogWidth=dialog.getWidth();queue.show_body_overlay();dialog.show();dialog.setStyle({left:(dialogWidth)+"px",top:(itemTop)+"px"})}else{alert("Invalid ID ("+args.buzz_id+")")}};this.delete_cancel=function(){queue.hide_alerts()};this.delete_from_splash_queue=function(){queue.show_body_overlay();var params={action:"delete_from_queue",buzz_id:active_buzz,area_id:active_area_id,splash_page:active_splash_page};try{var ajax=new BF_Request();ajax.request(queue.splash_controller,{method:"get",parameters:params,onSuccess:function(o){queue.reload_page("splashdeleted")}})}catch(err){dumpError(err)}};this.delete_from_flow_queue=function(){$$("#post-"+active_buzz+" .ptool_spinner")[0].show();queue.show_body_overlay();var params={action:"delete_from_queue",buzz_id:active_buzz};if(typeof active_area_id!=="undefined"&&active_area_id!=0){params.area_id=active_area_id}else{if(typeof active_queue_id!=="undefined"&&active_queue_id!=0){params.queue_id=active_queue_id}}try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"get",parameters:params,onSuccess:function(o){queue.reload_page("deleted")}})}catch(err){dumpError(err)}};this.delete_from_flow_suggestions=function(message){var reload_message=message||"removedsuggestion";var email_editor=reload_message=="removedsuggestion"?1:0;var current_buzz=active_buzz;bf_post_tools.current_buzz=current_buzz;$$("#post-"+active_buzz+" .ptool_spinner")[0].show();queue.show_body_overlay();var params={action:"delete_flow_suggestion",buzz_id:current_buzz,email_editor:email_editor};try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"post",parameters:params,onSuccess:function(o){queue.reload_page(reload_message)}})}catch(err){dumpError(err)}};this.delete_from_bigstory_homepage_suggestions=function(){$$("#post-"+active_buzz+" .ptool_spinner")[0].show();queue.show_body_overlay();var params={action:"delete_bigstory_suggestion",buzz_id:active_buzz};try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"get",parameters:params,onSuccess:function(o){var post=$("post-"+active_buzz);if(post){post.parentNode.removeChild(post)}queue.hide_alerts()}})}catch(err){dumpError(err)}};this.delete_from_queue=function(args){if(queue.current_fieldset=="splash_queue"){$$("#splash_queue_list #post-"+active_buzz+" .ptool_spinner")[0].show();queue.delete_from_splash_queue()}else{if(queue.current_fieldset=="bigstory_homepage_queue"){$$("#bigstory_homepage_queue_list #post-"+active_promotion+" .ptool_spinner")[0].show();queue.delete_from_splash_queue()}else{if(queue.current_fieldset=="flow_suggestions"){queue.delete_from_flow_suggestions("removedsuggestion")}else{if(queue.current_fieldset=="bigstory_homepage_suggestions"){queue.delete_from_bigstory_homepage_suggestions()}else{queue.delete_from_flow_queue()}}}}};this.publish_to_hp=function(args){if(args.buzz_id){$$("#post-"+args.buzz_id+" .ptool_spinner")[0].show();queue.show_body_overlay();var params={action:"publish_to_hp",buzz_id:args.buzz_id,country:BF_STATIC.country};if(queue.current_fieldset=="flow_suggestions"){params.is_suggestion=1}try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"get",parameters:params,onSuccess:function(o){queue.reload_page("published")}})}catch(err){dumpError(err)}}else{alert("Invalid ID ("+args.buzz_id+")")}};this.reload_page=function(success_message){var params_array=new Array();var pathname=window.location.pathname;if(typeof BF_STATIC!=="undefined"&&BF_STATIC.country!=="undefined"&&BF_STATIC.country!="us"){params_array.push("country="+BF_STATIC.country)}if(queue.queue_types_string()){params_array.push("types="+queue.queue_types_string())}if(!(typeof success_message==="undefined")&&success_message.length>0){params_array.push("message="+success_message)}if(queue.current_fieldset=="flow_suggestions"||queue.current_fieldset=="bigstory_homepage_queue"||queue.current_fieldset=="splash_queue"){params_array.push("tab="+queue.current_fieldset)}if(params_array.length>0){if(pathname.indexOf("?")){pathname=pathname.substring(0,pathname.indexOf("?"))}pathname+="?"+params_array.join("&");var curr=queue.current_fieldset;BF_Request.location({location:pathname});queue.current_fieldset=curr}else{window.setTimeout(function(){var curr=queue.current_fieldset;BF_Request.location({reload_track:true});queue.current_fieldset=curr},200)}};this.init_tabs=function(){if(typeof queue.current_fieldset=="undefined"){queue.current_fieldset=(window.history.state&&window.history.state.tab)?window.history.state.tab:"flow_queue"}queue.show_tab({id:queue.current_fieldset})};this.show_tab=function(obj){$$("#queue-data>li").each(function(el){el.addClassName("hidden");if($(el.id+"_tab")){$(el.id+"_tab").removeClassName("active_tab")}});if($(obj.id)&&$(obj.id+"_tab")){$(obj.id).removeClassName("hidden");$(obj.id+"_tab").addClassName("active_tab");queue.current_fieldset=obj.id;if(!(window.history.state&&window.history.state.tab==obj.id)){history.pushState({tab:obj.id},"","")}}}.bind(this)};function getCheckedValue(c){if(!c){return""}var d=c.length;if(d==undefined){if(c.checked){return c.value}else{return""}}for(var b=0;b<d;b++){if(c[b].checked){return c[b].value}}return""}window.onload=function(){for(var b=0;b<queue.draggableLists.length;b++){queue.list_make_sortable(""+queue.draggableLists[b])}};window.onpopstate=function(b){if(b.state&&b.state.tab){queue.show_tab({id:b.state.tab})}};var queue=new BF_Queue();var bf_post_tools=new BF_Post_Tools();BuzzLoader.register(function(){queue.init()},2);var Rerankable=function(){var b=this;var c=false;this.username="";this.templates={share_modal:'<div class="rerank_modal rerank_share_modal modal hidden">					<a href="javascript:;" class="bf_dom fa fa-times close_btn" rel:bf_bucket="re_rank_modal_close"></a>					<div class="title">						Thanks, <span class="wrap_text_hidden">#{name}!</span><br/>Now Share Your Post!					</div>					<div class="help_txt">						<a href="#{url}">#{url}</a>					</div>					<div class="share_buttons"></div>					<div class="bottom">						<a href="javascript:;" class="bf_dom close_link" rel:bf_bucket="re_rank_modal_close">Close</a>					</div>				</div>',confirm_modal:'<div class="rerank_modal rerank_confirm_modal modal hidden">					<a href="javascript:;" class="bf_dom fa fa-times close_btn" rel:bf_bucket="re_rank_modal_close"></a>					<div class="title">						OMG!<br />Want to abandon your re-ranking?					</div>					<div class="help_txt">						Your changes won\'t be saved					</div>					<a class="bf_dom btn rerank_btn rerank_btn_big rerank_btn_grey" rel:bf_bucket="re_rankable_mode_close">Yep, I Quit</a>					<div class="add_help_text">						<a href="javascript:;" class="bf_dom" rel:bf_bucket="re_rank_modal_close">No wait! I want to keep working &rarr;</a>					</div>				</div>',error_modal:'<div class="rerank_modal rerank_error_modal modal hidden">					<a href="javascript:;" class="bf_dom fa fa-times close_btn" rel:bf_bucket="re_rank_modal_close"></a>					<div class="title">ERROR</div>					<div class="help_txt">#{error}.</div>				</div>',text_subbuzz:'<div class="subbuzz bf_dom subbuzz_text" id="element_#{id}" data-id="#{id}" rel:bf_bucket_data="{\'drag_element-md\':{}}">						<h2>							<span class="ie8_rank_numb">#{number}</span>							<input type="text" class="bf_dom rank_numb" value="#{number}" rel:bf_bucket_data="{\'re_rank_number\':{}, \'re_rank_number_blur\':{}, re_rank_number_focus: {}, re_rank_number_keypress: {}}"/> #{title}						</h2> <p>#{text}</p>						<div class="arrows">							<a href="javascript:;" class="fa fa-arrow-up up bf_dom" rel:bf_bucket="re_rank_up"></a>							<a href="javascript:;" class="fa fa-arrow-down down bf_dom" rel:bf_bucket="re_rank_down"></a>						</div>					</div>',image_subbuzz:'<div class="subbuzz bf_dom subbuzz_image" id="element_#{id}" data-id="#{id}" rel:bf_bucket_data="{\'drag_element-md\':{}}">						<h2>							<span class="ie8_rank_numb">#{number}</span>							<input type="text" class="bf_dom rank_numb" value="#{number}" rel:bf_bucket_data="{\'re_rank_number\':{}, \'re_rank_number_blur\':{}, re_rank_number_focus: {}, re_rank_number_keypress: {}}"/> #{title}						</h2> <p><img src="#{image}"/> #{text}</p>\n						<div class="arrows">							<a href="javascript:;" class=" fa fa-arrow-up up bf_dom" rel:bf_bucket="re_rank_up"></a>							<a href="javascript:;" class="fa fa-arrow-down down bf_dom" rel:bf_bucket="re_rank_down"></a>						</div>					</div>',video_subbuzz:'<div class="subbuzz bf_dom subbuzz_video" id="element_#{id}" data-id="#{id}" rel:bf_bucket_data="{\'drag_element-md\':{}}">						<h2>							<span class="ie8_rank_numb">#{number}</span>							<input type="text" class="bf_dom rank_numb" value="#{number}" rel:bf_bucket_data="{\'re_rank_number\':{}, \'re_rank_number_blur\':{}, re_rank_number_focus: {}, re_rank_number_keypress: {}}"/> #{title}						</h2> <p><img src="#{video}"/> #{text}</p>\n						<div class="arrows">							<a href="javascript:;" class=" fa fa-arrow-up up bf_dom" rel:bf_bucket="re_rank_up"></a>							<a href="javascript:;" class="fa fa-arrow-down down bf_dom" rel:bf_bucket="re_rank_down"></a>						</div>					</div>'};this.text=function(d){if(!d){return""}var e=typeof(d.innerText)=="undefined"?"textContent":"innerText";return d[e]};this.init=function(){var d=this;this.defaultRerankData={tooltips:{top:false,number:false,number_enter:false},sharedUrl:""};if(!$.jStorage.get("rerank_data")){this.setRerankData(this.defaultRerankData)}this.container=$$(".rerankable_container")[0];this.list=this.container.select("#reranked_list")[0];this.data=this.container.readAttribute("rel:data")?JSON.parse(this.container.readAttribute("rel:data")):{};this.isContinue=true;this.$cta=$$(".rerank_cta")[0];this.render();if(!this.isContinue){return false}this.startNum=this.list.select(".subbuzz h2 input")[0].getValue();this.ctaTop=this.$cta.cumulativeOffset().top;this.initHandlers();this.initDragDrop();this.reorder();this.showShare();this.spinner=new bf_spinner();this.startPostOrderItems=[];this.startRerankOrderPos=[];this.fillObjOrder();this.startItemNumber=0;Element.observe(window,"resize",function(){d.placeTooltips();d.showTooltips();d.setCtaLeft()})};this.setCtaLeft=function(){var d=(b.ctaTop<document.viewport.getScrollOffsets().top)?b.getCtaLeft():0;b.$cta.setStyle({left:d+"px"})};this.getCtaLeft=function(){var d=$("buzz_header");return d.cumulativeOffset().left+(d.getWidth()-this.$cta.getWidth())+3};this.fillObjOrder=function(){var d="";startRerankItemsOrder={};$$("#buzz_sub_buzz .buzz_superlist_item").each(function(e,f){d=($(e).id).split("_")[2];b.startPostOrderItems.push(d);b.list.select(".subbuzz").each(function(g,h){if(d==$(g).readAttribute("data-id")){b.startRerankOrderPos.push(f)}})})};this.getOrder=function(){var d={};finishRerankOrderItems=[];this.list.select(".subbuzz").each(function(h,j){var g=$(h).readAttribute("data-id");if(!g){return}d[b.startRerankOrderPos[j]]=g});var e=b.startPostOrderItems.length;for(var f=0;f<e;f++){if(b.startRerankOrderPos.indexOf(f)!=-1){finishRerankOrderItems.push(d[f])}else{finishRerankOrderItems.push(b.startPostOrderItems[f])}}return finishRerankOrderItems};this.setRerankData=function(f){var d=false,e=this.getRerankData();if(typeof f!=="undefined"&&f){if(typeof f.tooltips!=="undefined"){e.tooltips=f.tooltips;d=true}if(typeof f.sharedUrl!=="undefined"){e.sharedUrl=f.sharedUrl;d=true}}if(d){$.jStorage.set("rerank_data",e)}},this.getRerankData=function(){var d=this.defaultRerankData,e=$.jStorage.get("rerank_data");if(e&&typeof e.tooltips!=="undefined"){d.tooltips=e.tooltips}if(e&&typeof e.sharedUrl!=="undefined"){d.sharedUrl=e.sharedUrl}return JSON.parse(JSON.stringify(d))},this.setTooltipsShown=function(e){var d=this.getRerankData();d.tooltips[e]=true;if(!this.getTooltipsShown(e)){this.setRerankData(d)}},this.getTooltipsShown=function(e){var d=this.getRerankData();return d.tooltips[e]},this.setSharedUrl=function(e){var d=this.getRerankData();d.sharedUrl=e;this.setRerankData(d)},this.getSharedUrl=function(){var d=this.getRerankData();return d.sharedUrl},this.initDragDrop=function(){Sortable.create("reranked_list",{tag:"div",onChange:this.reorder.bind(this),starteffect:this.onDragStart.bind(this),endeffect:this.onDragEnd.bind(this),scroll:window})};this.initHandlers=function(){universal_dom.assign_handler({bucket:"re_rank",event:"click",handler:this.onRerankClick.bind(this)});universal_dom.assign_handler({bucket:"re_rank_up",event:"click",handler:this.onUp.bind(this)});universal_dom.assign_handler({bucket:"re_rank_down",event:"click",handler:this.onDown.bind(this)});universal_dom.assign_handler({bucket:"re_rank_submit",event:"click",handler:this.onSubmit.bind(this)});universal_dom.assign_handler({bucket:"re_rank_modal_close",event:"click",handler:this.closeLoginModal.bind(this)});universal_dom.assign_handler({bucket:"re_rankable_mode_close",event:"click",handler:this.closeRerankableMode.bind(this)});universal_dom.assign_handler({bucket:"rerank_sign_in",event:"click",handler:this.signin.bind(this)});universal_dom.assign_handler({bucket:"rerank_submit_name",event:"click",handler:this.submitName.bind(this)});universal_dom.assign_handler({bucket:"re_rank_number_blur",event:"blur",handler:this.onNumberBlur.bind(this)});universal_dom.assign_handler({bucket:"re_rank_number_focus",event:"focus",handler:this.onNumberFocus.bind(this)});universal_dom.assign_handler({bucket:"re_rank_number",event:"change",handler:function(d){rerankable.onNumberChangeDebounced(d)}});universal_dom.assign_handler({bucket:"re_rank_number_keypress",event:"keypress",handler:function(d){rerankable.onNumberKeyPressDebounced(d)}});universal_dom.assign_handler({bucket:"drag_element-md",event:"mousedown",handler:this.onDragElMouseDown.bind(this)});Event.observe(document,"mouseup",this.onDragElMouseUp.bind(this));Event.observe(window,"scroll",this.onScroll.bind(this))};this.render=function(){this.build();var d=this.list.select(".subbuzz");if(d.length<2){this.isContinue=false;return}this.$cta.removeClassName("hidden");trackPixel(" http://ad.doubleclick.net/ddm/trackimp/N8340.244372.BUZZFEED.COM/B7982353.107573884;dc_trk_aid=280741850;dc_trk_cid=57744090;ord=[timestamp]?");universal_dom.update(this.container)};this.build=function(){this.list.update("");$$(".buzz_superlist_item").each(function(d){if(d.select('[class^="buzz_superlist_number"]').length==0){return}if(d.hasClassName("buzz_superlist_item_text")){b.parseText(d)}else{if(d.hasClassName("buzz_superlist_item_image")){b.parseImage(d)}else{if(d.hasClassName("buzz_superlist_item_video")){b.parseVideo(d)}}}})};this.parseText=function(e){var f={};f.id=e.id.replace("superlist_"+BF_STATIC.campaignid+"_","");var g=this.text(e.select("h2")[0]);var d=this.text(e.select("h2 .buzz_superlist_number_inline")[0]);f.title=g.replace(d+" ","");f.text=this.text(e.select(".sub_buzz_desc")[0]);f.text=f.text.length>250?f.text.substr(0,147)+"...":f.text;f.number=e.readAttribute("rel:buzz_num");this.append(f,"text")};this.parseImage=function(e){var f={};f.id=e.id.replace("superlist_"+BF_STATIC.campaignid+"_","");var g=this.text(e.select("h2")[0]);var d=this.text(e.select("h2 .buzz_superlist_number_inline")[0]);f.title=g.replace(d+" ","");f.image=e.select(".sub_buzz_content img")[0].readAttribute("rel:bf_image_src");f.text=this.text(e.select(".sub_buzz_desc")[0]);f.text=f.text.length>250?f.text.substr(0,147)+"...":f.text;f.number=e.readAttribute("rel:buzz_num");this.append(f,"image")};this.parseVideo=function(e){var f={};f.id=e.id.replace("superlist_"+BF_STATIC.campaignid+"_","");var g=this.text(e.select("h2")[0]);var d=this.text(e.select("h2 .buzz_superlist_number_inline")[0]);f.title=g.replace(d+" ","");if(e.hasClassName("video_instagram")){f.video=e.select(".sub_buzz_content img")[0].src}else{f.video=e.select(".sub_buzz_content .video-embed-big")[0].readAttribute("rel:thumb")}f.text=this.text(e.select(".sub_buzz_desc")[0]);f.text=f.text.length>250?f.text.substr(0,147)+"...":f.text;f.number=e.readAttribute("rel:buzz_num");this.append(f,"video")};this.append=function(g,f){if(typeof(this.templates[f+"_subbuzz"])==undefined){console.error("Incorrect template type: "+f);return}var e=new Template(this.templates[f+"_subbuzz"]);var d=e.evaluate(g);this.list.insert(d)};this.onRerankClick=function(){this.toggle();trackPixel("http://ad.doubleclick.net/ddm/trackclk/N8340.244372.BUZZFEED.COM/B7982353.107573884;dc_trk_aid=280741850;dc_trk_cid=57744090")};this.onNumberFocus=function(g){var j=$(g.target),h=this.container.select(".tooltip_number_enter")[0];this.startItemNumber=j.getValue();h.removeClassName("hidden");var f=j.cumulativeOffset().left+j.getWidth()/2-h.getWidth()/2,d=j.cumulativeOffset().top-h.getHeight()-10;h.setStyle({left:0,top:0});h.setStyle({left:f+"px",top:d+"px"});this.showTooltip(h)};this.onNumberBlur=function(d){if(isNaN(parseInt($(d.target).getValue(),10))){$(d.target).setValue(this.startItemNumber)}var f=this.container.select(".tooltip_number_enter")[0];this.hideTooltip(f)};this.onNumberChange=function(l){var m,f,g,d,j=this.list.select(".subbuzz"),k=parseInt($(l.target).getValue(),10),n=j.length,h=$(l.target).up(".subbuzz");if(isNaN(k)){$(l.target).setValue(this.startItemNumber);return}k=(k==0)?1:k;this.hideTooltips();if((k>=n)){if(this.startNum!=1){j[0].insert({before:h})}else{j[n-1].insert({after:h})}}else{f=j.indexOf(h)+1;d=(this.startNum!=1)?n-k:k-1;m=parseInt(j[d].select(".rank_numb").first().getValue(),10);if(this.startNum!=1){m=n-m}g=(f>m)?{before:h}:{after:h};j[d].insert(g)}this.animateRankedItem(h);this.reorder();this.setTooltipsShown("number_enter")};this.onNumberKeyPress=function(f){var d=f.which||f.keyCode;if(d==Event.KEY_RETURN){this.onNumberChange(f)}};this.onNumberChangeDebounced=BF_UTIL.debounce(this.onNumberChange,300);this.onNumberKeyPressDebounced=BF_UTIL.debounce(this.onNumberKeyPress.bindAsEventListener(this),300);this.onDragElMouseUp=function(){$("reranked_list").select("div.dragging").each(function(d){d.removeClassName("dragging")})};this.onDragElMouseDown=function(f){var d=f.target;if(d.hasClassName("rank_numb")||d.hasClassName("fa-arrow-up")||d.hasClassName("fa-arrow-down")){return}if($$("input.rank_numb:focus").length!=0){$$("input.rank_numb:focus")[0].blur();return}if(!d.hasClassName("subbuzz")){d=d.up(".subbuzz")}d.addClassName("dragging")};this.onDragStart=function(){this.hideTooltips();this.setTooltipsShown("top");this.setTooltipsShown("number")};this.onDragEnd=function(d){this.animateRankedItem(d)};this.animateRankedItem=function(d){new Effect.Highlight(d,{startcolor:"#fff88f",endcolor:"#ffffff",restorecolor:"#ffffff"})};this.showTooltips=function(){var d=this;this.container.select(".tooltip").each(function(e){if(e.hasClassName("tooltip_number_enter")){return}d.showTooltip(e)})};this.hideTooltips=function(){var d=this;this.container.select(".tooltip").each(function(e){d.hideTooltip(e)})};this.hideTooltip=function(d){d.addClassName("fadeout");setTimeout(function(){if(!d.hasClassName("fadeout")){return}d.addClassName("hidden")},500)};this.showTooltip=function(e){var d=e.getAttribute("rel:data");if(this.getTooltipsShown(d)){return}if(e.hasClassName("fadeout")&&!e.hasClassName("hidden")){e.removeClassName("fadeout")}e.removeClassName("hidden");setTimeout(function(){e.removeClassName("fadeout")},1)};this.onSubmit=function(d){if(!(new BF_User).isLoggedIn()){this.showLoginModal()}else{this.submit()}};this.submitName=function(d){this.username=this.container.select(".rerank_username")[0].getValue();this.container.select(".login_modal .close_btn")[0].simulate("click");this.submit()};this.showLoginModal=function(){this.container.select(".login_modal")[0].removeClassName("hidden");this.toggleOverlay();gtrack.track_events("Re-rank:content","[nc]impression:rogaine-enter-name-modal")};this.closeLoginModal=function(f){var d=$(f.target).up(".modal");d.addClassName("hidden");$("rerank_modal_overlay").addClassName("hidden")};this.closeRerankableMode=function(){this.toggleOverlay();$$(".rerank_confirm_modal")[0].addClassName("hidden");this.hide()};this.toggleOverlay=function(){var d=$("rerank_modal_overlay");if(d.hasClassName("hidden")){d.removeClassName("hidden")}else{d.addClassName("hidden")}};this.submit=function(){var d=this;var e={action:"rank",buzz_id:BF_STATIC.campaignid,ranking:this.getOrder().join(","),display_name:this.getUserName()};this.spinner.start();this.toggleOverlay();new Ajax.Request("/buzzfeed/rerank_subbuzz",{method:"get",parameters:e,onSuccess:d.onSuccess.bind(d),onFailure:d.onFailure.bind(d)})};this.onSuccess=function(d){this.spinner.stop();var g=JSON.parse(d.responseText),f="Something went wrong, sorry";if(!g||g.success==0){if(g.error=="Missing display_name"){f="Please, enter name before submitting"}this.toggleOverlay();this.showModal(this.templates.error_modal,"rerank_error_modal",{error:f});return false}var e=this.getUrl(g.id);this.setSharedUrl(e);gtrack.track_events("Re-rank:content","rogaine-publish",this.getQueryString(e));trackPixel("http://ad.doubleclick.net/ddm/trackclk/N8340.244372.BUZZFEED.COM/B7982353.107573884;dc_trk_aid=280741850;dc_trk_cid=57744251");document.location.href=e};this.showModal=function(d,e,f){if(!$$("."+e).length){templ=new Template(d);html=templ.evaluate((f)?f:{});$(document.body).insert(html);universal_dom.update($$("."+e)[0])}this.toggleOverlay();$$("."+e)[0].removeClassName("hidden")};this.showShare=function(){var d=document.location.href;if(this.getSharedUrl()!=d){return}this.setSharedUrl("");if($$(".rerank_share_modal").length){this.container.select(".rerank_share_modal")[0].remove()}this.showModal(this.templates.share_modal,"rerank_share_modal",{name:this.data.display_name,url:d});this.insertShareButtons(d);universal_dom.update($$(".rerank_share_modal")[0])};this.onScroll=function(){if(c&&(document.viewport.getScrollOffsets().top>0)){this.hideTooltips();this.setTooltipsShown("top");this.setTooltipsShown("number")}if(!this.$cta||c){return}this.setCtaLeft();if(this.ctaTop<document.viewport.getScrollOffsets().top){this.$cta.addClassName("fixed")}else{this.$cta.removeClassName("fixed")}};this.insertShareButtons=function(e){var f=$$(".rerank_share_modal .share_buttons")[0];if(!f){return}var g=this.getQueryString(e);var d={wrapper:true,el:f,uri:e,color:"square",title:"My very own take on "+BF_STATIC.buzz_name+"!",description:"I just re-ranked this BuzzFeed post. Did I nail it?",tracking_label:g};bf_shares.fb_share(Object.extend(Object.clone(d),{tracking_action:"share-rogaine-rank-facebook"}));bf_shares.tw_tweet(Object.extend(Object.clone(d),{description:"Step aside BuzzFeed, I'll rank this one! ",tracking_action:"share-rogaine-rank-twitter",via:this.container.getAttribute("rel:twitter-via")||"buzzfeed"}));f.insert('<div class="pinterest_share" style="">		<a rel:gt_act="share-rogaine-rank-pinterest" rel:gt_label="'+g+'" rel:bf_bucket="pinterest" href="javascript:;" class="bf_dom shareBtn big square">			<div class="pi_icon"></div>			<div class="label">Pin it</div>		</a>	</div>');f.insert('<div class="link_share" style="">		<a rel:gt_act="share-rogaine-rank-copy-link" rel:gt_label="'+g+'" class="shareBtn bf_dom big square" href="javascript:;" rel:bf_bucket="share_link sticky_popup_button" rel:link="'+e+'">			<div class="copy_icon">&nbsp;</div>			<div class="label">Link</div>			</a>		</div>')};this.signin=function(){var d=this;bf_login.loggedInCallbacks.push(function(){d.container.select(".login_modal .close_btn")[0].simulate("click");d.submit()});var e=this.container.select(".rerank_panel .submit")[0].fire("click");e.signin_type="initial";e.mode="badges";e.location="rerank";e.reg_params="";signin.open(e)};this.getUserName=function(){var d=new BF_User;var e=(this.username)?this.username:"";return d.isLoggedIn()?d.getUserInfo().display_name:e};this.getUrl=function(e){var d=sub_links.get_url();var g=d.split("/");var f=g.indexOf(BF_STATIC.username)+2;g.splice(f,g.length-f);return g.join("/")+"/"+e+document.location.search};this.getQueryString=function(d){var e=d.split("/");e.splice(0,e.indexOf(BF_STATIC.username)+2);return"/"+e};this.onFailure=function(d){this.spinner.stop();alert("error");console.debug("fail",d)};this.reorder=function(){var f=this.list.select(".subbuzz");var d=this.list.select(".subbuzz").length;var e,g;f.each(function(h,j){e=j+1;g=d--;if(!isIE8()){if(b.startNum!=1){$(h).select("h2 input")[0].setValue(g)}else{$(h).select("h2 input")[0].setValue(e)}}else{if(b.startNum!=1){$(h).select("h2 span")[0].update(g)}else{$(h).select("h2 span")[0].update(e)}}h.removeClassName("first").removeClassName("last")});f[0].addClassName("first");f[f.length-1].addClassName("last")};this.onUp=function(f){var e=$(f.target).up(".subbuzz"),d=e.previous();if(!d){return}this.insertBefore(d,e);this.animateRankedItem(e)};this.onDown=function(f){var e=$(f.target).up(".subbuzz"),d=e.next();if(!d){return}this.insertBefore(e,d);this.animateRankedItem(e)};this.insertBefore=function(e,d){this.hideTooltips();e.insert({before:d});this.reorder()};this.toggle=function(){var e,d;if(c){this.showModal(this.templates.confirm_modal,"rerank_confirm_modal")}else{this.show()}};this.placeTooltips=function(){var e=this.list.select(".subbuzz")[1];if(!isIE8()){var h=e.select("h2 input")[0],d=this.container.select(".tooltip_number")[0];d.setStyle({visibility:"hidden"}).removeClassName("hidden");var f=h.cumulativeOffset().left-18,g=h.cumulativeOffset().top+h.getHeight()+5;d.setStyle({left:f+"px",top:g+"px"});d.addClassName("hidden").setStyle({visibility:"visible"})}};this.show=function(){this.render();this.initDragDrop();this.reorder();var d=["pin_bd","pin_bg","shares-copy-link"];$$("body>div").each(function(e){if(e.hasClassName("rerankable_container")||e.hasClassName("rerank_confirm_modal")||e.hasClassName("rerank_error_modal")||e.hasClassName("spinner_container")){return}if(e.id&&d.indexOf(e.id)!=-1){return}e.addClassName("hidden_by_rerank")});this.container.removeClassName("hidden");window.scrollTo(0,0);this.placeTooltips();c=true;this.showTooltips()};this.hide=function(){$$(".hidden_by_rerank").each(function(d){d.removeClassName("hidden_by_rerank")});this.container.addClassName("hidden");c=false;this.onScroll()};this.getDocHeight=function(){var d=document;return Math.max(d.body.scrollHeight,d.documentElement.scrollHeight,d.body.offsetHeight,d.documentElement.offsetHeight,d.body.clientHeight,d.documentElement.clientHeight)}};if(!rerankable!="1"){var rerankable=new Rerankable;BuzzLoader.register(rerankable.init.bind(rerankable),1)}var BF_DFA=function(){this.custom_vars={"click:react/":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=react674;ord=[timestamp]?","click:share/pinterest":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share783;ord=[timestamp]?","click:share/email":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share080;ord=[timestamp]?","click:share/twitter/tweet":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share802;ord=[timestamp]?","click:share/facebook/like":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share810;ord=[timestamp]?","click:share/facebook/share":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share814;ord=[timestamp]?","video:end":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video469;ord=[timestamp]?","video:reached:25%":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video827;ord=[timestamp]?","video:reached:50%":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video064;ord=[timestamp]?","video:reached:75%":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video878;ord=[timestamp]?","click:video-play":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video618;ord=[timestamp]?"};this.fire_event=function(b){if(!dfa.status()){return false}var c=dfa.fetch_uri(b);if(typeof c=="undefined"){return false}if(BF_STATIC.bf_env!="live"){console.log("DFA: "+c)}else{trackPixel(c)}};this.status=function(){var b=objExists(BF_STATIC.f_ad)?BF_STATIC.f_ad=="1"?true:false:false;return b};this.fetch_uri=function(b){var c;for(v in dfa.custom_vars){if(b.match(v)){c=dfa.custom_vars[v]}}return c}};var dfa=new BF_DFA();BF_comment_links=function(){this.box_id;this.init=function(){universal_dom.assign_handler({bucket:"share-social",handler:comment_links.show_share_box,event:"click"});universal_dom.assign_handler({bucket:"share-comment",handler:comment_links.show_share_box,event:"click"});universal_dom.assign_handler({bucket:"fb-share-comment",handler:comment_links.comment_share,event:"click"});universal_dom.assign_handler({bucket:"tw-share-comment",handler:comment_links.comment_share,event:"click"});universal_dom.assign_handler({bucket:"link-share-comment",handler:comment_links.comment_share,event:"click"});universal_dom.assign_handler({bucket:"em-share-comment",handler:comment_links.comment_share,event:"click"});universal_dom.assign_handler({bucket:"pin-share-comment",handler:comment_links.comment_share,event:"click"});comment_links.fix_box_height();if(document.URL.include("?comment")){var url=document.URL.toQueryParams();comment_links.highlite(url.comment)}if(document.URL.include("?commentid")){var url=document.URL.toQueryParams();comment_links.highlite(url.commentid)}document.observe("scroll",comment_links.hide_share_box);document.observe("click",comment_links.click_hide_share_box);$$(".comment-share .share-icon").each(function(share_el){share_el.observe("click",comment_links.comment_share)})};this.fix_box_height=function(){$$(".comment-share").each(function(el){if(el.select(".share-icon#pinterest").length==0){$(el).setStyle({height:"120px"})}})};this.click_hide_share_box=function(e){try{if(typeof(e.target)=="undefined"||!isHTMLElement(e.target)){console.log("Not html element. SVG fix.");return}if(!$(e.target).up(".share")&&!$(e.target).hasClassName("share")&&!$(e.target).up(".comment-share")&&!$(e.target).hasClassName("comment-share")){comment_links.hide_share_box()}}catch(e){console.error(e)}};this.hide_share_box=function(){if(comment_links.box_id){var share=$(comment_links.box_id).select(".comment-share").first(),social=$(comment_links.box_id).select(".comment-social").first(),lovehate_buttons=$(comment_links.box_id).select(".comment-lovehate-buttons").first(),copy_link=$(comment_links.box_id).select(".copy-link").first();if(share){share.addClassName("hidden")}if(social){social.addClassName("hidden")}if(lovehate_buttons){lovehate_buttons.addClassName("hidden")}if(copy_link){copy_link.remove()}comment_links.box_id=null}};this.show_share_box=function(e){var main_element=e.target.up("a");if(main_element&&typeof main_element!=undefined){var data=eval("("+main_element.getAttribute("rel:bf_bucket_data")+")")}var comment_id=data["share-comment"].id;if(!($(e.target).up("#link")||$(e.target).up(".copy-link"))){comment_links.hide_share_box()}var container=$(main_element).up("li");if(typeof container=="undefined"||!("className" in container)){return false}className=container.className;className.split(" ").each(function(item){var box=$(comment_id).select(".comment-"+item).first();if(typeof box!=="undefined"){if(!comment_links.box_id){comment_links.box_id=comment_id;box.removeClassName("hidden");if(item==="share"||item==="social"){var btn={left:Number(container.positionedOffset()[0]),top:Number(container.positionedOffset()[1]),height:Number(container.getHeight()),width:Number(container.getWidth())};box.setStyle({left:(btn.left-4)+"px",top:(btn.top+btn.height)+"px",height:"auto"})}}}})};this.highlite=function(id){var comment=$(id);if(comment){if(comment.nodeName=="DIV"){comment=comment.parentNode}comment.select("div.what")[0].style.border="2px solid yellow";comment.scrollTo();setTimeout(function(){comment.scrollTo()},2000)}else{}};this.comment_share=function(e){var main_element=e.target.up();var share_data=eval("("+main_element.getAttribute("rel:share_data")+")");var react_cam_comment=(objExists(e.react_cam)&&e.react_cam==true?true:false);var comment=$(share_data.id);var comment_id=comment.getAttribute("rel:comment_id");var url=comment_links.get_url(comment_id);var desc,title,img;var comment_data=comment.getAttribute("rel:data");comment_data=eval("("+comment_data+")");if(comment&&comment.select(".blurb")[0]){desc=comment.select(".blurb")[0].textContent}if(comment_data.type=="image"){img=comment.select(".image img")[0].src}if(comment_data.type=="react_image"){img=comment.select(".react_image img")[0].src}if(comment_data.type=="video"){if(comment.select(".video iframe").length){img=comment.select(".video iframe")[0].src}else{img=comment.select(".video embed")[0].src}}if(comment_data.type=="mixedpic"){img=comment.select(".mixedpic img")[0].src.replace(/(.+)(\.gif)/,"$1_preview$2")}if(!title&&$$('meta[property="og:title"]').length>0){title=$$('meta[property="og:title"]')[0].attributes.content.value}if(!desc&&$$('meta[property="og:description"]').length>0){desc=$$('meta[property="og:description"]')[0].attributes.content.value}if(!img&&$$('meta[property="og:image"]').length>0){img=$$('meta[property="og:image"]')[0].attributes.content.value}if(title.indexOf("Contribution To: ")<0){title="Contribution To: "+title}if(main_element.id=="facebook"){url=encodeURIComponent(url);title=encodeURIComponent(title);desc=encodeURIComponent(desc);img=encodeURIComponent(img);window.open("http://facebook.com/sharer/sharer.php?s=100&p[url]="+url+"&p[title]="+title+"&p[images][0]="+img+"&p[summary]="+desc,"_blank","width=600, height=260");comment_links.hide_share_box();if(react_cam_comment&&window.bf_react_cam){bf_react_cam.track("contrib_fb_share")}}else{if(main_element.id=="twitter"){desc=encodeURIComponent((desc.length>120)?desc.substr(0,115)+"...":desc);url=encodeURIComponent(url);if(react_cam_comment){if(objExists(BF_STATIC.username)&&BF_STATIC.username=="starbucksfrappuccino"){hashtags="sipface"}desc="I just left a reaction with the Frappuccino® Reaction Cam."}window.open("https://twitter.com/intent/tweet?text="+desc+(typeof hashtags!="undefined"?"&hashtags="+hashtags:"")+"&url="+url,"_blank","width=600,height=400");comment_links.hide_share_box();if(react_cam_comment&&window.bf_react_cam){bf_react_cam.track("contrib_tw_share")}}else{if(main_element.id=="email"){url=encodeURIComponent(url);title=encodeURIComponent(title);desc=encodeURIComponent(desc);window.open("mailto:?subject="+title+"&body="+desc+" "+url,"_self");comment_links.hide_share_box();if(react_cam_comment&&window.bf_react_cam){bf_react_cam.track("contrib_email_share")}}else{if(main_element.id=="link"){$(comment).select(".copy-link").each(function(cp){$(cp).remove()});$(comment).select(".comment-share").each(function(el){$(el).insert('<div class="copy-link"><span>Share This Link</span><input type="text" value="'+url+'" /></div>')});if(react_cam_comment&&window.bf_react_cam){bf_react_cam.track("contrib_link_share")}}else{if(main_element.id=="pinterest"){url=encodeURIComponent(url);desc=encodeURIComponent(desc);img=encodeURIComponent(img);window.open("http://pinterest.com/pin/create/button/?media="+img+"&url="+url+"&description="+desc,"_blank","width=600,height=400");comment_links.hide_share_box()}}}}}};this.get_url=function(id){var url="";if(document.URL.include("?")){url=document.URL.split("?")[0]}else{url=document.URL}url=url+"?comment="+id;return url}};var comment_links=new BF_comment_links();BuzzLoader.register(comment_links.init,1);(function(aO,aN,aM){function Z(b){ag(arguments,function(c,e){b[c]===aM&&(b[c]=e)});return b}function aa(b){ag(arguments,function(d,e){b[aC][ab(b,d)||d]=e});return b}function ab(e,c){var k=e[aC],j,h;if(k[c]!==aM){return c}c=c.charAt(0).toUpperCase()+c.slice(1);for(h=0;h<aj[aK];h++){j=aj[h]+c;if(k[j]!==aM){return j}}}function ac(h,e){var m=[aF,e,~~(h*100)].join("-"),l="{"+aF+":"+h+"}",k;if(!ai[m]){for(k=0;k<aj[aK];k++){try{ad.insertRule("@"+(aj[k]&&"-"+aj[k].toLowerCase()+"-"||"")+"keyframes "+m+"{0%{"+aF+":1}"+e+"%"+l+"to"+l+"}",ad.cssRules[aK])}catch(j){}}ai[m]=1}return m}function ae(e,d,f){f&&!f[av]&&ae(e,f),e.insertBefore(d,f||null);return e}function af(b){var d=aN.createElement(b||"div");ag(arguments,function(e,c){d[e]=c});return d}function ag(f,e){var h=~~((f[aK]-1)/2);for(var g=1;g<=h;g++){e(f[g*2-1],f[g*2])}}var aL="width",aK="length",aJ="radius",aI="lines",aH="trail",aG="color",aF="opacity",aE="speed",aD="shadow",aC="style",aB="height",aA="left",az="top",ay="px",ax="childNodes",aw="firstChild",av="parentNode",au="position",at="relative",ar="absolute",aq="animation",ap="transform",ao="Origin",an="Timeout",am="coord",al="#000",ak=aC+"Sheets",aj="webkit0Moz0ms0O".split(0),ai={},ah;ae(aN.getElementsByTagName("head")[0],af(aC));var ad=aN[ak][aN[ak][aK]-1],Y=function(b){this.opts=Z(b||{},aI,12,aH,100,aK,7,aL,5,aJ,10,aG,al,aF,0.25,aE,1)},X=Y.prototype={spin:function(u){var t=this,s=t.el=t[aI](t.opts);u&&ae(u,aa(s,aA,~~(u.offsetWidth/2)+ay,az,~~(u.offsetHeight/2)+ay),u[aw]);if(!ah){var p=t.opts,o=0,k=20/p[aE],j=(1-p[aF])/(k*p[aH]/100),h=k/p[aI];(function g(){o++;for(var c=p[aI];c;c--){var d=Math.max(1-(o+c*h)%k*j,p[aF]);t[aF](s,p[aI]-c,d,p)}t[an]=t.el&&aO["set"+an](g,50)})()}return t},stop:function(){var c=this,e=c.el;aO["clear"+an](c[an]),e[av]&&e[av].removeChild(e),c.el=aM;return c}};X[aI]=function(f){function g(k,l){return aa(af(),au,ar,aL,f[aK]+f[aL]+ay,aB,f[aL]+ay,"background",k,"boxShadow",l,ap+ao,aA,ap,"rotate("+~~(360/f[aI]*d)+"deg) translate("+f[aJ]+ay+",0)","borderRadius","100em")}var e=aa(af(),au,at),j=ac(f[aF],f[aH]),d=0,h;for(;d<f[aI];d++){h=aa(af(),au,ar,az,1+~(f[aL]/2)+ay,ap,"translate3d(0,0,0)",aq,j+" "+1/f[aE]+"s linear infinite "+(1/f[aI]/f[aE]*d-1/f[aE])+"s"),f[aD]&&ae(h,aa(g(al,"0 0 4px "+al),az,2+ay)),ae(e,ae(h,g(f[aG],"0 0 1px rgba(0,0,0,.1)")))}return e},X[aF]=function(e,d,f){e[ax][d][aC][aF]=f};var W="behavior",V="url(#default#VML)",U="group0roundrect0fill0stroke".split(0);(function(){var d=aa(af(U[0]),W,V),c;if(!ab(d,ap)&&d.adj){for(c=0;c<U[aK];c++){ad.addRule(U[c],W+":"+V)}X[aI]=function(){function n(k,h,b){ae(j,ae(aa(l(),"rotation",360/g[aI]*k+"deg",aA,~~h),ae(aa(af(U[1],"arcsize",1),aL,f,aB,g[aL],aA,g[aJ],az,-g[aL]/2,"filter",b),af(U[2],aG,g[aG],aF,g[aF]),af(U[3],aF,0))))}function l(){return aa(af(U[0],am+"size",p+" "+p,am+ao,-f+" "+-f),aL,p,aB,p)}var g=this.opts,f=g[aK]+g[aL],p=2*f,j=l(),e=~(g[aK]+g[aJ]+g[aL])+ay,o;if(g[aD]){for(o=1;o<=g[aI];o++){n(o,-2,"progid:DXImage"+ap+".Microsoft.Blur(pixel"+aJ+"=2,make"+aD+"=1,"+aD+aF+"=.3)")}}for(o=1;o<=g[aI];o++){n(o)}return ae(aa(af(),"margin",e+" 0 0 "+e,au,at),j)},X[aF]=function(f,e,h,g){g=g[aD]&&g[aI]||0,f[aw][ax][e+g][aw][aw][aF]=h}}else{ah=ab(d,aq)}})(),aO.Spinner=Y})(window,document);var bf_spinner=function(f,k){var j=false;var g=null;var e;var c=function(){var l=Math.floor((document.viewport.getHeight()/3)/3.5);var m={lines:8,length:l,width:Math.floor(0.66*l),radius:Math.floor(0.9*l),color:"#333",speed:1,trail:100,shadow:true};return m};var b=k||c();if(f&&$(f)){e=$(f)}else{try{e=new Element("div",{"class":"spinner_container",id:"spinner_"+Math.floor(Math.random()*100)});document.body.insert({top:e});var h="display:none;width:100%;position:fixed;left:0;height:"+document.viewport.getHeight()+"px;z-index:9999;top:0;";e.setAttribute("style",h)}catch(d){console.error(d)}}return{active:function(){return g},start:function(){if(g){return true}else{g=true}e.show();if(j){window.document.body.addClassName("spinner-activated");j=j.spin(e);return true}e.on("click",function(l){if(g){l.stop()}});j=new Spinner(b).spin(e)},stop:function(){try{window.document.body.removeClassName("spinner-activated");e.hide();g=false;j.stop()}catch(l){}},started:function(){return g}}};Array.isArray||(Array.isArray=function(b){return"object"===typeof b&&"[object Array]"===Object.prototype.toString.call(b)});var CountView=function(){this._elems_arr=[];this._time_interval=250;this._callback=null;this._interval_id=null};CountView.prototype=(function(){function d(f){f=f||window;if(f.pageXOffset!=null){return{x:f.pageXOffset,y:f.pageYOffset}}var g=f.document;if(document.compatMode=="CSS1Compat"){return{x:g.documentElement.scrollLeft,y:g.documentElement.scrollTop}}return{x:g.body.scrollLeft,y:g.body.scrollTop}}function e(f){f=f||window;if(f.innerWidth!=null){return{w:f.innerWidth,h:f.innerHeight}}var g=f.document;if(document.compatMode=="CSS1Compat"){return{w:g.documentElement.clientWidth,h:g.documentElement.clientHeight}}return{w:g.body.clientWidth,h:g.body.clientWidth}}var b=function(k){var m=k.offsetTop;var l=k.offsetLeft;var j=k.offsetWidth;var h=k.offsetHeight;while(k.offsetParent){k=k.offsetParent;m+=k.offsetTop;l+=k.offsetLeft}var g=d();var f=e();return(m<(g.y+f.h)&&l<(g.x+f.w)&&(m+h)>g.y&&(l+j)>g.x)};var c=function(){for(var g=0,f=this._elems_arr.length;g<f;g++){var h=this._elems_arr[g];if(b.call(this,h.elem)){h.time+=this._time_interval;h.active=true}else{h.active=false}}if(this._callback){this._callback(this._elems_arr)}};return{set_elems_arr:function(g,j){if(!Array.isArray(g)){g=[g]}for(var h=0,f=g.length;h<f;h++){this._elems_arr.push({elem:$(g[h]),time:0,active:false})}},get_elems_stat:function(){return this._elems_arr},start_count:function(f,h){if(f){this._time_interval=f}if(h){this._callback=h}var g=c.bind(this);g();this._interval_id=setInterval(g,this._time_interval)},stop_count:function(){if(this._interval_id){clearInterval(this._interval_id);this._interval_id=null}}}}());var HeatMap=function(){var h,c,z,u,b={},n=250,f=1800000,p=500,g=new CountView(),l=BF_STATIC.bf_env=="dev"?"/":"/buzzfeed/",d=BF_STATIC.web_root+l+"item_stats",e=document.location.search.toQueryParams(),k=e.hasOwnProperty("heatmap_debug"),B=e.hasOwnProperty("heatmap_track"),m=e.hasOwnProperty("heatmap_display"),D=e.hasOwnProperty("selenium");var t=function(){h=BF_STATIC.campaignid;c=$$(".buzz_superlist_item");if(!acl.user_can("general_admin")){B=m=false}u=B?1:p;z=B?true:((Math.floor(Math.random()*u)+1)==u);if(z){gtrack.track_events("[ttp]:heatmap_tracking","[nc]initialized","","",true);if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: Tracking stats for this visit.")}if(!D){if(window.onpagehide||window.onpagehide===null){window.onpagehide=w}else{window.onbeforeunload=w}}g.set_elems_arr(c);g.start_count(n,j)}if(m){s()}};var j=function(I){if(k){for(var G=0,F=I.length;G<F;G++){var H=I[G]["elem"];var K=I[G]["time"];var J=I[G]["active"];if(J){var E=C(H);console.log("unit_number: "+E);var L="green"}else{var L="#C70000"}$(H).setStyle({backgroundColor:L})}}};var C=function(G){var E=null,F=$(G.id);if(F){E=F.readAttribute("rel:buzz_num")}return E};var o=function(F){var E=F.id;if(matches=E.match(/(\w+)_(\d+)_(\d+)/)){return matches[3]}return null};var A=function(N){var H=(!N||!N.hasOwnProperty("type"))?"current":N.type;if(H!=="historical"){var K=g.get_elems_stat();var M={};for(var I=0,J=K.length;I<J;I++){var G=K[I]["elem"];var F=K[I]["time"];var E=C(G);if(E!=null){F=(F>f)?f:F;var L=o(G);M[E]={sub_buzz_id:L,time:F}}}return M}else{new BF_Request().request(d,{method:"get",parameters:{action:"get_stat",buzz_id:h},onSuccess:N.onSuccess})}};var w=function(){if(z&&h){gtrack.track_events("[ttp]:heatmap_tracking","[nc]tracking-started","","",true);var F=A();var H=Object.toJSON(F);var E={action:"save_stat",buzz_id:h,item_stat:H};var G=new BF_Request();G.request(d,{method:"post",asynchronous:false,parameters:E,onSuccess:function(I){gtrack.track_events("[ttp]:heatmap_tracking","[nc]tracking-complete","","",true);if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: Successfully saved stats.",H)}},onFailure:function(I){gtrack.track_events("[ttp]:heatmap_tracking","[nc]tracking-failed","","",true);if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: Error saving stats.",I)}}})}};var s=function(){var E=$("buzz_sub_buzz"),F=E.className,I=F.match("suplist"),H=F.match("suplist_none"),G=function(L){var N=[],O=0,M=(e.heatmap_display==="time")?"heatmap-time":"heatmap-views",J=function(R){if(R<1000){return R}else{if(R<10000){return R.toString().charAt(0)+","+R.toString().substring(1)}else{if(R>=1000000){return(R/1000000).toFixed(R%1000000!=0)+"M"}}}return(R/1000).toFixed(R%1000!=0)+"K"},Q=function(V){var S=Math.floor(V/(60*60)),W=V%(60*60),U=Math.floor(W/60),R=W%60,X=Math.ceil(R),T=function(Y){return(Y<10)?"0"+Y:Y};return T(S)+":"+T(U)+":"+T(X)},P=function(U,V,R){var W=(M==="heatmap-time")?V:R,T=Math.round(parseInt(V)/10)/100,S='<ul class="sb-stats">                <li class="sb-views"><span>Views:</span> <span class="sb-val">'+J(R)+'</span></li>                <li class="sb-time"><span>Time:</span> <span class="sb-val">'+Q(T)+"</span></li></ul>";U.insert(S);O++;U.writeAttribute("rel:"+M,W);N.push(U)},K=function(){return $(this).readAttribute("rel:"+M)};c.each(function(U,T){var S,W=o(U),R=[],V=L.findAll(function(Y,X){if(Y.sub_buzz_id!==W){return false}R.push(X);return true});if(R.length){R.each(function(X){L.splice(X,1)});V.each(function(X){if(+X.position===(O+1)){P(U,X.total_time,X.total_views)}})}else{S=!H&&(U.select(".buzz_superlist_number_inline").length||U.select(".buzz_superlist_number").length);if(H||S){P(U,0,0)}}});E.addClassName(M);HeatColor(N,K,{lightness:0.5,colorStyle:"greentored"})};if(!h||!I){return}A({type:"historical",onSuccess:function(L){var J=L.responseText.evalJSON(),K=J.stats;if(!J.success){if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: Error retrieving stats.")}return}if(Object.prototype.toString.apply(K)!=="[object Array]"||!K.length){if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: No stats returned for this post.")}return}G(K)}})};return{init:function(){try{t()}catch(E){if(BF_STATIC.bf_env!="live"){console.error(E)}}},get_stat:function(){return A()},save_stat:function(){return w()}}}();if(typeof BF_STATIC!="undefined"&&typeof BF_STATIC.language!="undefined"&&typeof countryLangLookup!="undefined"){window.___gcfg={lang:countryLangLookup[BF_STATIC.language],}}if(!isIE8()){BF_UTIL.createScript({url:"https://apis.google.com/js/client:plusone.js?onload=GCallback"})}if(BF_STATIC.bf_test_mode&&BF_STATIC.bf_env=="dev"){(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="https://apis.google.com/js/client:plusone.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)})()}function GCallback(){EventManager.fire("gplus:api-loaded")}var HeatColor=function(f,g,c){var d={elementFunction:function(){return $(this)},minval:0,maxval:0,lightness:0.75,colorStyle:"roygbiv",reverseOrder:false};if(c){Object.extend(d,c)}var e={findcolor:function(p,l,u){var m=(l===u)?1:(p-l)/(u-l);var j=d.colorStyle=="roygbiv"?0.5*m+1.7*(1-m):m+0.2+5.5*(1-m);var k=128;var o=2*Math.PI;var t=j+m*o;t=d.colorStyle!="roygbiv"?-t:t;var h=this.process(Math.floor((Math.cos(t)+1)*k));var n=this.process(Math.floor((Math.cos(t+Math.PI/2)+1)*k));var s=this.process(Math.floor((Math.cos(t+Math.PI)+1)*k));return"#"+h+n+s},process:function(h){var k=Math.floor(h+d.lightness*(256-h));var j=k.toString(16);j=j.length==1?"0"+j:j;return j},setMaxAndMin:function(h){var j=[];h.each(function(k){j.push(g.apply(k))});j=j.sort(function(l,k){return l-k});d.maxval=!d.reverseOrder?j[j.length-1]:j[0];d.minval=!d.reverseOrder?j[0]:j[j.length-1]}};if(!d.minval&&!d.maxval){e.setMaxAndMin(f)}else{if(d.reverseOrder){var b=d.minval;d.minval=d.maxval;d.maxval=b}}f.each(function(j){var l=g.apply(j);var k=e.findcolor(l,d.minval,d.maxval);var h=d.elementFunction.apply(j);if(h.nodeType==1){h.setStyle({backgroundColor:k})}else{if(h.nodeType==3){h.setStyle({color:k})}}});return(this)};BFContribute=function(){this.ERR='Sorry, there was a problem processing your request. If it persists please <a href="http://www.buzzfeed.com/about/contact">contact support</a>.';this.ERR_DUPE="Woops. It looks like you've already contributed this response.";this.TEXT_ERR="Please add your message.";this.IMAGE_ERR="Please add your image and a description.";this.IMAGE_TOO_LARGE="Max image upload size is 2 megabytes.";this.VIDEO_ERR="Please add a valid video link and a description.";this.QUOTE_ERR="Please add a quote and an author.";this.LINK_ERR="Please add a link and a description.";this.ERR_BLIST="An error has occurred processing a request from your IP. If it continues, contact error@buzzfeed.com.";this.type_list=new Array("text","video","image","link");this.buzz_data={};this.subContributeParent=0;this.main_buzz_id;this.init=function(){bf_login.init();var user_info=(new BF_User()).getUserInfo();if(user_info&&typeof user_info.p_disable_comment!="undefined"&&user_info.p_disable_comment=="true"){$$("#contribute-box").each(function(el){el.style.display="none"});return true}if(!$("contribute-form")){return}var submit_handler=function(event){event.stop();bf_contribute.submit()}.bind(this);if($("contribute-id")){bf_contribute.main_buzz_id=$("contribute-id").value}$("add-something-interesting").observe("click",function(event){event.stop();bf_contribute.reset_contribute_box()});$$(".respond").invoke("observe","click",bf_contribute.observeRespond);$("contribute-form").observe("submit",submit_handler);$("contribute-submit").show();$("contribute-post").observe("click",function(e){$("submit-mode").value="save"});$("contribute-submit").observe("click",function(e){$("submit-mode").value="preview"});var fwipeit=function(type){return function(event){event.stop();bf_contribute_toggleTabs("on");if($("respond")){$("respond").removeClassName("previewing")}$("contribute-message").update("");$("contribute-message").hide();$("contribute-preview").hide();$("contribute-form").reset();$("contribute-cancel").hide();$("image-button").value="Select Image...";$("contribute-post").hide();$("contribute-submit").value="Preview";$("contribute-preview-content").update()}};$("contribute-cancel").observe("click",fwipeit(true));$("contribute-close-success-box").observe("click",function(e){$("contribute-success").hide()});bf_contribute.goforit_default();var switch_function=function(e){e.stop();type=e.element().id.match(/(^\w+)/)[0];bf_contribute.disableCurrent();var button_id=type+"-contribute-activate";bf_contribute.buttonToggle(button_id);var form_id="contribute-"+type+"-form";bf_contribute.enableForm(form_id);if($("big-pink-arrow")){$("big-pink-arrow").style.display="none"}return false}.bind(this);for(i=0;i<bf_contribute.type_list.length;i++){var id=bf_contribute.type_list[i]+"-contribute-activate";var element=$(id);if(element){element.observe("click",function(e){e.stop();switch_function(e);return false})}}$("create_full_post_toggle").observe("click",function(e){e.stop();$$(".full-post-field").invoke("show");$("create_full_post_toggle").hide();$("create_simple_post_toggle").show()});$("create_simple_post_toggle").observe("click",function(e){e.stop();$$(".full-post-field").invoke("hide");$("create_full_post_toggle").show();$("create_simple_post_toggle").hide()});var vid_embed=$("video-embed");if(vid_embed){$("video-embed").observe("mouseup",function(){bf_contribute.setVideo()}.bindAsEventListener(this));$("video-embed").observe("keyup",function(){bf_contribute.setVideo()}.bindAsEventListener(this))}var image_button=$("image-button");var photo_editor_button=$("photo-editor-button");if(image_button&&Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==6){var image_handler=function(e){e.stop();$("image-preview-div").show();$("image-preview").hide();if($("user-loading")){$("user-loading").show()}$("user-image-edit-iframe").src="/static/images/public/spinners/big_on_eee.gif";$("user-image-edit").addClassName("bf_dialog_confirm");BF_UI.showDialog("user-image-edit");$("user-image-edit-iframe").src="/buzzfeed/_edit_user_contribution_image?action=imageform"}.bindAsEventListener(this);image_button.observe("click",image_handler);image_button.show();if(photo_editor_button){photo_editor_button.hide()}}if(photo_editor_button){var editor_handler=function(e){e.stop();if($("user-loading")){$("user-loading").show()}$("user-image-edit-iframe").src="/static/images/public/spinners/big_on_eee.gif";$("user-image-edit").removeClassName("bf_dialog_confirm");BF_UI.showDialog("user-image-edit","Edit a Photo");var over_query="";if($("photo_editor_image")){over_query="&overlay="+escape($F("photo_editor_image"))}$("user-image-edit-iframe").src="/buzzfeed/_edit_photo_editor_image?action=imageform"+over_query}.bindAsEventListener(this);photo_editor_button.observe("click",editor_handler)}if($("video-supported-text")){$("video-supported-text").update(BF_VIDEO_TYPES_STRING)}bf_contribute.update_contribs()};this.reset_contribute_box=function(){$("contribute-form").reset();bf_contribute_toggleTabs("on");$("contribute-cancel").hide();$("contribute-post").hide();$("contribute-submit").value="Preview";$("contribute-preview-content").update();$("contribute-parent-id").setValue(0);var add_interesting=$("add-something-interesting");add_interesting.parentNode.insertBefore($("contribute-box"),add_interesting.nextSibling);add_interesting.parentNode.insertBefore($("contribute-preview-content"),add_interesting.nextSibling);bf_contribute.subContributeParent=0};this.update_contribs=function(){var messages=$$(".contribution-list .what .blurb");messages.each(function(el){bf_contribute.create_list_link($(el))})};this.create_list_link=function(el){if(!el||!bf_contribute.buzz_data){return}if(!bf_contribute.fetched_buzz){bf_contribute.fetch_buzz_data()}var msg=$(el).innerHTML;var reg_p=new RegExp("(?!>)(#[0-9]+)(?!</a>)","g");var reg_m=new RegExp("[^0-9]+","g");var data=bf_contribute.buzz_data;var media_keys=[];while(msg.match(reg_p)){r=msg.match(reg_p);msg=msg.replaceAll(r[0],"");key=r[0].replace(reg_m,"");if(data.hasOwnProperty(key)){var link="";link='<a class="scroll" href="javascript:void(0);" onclick="BF_Effect.ScrollIntoView('+data[key].eid+')">';$(el).innerHTML=$(el).innerHTML.replaceAll(r[0],link+"#"+key+"</a>");if(data[key].btype.match("image|video")&&data[key].img&&media_keys.indexOf(key)<0&&!data[key].is_graphic){$(el).innerHTML=$(el).innerHTML+link+"<img src='"+data[key].img+"' class='list_img_thumb'></a>";media_keys.push(key)}else{if(data[key].btype.match("grid_row")&&data[key].img&&media_keys.indexOf(key)<0){var contrib_grid_html=link.replace('class="scroll"','class="scroll contrib_grid_row"');for(i=0;i<data[key].img.length;i++){contrib_grid_html=contrib_grid_html+"<img src='"+data[key].img[i]+"' class='list_grid_row_thumb'>";media_keys.push(key)}contrib_grid_html="<div>"+contrib_grid_html+"</div>";$(el).innerHTML=$(el).innerHTML+contrib_grid_html+"</div></a>"}}}}};this.fetch_buzz_data=function(){$$(".buzz_superlist_item").each(function(el){var down=$(el).down(".buzz_superlist_number, .buzz_superlist_number_inline");if(!down){return false}var key=down?down.innerHTML.replace(".",""):"";var content=$(el).down(".sub_buzz_content")?$(el).down(".sub_buzz_content"):"";var classname=$(el).className;var is_graphic=false;try{is_graphic=content.down(".graphic_image_wrapper")}catch(e){}bf_contribute.buzz_data[key]={eid:$(el).id,btype:classname.match("image")?"image":classname.match("video")?"video":classname.match("grid_row")?"grid_row":"na",is_graphic:is_graphic};if(bf_contribute.buzz_data[key].btype.match("image")){var img=$(content).down("img");bf_contribute.buzz_data[key].img=img.hasAttribute("rel:bf_image_src")&&!img.src.match(/_preview.gif/)?img.getAttribute("rel:bf_image_src"):img.src}else{if(bf_contribute.buzz_data[key].btype.match("video")){var embed_area=$(content).down(".video-embed-area");if(embed_area){bf_contribute.buzz_data[key].img=embed_area.getAttribute("rel:thumb")}}else{if(bf_contribute.buzz_data[key].btype.match("grid_row")){bf_contribute.buzz_data[key].img=[];$(el).select(".grid_cell img").each(function(img){bf_contribute.buzz_data[key].img.push(img.hasAttribute("rel:bf_image_src")&&!img.src.match(/_preview.gif/)?img.getAttribute("rel:bf_image_src"):img.src)})}}}});bf_contribute.fetched_buzz=1};this.getFormParams=function(type){var params={form:type,buzz_id:$F("contribute-id"),parent_id:$F("contribute-parent-id"),real_parent_id:$F("contribute-real-parent-id")};switch(type){case"text":var text=$F("text-text");if(!text){this.setErrMessage(this.TEXT_ERR);bf_contribute_toggleTabs("on");if($("contribute-post")){$("contribute-post").hide()}return false}Object.extend(params,{blurb:text});break;case"image":var text=$F("image-text").strip();var image=TT_Filters.html_noentities($F("image-image").strip());var isMixedPic=(bf_contribute.form=="mixedpic"||bf_contribute.form=="mixedpic_wide")?true:false;var credit=TT_Filters.html_noentities(TT_Filters.link($F("image-credit").strip()));if(credit&&!credit.match(/^https?:\/\//)){credit="http://"+credit}if(credit){credit=this.url_entities(credit)}if(!image||(!text&&!isMixedPic)){this.setErrMessage(this.IMAGE_ERR);if($("contribute-post")){$("contribute-post").hide()}if(image){$("image-preview-div").show()}bf_contribute_toggleTabs("on");return false}if($F("submit-mode")=="save"){$("image-preview").hide()}Object.extend(params,{blurb:text,url:image,credit_url:credit,height:this.image_height,width:this.image_width});break;case"video":var text=TT_Filters.html_noentities($F("video-text").strip());var link=TT_Filters.link($F("video-embed-url").strip());if(typeof link=="undefined"){link=""}if(typeof text=="undefined"){text=""}if(link&&!link.match(/^https?:\/\//)){link="http://"+link}if(!text||!link){this.setErrMessage(this.VIDEO_ERR);bf_contribute_toggleTabs("on");if($("contribute-post")){$("contribute-post").hide()}return false}Object.extend(params,{blurb:text,url:link});break;case"quote":var text=TT_Filters.html_noentities($F("quote-text").strip());var author=TT_Filters.html_noentities($F("quote-attribution").strip());if(!text||!author){this.setErrMessage(this.QUOTE_ERR);if($("contribute-add-your-response-heading")){$("contribute-add-your-response-heading").show()}bf_contribute_toggleTabs("on");if($("contribute-post")){$("contribute-post").hide()}return false}Object.extend(params,{blurb:text,author:author});break;case"link":var text=TT_Filters.html_noentities($F("link-text").strip());var link=TT_Filters.link($F("link-url").strip());if(!link.match(/^https?:\/\//)){link="http://"+link}link=this.url_entities(link);if(!text||!link){this.setErrMessage(this.LINK_ERR);bf_contribute_toggleTabs("on");if($("contribute-post")){$("contribute-post").hide()}return false}Object.extend(params,{blurb:text,url:link});break}return params};this.submit=function(registered,params){var user=new BF_User();if(!$("contribute-post")){return false}if(user.isLoggedIn()&&(this.type!="image"||$F("image-image"))){$("contribute-post").show()}$("contribute-message").hide();$("contribute-box").show();if(this.login_enable_form){this.login_enable_form=false;this.enableForm("contribute-"+this.type+"-form")}else{if($F("submit-mode")=="preview"){$("contribute-cancel").show();$("contribute-submit").value="Preview Again";if($("video-preview")){$("video_preview").hide()}}if(params){$("submit-mode").value="preview"}else{params=this.getFormParams(this.type)}if(params!==false){if($F("submit-mode")=="save"){this.postit(params,registered)}else{this.previewFromServer(params,registered)}}}};this.previewFromServer=function(params,registered){$("saving-status").show();var user=new BF_User();if(user.isLoggedIn()){var userInfo=user.getUserInfo();params.username=userInfo.username;params.display_name=userInfo.display_name?userInfo.display_name:userInfo.username;if(userInfo.image&&userInfo.image!=null&&userInfo.image!="null"){params.user_image=userInfo.image}else{params.user_image="/static/images/public/defaults/user_large.jpg"}}else{params.username="You";params.user_image="/static/images/public/defaults/user_large.jpg"}params.action="process";params.template="contribution";params.preview="true";params.since_minutes="1";params.static_root=BF_STATIC.static_root;params.image_root=BF_STATIC.image_root;if(bf_contribute.subContributeParent>0){params.child_comment="1"}var ajax=new BF_Request();ajax.request("/buzzfeed/_template",{method:"post",parameters:params,onSuccess:function(resp){$("contribute-post").disabled=false;var user=new BF_User();var json=resp.responseText;var obj=json.evalJSON();if(obj.success){var html=obj.snippet;if(!(user.isLoggedIn()||registered)){$("contribute-post").show()}this.preview_contribution(html,obj)}else{var errors="";for(var key in obj.errors){if(errors!=""){errors+=", "}errors+=obj.errors[key]}this.setErrMessage(errors);$("contribute-post").hide()}$("saving-status").hide();document.fire("contribute:previewFromServerOk")}.bind(this),onFailure:function(resp){ajax.alert("Error contacting server");$("saving-status").hide();document.fire("contribute:previewFromServerError")},bf_auth:true})};this.preview_contribution=function(preview,obj){var user=new BF_User();if($("big-pink-arrow")){$("big-pink-arrow").style.display="none"}if($("respond")){$("respond").addClassName("previewing")}if($("image-preview")){$("image-preview").hide()}$("contribute-preview-content").update(preview.toString());bf_contribute_toggleTabs("off");if($("who-preview")){console.warn("who-form is obsolete?")}if(user.isLoggedIn()){if(((new BF_User()).getUserInfo()).f_ad=="true"){$$("#contribute-preview-content .contrib")[0].addClassName("ad")}}if(this.type=="video"){var embedVal=$F("video-embed-url");if(embedVal){if(bf_contribute.subContributeParent>0){var so=BF_initSwfObject(embedVal,{width:575,height:375});so.write("video_buzz_element_"+obj.video_preview_uri)}else{var so=BF_initSwfObject(embedVal,{width:605,height:505});so.write("video_buzz_element_"+obj.video_preview_uri)}}}bf_contribute.create_list_link($$("#contribute-preview-content .what .blurb")[0])};this.postit=function(params,registered){var user=new BF_User();if(!user.isLoggedIn()&&!registered){$("submit-mode").value="save";bf_login.delayedLoggedInCallbacks=[];bf_login.delayedLoggedInCallbacks.push({obj:"bf_contribute",fn:"previewAndPostIt",params:[params]});signin.callbacks.onRegister.push(function(obj,json){this[this.type+"Contribution"](json)}.bind(this));signin.open({signin_type:"initial",mode:"contribution",location:"contribution"});if(Prototype.Browser.IE8){$$(".signin_overlay")[0].scrollIntoView()}return false}$("saving-status").show();this.params=params;var success_handler=function(resp){this._response(resp);document.fire("contribute:postitOk")}.bindAsEventListener(this);var error_handler=function(resp){this.server_error(resp);document.fire("contribute:postitError")}.bindAsEventListener(this);if(params.form=="mixedpic"&&(params.id==1860073||params.id==1927310||params.id==1984234)){this.use_minisuper(params)}else{(new BF_Targetting_Pixel()).add("comment");if(registered){params.session_key=registered.session_key}else{params.session_key=BFW_Util.getCookie(BFW_COOKIE)}params.delete_images="no";var args={method:"post",parameters:params,onSuccess:success_handler,onFailure:error_handler};var user_info=(new BF_User()).getUserInfo();if(user_info.username){args.needsToken=true}var ajax=new BF_Request();$("contribute-post").disabled=true;ajax.request("/buzzfeed/_commentribute",args);$("contribute-submit").value="Preview"}};this._response=function(resp){if($("contribwhat_")){$("contribwhat_").show()}$("saving-status").hide();this.goforit_default();var obj=eval("("+resp.responseText+")");if(obj.updated||(obj.success&&obj.success==1)){if(objExists(obj.last_active)){BFW_Util.updateInfoCookie({last_active:obj.last_active})}var react_cam_comment=(window.bf_react_cam&&objExists(bf_react_cam)&&objExists(obj.uri)&&obj.uri.match(/^reactcam-auto-title/)?true:false);if(this.params.form=="text"){this.params.form_string="responded "}if(this.params.form=="link"){this.params.form_string=" added a link "}if(this.params.form=="image"){this.params.form_string=" added an image "}if(this.params.form=="video"){this.params.form_string=" added a video "}this.params.parent_title=$F("parent_name");this.params.title_is_excerpt=$F("title_is_excerpt");this.params.parent_blurb=$F("parent_blurb");this.params.username=$F("current-username");this.params.buzz_uri=objExists(buzzDetails.uri)?buzzDetails.uri:null;this.params.buzz_username=objExists(BF_STATIC.username)?BF_STATIC.username:null;this.params.id=objExists(obj.id)?obj.id:null;contrib_uri="http://"+BFWebPath()+"/"+this.params.buzz_username+"/"+this.params.buzz_uri+"?comment="+obj.id;if(react_cam_comment&&obj.id){this.goforit_reactcam();contrib_uri="http://"+BFWebPath()+"/"+this.params.username+"/"+this.params.uri+"?comment="+obj.id}if(obj.thumb){this.params.image_src=obj.thumb}else{this.params.image_src=$("image-thumb").value}var share_pic=BFWebPath()+this.params.image_src;if(react_cam_comment){share_pic=BF_STATIC.image_root+obj.image.replace(/\.gif$/m,"_preview.gif")}social.contribute(this.params);if($("permalink-href")){$("permalink-href").setAttribute("href",contrib_uri);$("permalink-href").id+=Math.random()*100000}if($("tools-bar")){$("tools-bar").show();$("tools-bar").id+=Math.random()*100000}var html=$("contribute-preview-content").cloneNode(true);html.id+=Math.random()*100000;var element_id="highlight-"+Math.floor(Math.random()*100);var li=new Element("li",{id:element_id});li.appendChild(html);li.setOpacity(0);if(bf_contribute.subContributeParent!=0){var respond=li.getElementsByClassName("respond");if(respond[0]){respond[0].setAttribute("rel:parent_magic_id",this.params.parent_username+":"+this.params.parent_uri)+":"+html.id}$("contrib-form-container-"+bf_contribute.subContributeParent).insert({before:li})}else{var anchors=li.getElementsByTagName("A");for(var i=0;i<anchors.length;i++){if(!anchors[i].className.match("scroll")){anchors[i].setAttribute("href",contrib_uri)}}$("contribution-list").insert({top:li})}setTimeout(function(){fadeIn(element_id,0)},100);var user=new BF_User();if(user.isLoggedIn()&&!$("moderation_contribute")){removeAllCssClasses("contribute-success");$("contribute-success").addClassName(this.params.type);$("contribute-success-shares").childElements().each(function(el){$(el).remove()});var tw_desc="",fb_desc="",alt_desc=(objExists(obj.cleaned_text)?obj.cleaned_text:"");if(react_cam_comment){if(objExists(BF_STATIC.username)&&BF_STATIC.username=="starbucksfrappuccino"){hashtags="sipface"}tw_desc="I just left a reaction with the Frappuccino® Reaction Cam."}else{if(objExists(obj.cleaned_text)){tw_desc=obj.cleaned_text}}fb_desc=tw_desc;if(objExists(fb_desc)&&fb_desc.indexOf("®")){fb_desc=fb_desc.replace("®","&#174;")}var label="";if(typeof this.params.react_wtih_gif!="undefined"){share_pic="http://"+BFWebPath()+this.params.thumb;label="rwg:"+rwg.cleanGifName(this.params.thumb)}bf_shares.fb_share({el:$("contribute-success-shares"),title:(objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title),uri:contrib_uri,size:"big",picture:share_pic,description:(objExists(fb_desc)?fb_desc:alt_desc),onclick:("gtrack.track_events('[ttp]:contribution','share/facebook/comment','"+label+"');")});bf_shares.tw_tweet({el:$("contribute-success-shares"),title:(objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title),uri:contrib_uri,size:"big",picture:share_pic,description:tw_desc,hashtags:(typeof hashtags!="undefined"?hashtags:""),onclick:("gtrack.track_events('[ttp]:contribution','share/twitter/comment','"+label+"');")});bf_shares.email_link({el:$("contribute-success-shares"),size:"big",subject:(objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title),body:(objExists(fb_desc)?fb_desc:alt_desc)+"%0D%0A"+contrib_uri,onclick:("gtrack.track_events('[ttp]:contribution','share/email/comment','"+label+"');")});$(element_id).insert($("contribute-success"));$("contribute-success").show()}else{if(!$("moderation_contribute")){$("contribute-box").hide();if($("reg-success-message")){$("reg-success-message").update(bf_register.SUCCESS1)}$("registered-success").show()}}BF_Effect.ScrollIntoView(element_id);if($("number_of_contribs_header")){$("number_of_contribs_header").show()}$("contribute-post").hide();$("contribute-preview").hide();$("contribute-form").reset();bf_contribute.reset_contribute_box();$("contribute-preview-content").update();bf_contribute_toggleTabs("on");gtrack.trackShares(25,"numComments");gtrack.track_events(gtrack.tt_page+":contribute","contribute/submit","")}else{if(obj.error=="duplicate name"){this.setErrMessage(this.ERR_DUPE)}else{if(obj.error=="blacklist"){this.setErrMessage(this.ERR_BLIST)}else{this.setErrMessage(this.ERR)}}}};this.previewAndPostIt=function(params){var number_of_comment_pages=parseInt($F("comments-pages"));var waitfor=number_of_comment_pages?"ajax_comments:loaded":"ajax_comments:load";if(window[waitfor]){var fired=false;document.observe("contribute:previewFromServerOk",function(params){if(!fired){fired=true;this.postit.call(this,params)}}.bind(this,params));this.submit(null,params)}else{EventManager.observe(waitfor,this.previewAndPostIt.bind(this,params));$("responses").scrollIntoView()}};this.use_minisuper=function(params){var description="auto-title_"+(new Date()).getTime();var name="auto-title_"+(new Date()).getTime();if(params.caption){description=params.caption;name=truncateStr(params.caption,100)}var parameters={action:"save",name:name,description:description,image:params.url,width:params.width,height:params.height};parameters["submit-to"]=364333;parameters["auto-tag"]=params.id==1927310?"floridaoj2":params.id==1984234?"floridaoj3":"floridaoj";var success_handler=function(resp){this._response(resp)}.bindAsEventListener(this);var error_handler=function(resp){console.log(resp);this.server_error(resp)}.bindAsEventListener(this);new Ajax.Request("/buzzfeed/minisuper",{parameters:parameters,evalJSON:"force",onFailure:error_handler,onSuccess:success_handler})};this.setVideo=function(){var vd=new bf2_terminal_Video();vd.detect_type($F("video-embed"));$$("#contribute-video-form .video_privacy_warning").each(function(el){el.hide()});if(vd.type){var url=vd.src_link,so=BF_initSwfObject(url);so.write("video_preview");if($("video_preview")){$("video_preview").show()}$("video-embed-url").value=url;if(!!vd.possible_privacy_restrictions){$$("#contribute-video-form .video_privacy_warning").each(function(el){el.show()})}}else{if($("video_preview")){$("video_preview").update("")}if($("video_preview")){$("video_preview").hide()}$("video-embed-url").value=""}};this.save_image=function(image,width,height,form){$("user-image-edit").removeClassName("bf_wide_canvas");BF_UI.closeDialog("user-image-edit",{loadDefaultDiv:"quickpost-spinner"});$("image-image").value=image;bf_contribute.image_width=width;bf_contribute.image_height=height;if(form){bf_contribute.form=form}$("image-preview").show();$("image-preview").src=BF_STATIC.image_root+image;if(width>425){$("image-preview").setStyle({width:"425px",height:"auto"})}else{if(height){$("image-preview").setStyle({height:height+"px"})}}$("image-preview-div").show();$("photo-editor-button").value="Change Image..."};this.enableForm=function(id){if(!$(id)){return}$(id).show();this.currentForm=id;this.type=id.match(/\-(\w+)/)[1];this.login_enable_form=false};this.cleanup_image_registration=function(){if($("contribute-submit-fieldset")){$("contribute-submit-fieldset").show()}$("contribute-submit-fieldset").show();bf_contribute_toggleTabs("on");if($("image-preview-div")){$("image-preview-div").show()}if($("video_preview")&&$F("video-embed")){$("video_preview").show()}};this.buttonToggle=function(id){if(!$(id)){return}$(id).addClassName("current");this.currentToggle=id;if(id!="image-contribute-activate"){this.cleanup_image_registration()}};this.disableCurrent=function(){$(this.currentForm).hide();if(this.currentToggle!=undefined){$(this.currentToggle).removeClassName("current")}};this.setErrMessage=function(err){$("contribute-message").update(err);$("contribute-message").addClassName("error");$("contribute-message").show();$("contribute-submit").disabled=false};this.server_error=function(resp){$("saving-status").hide();this.setErrMessage(this.ERR)};this.addLineBreaks=function(string){string=string.replace(/(\r|\r\n|\n){2,}/gm,'<span class="line-break">&nbsp;</span>');string=string.replace(/(\r|\r\n|\n)/gm,"<br />");return string};this.url_entities=function(s){if(s){var newtext="";var chars=s.split("");for(i=0;i<chars.length;i++){var chr=chars[i].charCodeAt(0);if(chr>127){newtext+=encodeURIComponent(chars[i])}else{newtext+=chars[i]}}return newtext}};this.observeRespond=function(event){event.stop();bf_contribute.reset_contribute_box();var parent_comment_id=this.getAttribute("rel:parent_comment_id");var real_parent_id=this.getAttribute("rel:real_parent_id");if(!parent_comment_id){return}var buzz_id=this.getAttribute("rel:buzz_id");$("contribute-parent-id").setValue(parent_comment_id);$("contribute-real-parent-id").setValue(real_parent_id);$("contribute-id").setValue(buzz_id);$("contrib-form-container-"+parent_comment_id).appendChild($("contribute-preview-content"));$("contrib-form-container-"+parent_comment_id).appendChild($("contribute-box"));bf_contribute.subContributeParent=parent_comment_id;BF_Effect.ScrollIntoView("contribute-box")};this.goforit_default=function(){$("contribute-again-link").stopObserving("click");$("contribute-again-link").observe("click",function(e){e.stop();if($("contribution-types-tab")){$("contribution-types-tab").show()}if($("add-something-interesting")){$("add-something-interesting").show()}if($("respond")){$("respond").removeClassName("previewing")}$("contribute-preview").hide();$("contribute-submit-fieldset").show();bf_contribute_toggleTabs("on");$("contribute-form").reset();$("contribute-box").show();$("contribute-success").hide();$("contribute-cancel").hide();$("image-button").value="Select Image...";BF_Effect.ScrollIntoView("respond")})};this.goforit_reactcam=function(){$("contribute-again-link").stopObserving("click");$("contribute-again-link").observe("click",function(e){e.stop();$("contribute-success").hide();BF_Effect.ScrollIntoView("react_cam_button");document.fire("contribute:goforit_reactcam")})}};fadeIn=function(c,b){$(c).setOpacity(b/100);if(b<100){setTimeout("fadeIn('"+c+"',"+(b+2)+")",5)}};bf_contribute_toggleTabs=function(b){if(b=="on"){if($("contribution-types-tab")){$("contribution-types-tab").show()}if($("add-something-interesting")){$("add-something-interesting").show()}}else{if($("contribution-types-tab")){$("contribution-types-tab").hide()}}};var bf_contribute=new BFContribute();BuzzLoader.register(bf_contribute.init,1);var BF_Audio_Player=function(){this.generate_audio_player=function(c,d){if(!d&&!$("audio_buzz_element_"+c.id)){return}var b=document.createElement("audio");if(!!(b.canPlayType&&b.canPlayType("audio/mpeg;").replace(/no/,""))){b.update("Your browser does not support this audio player.");b.setAttribute("controls","controls");var f=document.createElement("source");f.setAttribute("src",c.url);b.appendChild(f);if(d){return b.outerHTML}$("audio_buzz_element_"+c.id).appendChild(b)}else{var e=new Template('<a href="javascript:;" onclick="BFAudioPlayer.show_iframe_audio(this, \'#{url}\');">Play audio</a>');if(Prototype.Browser.Gecko&&navigator.plugins){if($A(navigator.plugins).detect(function(g){return g.name.indexOf("QuickTime")!=-1})){e=new Template('<object type="audio/mpeg" width="300" height="35" data="#{url}"><param name="AutoStart" value="0"><object/>')}else{if($A(navigator.plugins).detect(function(g){return g.name.indexOf("Windows Media")!=-1})){e=new Template('<object type="application/x-mplayer2" width="300" height="35" data="#{url}"><param name=`"AutoStart" value="0"></object>')}else{if($A(navigator.plugins).detect(function(g){return g.name.indexOf("RealPlayer")!=-1||g.name.indexOf("VLC")!=-1})){e=new Template('<embed type="audio/x-pn-realaudio-plugin" src="#{url}" style="height:30px;width:300px" loop="false" autostart="false"/>')}}}}if(d){return e.evaluate(c)}$("audio_buzz_element_"+c.id).insert(e.evaluate(c))}};this.show_iframe_audio=function(c,b){$(c).insert({before:'<iframe height="30" width="300" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" src="'+b+'"></iframe>'});$(c).hide()}};var BFAudioPlayer=new BF_Audio_Player();var BF_LF_image_bleed=function(e){this.BLEED_BLOCK_SELECTOR=".buzz_superlist_item_image.image_lffw";this.BLEED_CONTENT_SELECTOR=".sub_buzz_content";this.BLEED_DEBOUNCE_DELAY=400;Object.extend(this,e);var f=[];var b=function(g){f.each(function(j){if(j.original_width>g){j.subbuzz.removeClassName("image_lffw_bled");j.bleed_element.writeAttribute("style","")}else{var h=j.subbuzz.viewportOffset().left?j.subbuzz.viewportOffset().left:0;j.subbuzz.addClassName("image_lffw_bled");j.bleed_element.setStyle({marginLeft:-h+"px",width:g+"px",height:"auto"})}})};var d=BF_UTIL.debounce(b,this.BLEED_DEBOUNCE_DELAY);var c=this;c.initialized=false;this.init=function(){var g=$$(c.BLEED_BLOCK_SELECTOR);var h=document.viewport.getWidth();if(!g.length){return}else{g.each(function(j){if(j.hasClassName("been_bled")){return true}j.addClassName("been_bled");f.push({subbuzz:j,bleed_element:j.select(c.BLEED_CONTENT_SELECTOR).first(),original_width:j.getWidth(),})});b(h);if(!c.initialized){Event.observe(window,"resize",function(){var j=document.viewport.getWidth();d(j);EventManager.fire("BF_LF_image_bleed:resized")})}}c.initialized=true}};BF_LF_image_bleed.prototype={constructor:BF_LF_image_bleed};var bf_lf_image_bleed=new BF_LF_image_bleed();bfjs.onPageLoad(bf_lf_image_bleed.init);BF_FlagComment=function(){this.init=function(){flagComment.assign_handlers()};this.image_path="";this.assign_handlers=function(){universal_dom.assign_handler({bucket:"flag-comment-cancel",handler:flagComment.hide_flag_comment_form,event:"click"})};this.hide_flag_comment_form=function(){$("flag_comment").hide();bf_catcha.catcha_answer=""};this.move_it=function(d){$(d).appendChild($("flag_comment").remove());var c=$("flag_comment").up().getHeight();var b=$("flag_comment").up().getWidth()-$("flag_comment").getWidth()/2;$("flag_comment").setStyle({top:c+"px"});$("flag_comment").setStyle({left:b+"px"});$("flag_submit").setAttribute("comment_id",d)};this.draw_catcha=function(){if(flagComment.image_path==""){flagComment.image_path=$$("form.flag_comment_popup img")[0].src}if(BFW_Util.getCookie("catcha-anonymus_flag_comment")){bf_catcha.catcha_answer="";universal_dom.get_bucket_elements("catcha-anonymus_flag_comment").each(function(b){b.getElementsByTagName("INPUT")[0].value="";b.getElementsByTagName("IMG")[0].src=flagComment.image_path;b.getElementsByTagName("SPAN")[0].innerHTML="";bf_catcha.set_image_and_question({service:"anonymus_flag_comment",image_element:b.getElementsByTagName("IMG")[0],question_element:b.getElementsByTagName("SPAN")[0]});b.show();$("flag_comment").show()})}}};flagComment=new BF_FlagComment();BuzzLoader.register(function(){flagComment.init()},1);var Bookmarks=function(){var b=this;this.initializedGoogleCallback=false;this.maxBookmarkCount=1000;this.ajaxUrl="/buzzfeed/api/bookmarks";this.bookmarksData={userId:"",bookmarks:{},showPromo:true,hasBookmarks:false,addAfterLogin:0,sync_id:0};this.templates={post_button:'<div class="bookmark_share">					<a class="bf_dom shareBtn big square" rel:gt_cat="Buzz:sharing-apper" rel:gt_act="bookmark" rel:bf_bucket="add_bookmark" href="javascript:;">						<div class="fa fa-bookmark"></div>						<div class="label">Bookmark it</div>					</a>					<div class="bookmark-tooltip" style="display:none;"></div>				</div>',tooltips:{new_tooltip:"<b>NEW!</b> <a>Click to bookmark</a>",bookmarked_tooltip:'<b>Bookmarked!</b><a class="bf_dom view-bookmarks" rel:gt_cat="Buzz:sharing-apper" rel:gt_act="view-bookmarks" href="#">VIEW BOOKMARKS</a>'},bmtools:'<div class="bmtools"  rel:gt_cat="BuzzBookmarks:feed" >								<a class="bf_dom bm-tool-track bm-tool bookmark-share fa fa-share" href="javascript:;" rel:bf_bucket="share_bookmark"></a>								<a class="bf_dom bm-tool-track bm-tool bookmark-delete fa fa-trash-o" href="javascript:;"  rel:bf_bucket="delete_bookmark_confirm"></a>								<div class="clear"></div>								<div class="bookmark-delete-confirm bm-tool-track bf_dom" style="display: none;"><span>Are you sure?</span><a class="cancel-delete-bookmark bf_dom bm-tool-track" rel:bf_bucket="cancel_delete_bookmark">No</a><a class="delete-bookmark bf_dom bm-tool-track" rel:bf_bucket="delete_bookmark">Yes</a></div>							</div>',bookmark_item:'<article>											<header>												<div class="thumb-unit"><a href="'+BF_STATIC.web_root+'/#{username}/#{uri}" class="title" ><img src="#{image_root}#{image}" width="125" height="83" alt="" /></a></div>												<hgroup><h2><a href="'+BF_STATIC.web_root+'/#{username}/#{uri}" class="title" >#{title}</a></h2></hgroup>											</header>											<p class="small-meta"><span class="time-image icon"></span><span class="time-ago">Saved #{ago} ago</span></p>										</article>',bookmark_share:'<div class="bookmark-share-block bm-tool-track social_share_icons" style="display: none;" rel:bf_bucket="hide_bookmark_share" ><ul class="social_share_icons_list">						<li class="share_facebook"><i class = "fa" > &#xf09a;</i>								<img src="#{share_gif}" onload="sharing.buttons.facebook_share({\'replace\': this,\'url\': \'#{share_url}\',\'type\': \'#{type}\'});" />						</li>						<li class="share_twitter"><i class = "fa" > &#xf099;</i>								<img src="#{share_gif}" onload="sharing.buttons.twitter({\'replace\': this,\'type\': \'#{type}\',\'via\': \'#{via}\',\'url\': \'#{buzz_id}\',\'blurb\': \'#{blurb}\'});" />						</li>						<li class="share_email"><i class = "fa" > &#xf003;</i>							<a class="bm-tool-track" target="_self" href="mailto:?subject=#{blurb}&body=#{emailbody}"></a>						</li>						<li class="share_pinterest"><i class = "fa"> &#xf0d2;</i><img src="#{share_gif}" onload="sharing.buttons.pinterest({\'replace\': this,\'type\': \'longform\'});" />						</li>						<li class="share_google"><i class = "fa" > &#xf0d5;</i><img src="#{share_gif}" onload="sharing.buttons.googleplus({\'replace\': this,\'url\': \'#{share_url}\'});" />						</li>					</ul>				</div>',share_gif:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",bookmark_spinner:'<div id="bookmark_overlay"><div class="bookmarks-loader-content">Syncing bookmarks...</div><div class="bookmark-loader loader-6"></div></div>',bookmark_popup_container:'<div class="bookmark-white-overlay" style="display: none;"><div id="bookmark-popup" style="display: none;"><a href="javascript:;" class="bookmark-popup-close bf_dom fa fa-times" rel:bf_bucket="close_bookmark_popup" ></a><div class="bookmark-popup-content"></div></div></div>',bookmark_popups:{saved:'<div class="bmkp-title">Bookmark saved!</div><div class="bmkp-content">Your bookmarked stories are saved to your <a class="bookmark-acc-link">BuzzFeed account</a>.</div><div id="bookmarks-promo"><a href="/tools/mobile-ios">Download</a> the Buzzfeed app for<br />iOS or Android and sign in to<br />access your bookmarks on the go!</div>',login:'<div class="bmkp-title">See your bookmarks from anywhere!</div>							<div class="bmkp-content bkm-account"><div class="bmkp-icon"></div><div class="bmkp-text">Bookmarked stories are saved to your BuzzFeed account</div></div>							<div class="bmkp-content bml-app"><div class="bmkp-icon"></div><div class="bmkp-text">Save them for later or view them on<br />the go with the BuzzFeed app.<a href="/tools/mobile-ios" class="bf_dom" rel:gt_cat="MobileBuzzBookmark:pop-up" rel:gt_act="app-promo" >Download the app!</a></div></div>							<div class="bmkp-content bkm-share">								<a rel:gt_act="initial-fb-sign-header" rel:bf_bucket="signin_with_facebook" class="fb-button bf_dom" href="javascript:;"><div class="fb-icon">&nbsp;</div><div class="fb-label" id="initial_fb_text">'+local.t("Sign in with Facebook")+'</div></a>								<a rel:gt_act="googleplus-signin-header" rel:bf_bucket="gplus_login" onclick=""  class="bf-gplus-button bf_dom"><span id="g-signin-button"></span><div class="gplus-icon">&nbsp;</div><div class="gplus-label" id="initial_gplus_text"><span class="visually-hidden">'+local.t("Sign in with Google")+'</span></div></a></div>\n							<div class="bmkp-content bkm-another-signin"><a id="bookmark-more-signin" class="bf_dom"rel:bf_bucket="bookmark_more_signin">More Sign In Options</a></div>'}};this.init=function(){this.initHandlers();this.build()};this.initHandlers=function(){universal_dom.assign_handler({bucket:"add_bookmark",event:"click",handler:this.addBookmark.bind(this)});universal_dom.assign_handler({bucket:"close_bookmark_popup",event:"click",handler:this.closePopup.bind(this)});universal_dom.assign_handler({bucket:"gplus_login",event:"click",handler:this.gPlusLogin.bind(this)});universal_dom.assign_handler({bucket:"bookmark_more_signin",event:"click",handler:this.openMoreSignIn.bind(this)});universal_dom.assign_handler({bucket:"delete_bookmark_confirm",event:"click",handler:this.deleteBookmarkConfirm.bind(this)});universal_dom.assign_handler({bucket:"cancel_delete_bookmark",event:"click",handler:this.cancelDeleteBookmark.bind(this)});universal_dom.assign_handler({bucket:"delete_bookmark",event:"click",handler:this.deleteBookmark.bind(this)});universal_dom.assign_handler({bucket:"share_bookmark",event:"click",handler:this.shareBookmark.bind(this)});universal_dom.assign_handler({bucket:"hide_bookmark_promo",event:"click",handler:this.hideBookmarkPromo.bind(this)});universal_dom.assign_handler({bucket:"signin_with_facebook",event:"click",handler:this.onFacebookSignIn.bind(this)})};this.build=function(){this.user=new BF_User();var c=$.jStorage.get("bookmark_data");if(!c){c=this.defaultData(0)}if(this.user.isLoggedIn()&&c.userId!==this.user.getUserInfo().userid&&c.userId||!this.user.isLoggedIn()){c=this.defaultData(this.user.getUserInfo().userid)}this.setBookmarkUserData(c);if(BF_STATIC.tt_page=="User"&&document.location.pathname.match(/\/bookmarks/)){if(this.user.isLoggedIn()&&document.location.pathname.match(this.user.getUserInfo().username)){if(this.bookmarksData.showPromo){$("bookmarks-promo").show()}this.showUserBookmarks()}else{$("bookmark_overlay").hide();$("bookmarks-unauthorized").show();$("bookmarks-container").hide()}}else{if(BF_STATIC.tt_page=="Buzz"){this.showPostBookmarkButton("#share_control .horizontal-share-buttons");if($("inline_shares_box")){this.showPostBookmarkButton("#inline_shares_box .social_share_icons_list")}}else{if(BF_STATIC.tt_page=="Videos"){this.showPostBookmarkButton(".video-splash-share .bottom-share-buttons")}}}Event.observe($$(".video-splash-share .bookmark_share a")[0],"click",function(){b.addBookmark()});Event.observe($$("#bookmark-popup .bookmark-popup-close")[0],"click",function(){b.closePopup()});Event.observe($$("#bookmark-popup .fb-button")[0],"click",function(){b.onFacebookSignIn()})};this.showPostBookmarkButton=function(c){if(!$$(c).length){return}$$("body")[0].insert(this.templates.bookmark_popup_container);this.container=$$(c)[0];var d=this.container.select(".clear");if(!d.length){return}d[0].insert({before:this.templates.post_button});if(this.user.isLoggedIn()&&this.bookmarksData.addAfterLogin&&this.bookmarksData.addAfterLogin==BF_STATIC.campaignid){this.addBookmark(this.bookmarksData.addAfterLogin)}else{this.showTooltips("start")}universal_dom.update($s(".bookmark_share a.shareBtn"))};this.gPlusLogin=function(){if(typeof(gapi)!=undefined&&typeof(gapi.auth)!=undefined){b.initializedGoogleCallback=false;var c={clientid:BF_STATIC.google_plus_client_id,redirecturi:"postmessage",accesstype:"offline",cookiepolicy:"single_host_origin",callback:b.onGoogleSignIn,apppackagename:"com.buzzfeed.android"};gapi.auth.signIn(c)}};this.defaultData=function(c){return{userId:c,bookmarks:{},showPromo:true,hasBookmarks:false,addAfterLogin:0,sync_id:0}};this.openPopup=function(e){var c=$$("#bookmark-popup .bookmark-popup-content");if(!c.length){return false}c[0].innerHTML=this.templates.bookmark_popups[e];universal_dom.update($$(".bookmark-popup-close")[0]);$("bookmark-popup").className="";$("bookmark-popup").addClassName(e);$("bookmark-popup").show();$s(".bookmark-white-overlay").show();if(e==="login"){signin.wrap=$("bookmark-popup");signin.signin_page=false;universal_dom.update(c[0]);if(BF_STATIC.tt_page=="Videos"||BF_STATIC.language!=="en"){$s("#bookmark-popup .bf-gplus-button").hide()}}else{var d=BF_STATIC.web_root+"/bookmarks/"+this.user.getUserInfo().username;$s(".bookmark-acc-link").setAttribute("href",d)}};this.closePopup=function(){$("bookmark-popup").hide();$s(".bookmark-white-overlay").hide();this.removeSpinner()};this.openMoreSignIn=function(){this.closePopup();var c=$("header-signin").fire("click");c.signin_type="initial";c.location="header";c.keydown_disabled=true;c.mousedown_disabled=true;c.close_disabled=true;signin.open(c)};this.setBookmarkUserData=function(d){var e=false,c;for(c in d){if(d[c]!==this.bookmarksData[c]){this.bookmarksData[c]=d[c];e=true}}if(e){$.jStorage.set("bookmark_data",this.bookmarksData)}};this.showUserBookmarks=function(){new Ajax.Request(this.ajaxUrl,{method:"get",parameters:{sync_id:b.bookmarksData.sync_id},onComplete:function(d){if(d.status===304){b.drawBookmarkList(b.bookmarksData.bookmarks)}else{var c=d.responseText.evalJSON();if(c.success){b.setBookmarkUserData({bookmarks:c.bookmarks,sync_id:c.sync_id});b.drawBookmarkList(c.bookmarks)}else{console.error("added ajax error",c.error)}}}})};this.drawBookmarkList=function(c){if(c.length){$("bookmarks-count").innerHTML=c.length;var l=document.createElement("ul");l.className="flow bookmarks_list bf_dom";l.id="bookmarks_list";var h=new Template(b.templates.bookmark_item);var f=new Template(b.templates.bookmark_share);for(var e=0;e<c.length;e++){var g=c[e];var j=document.createElement("li");j.id="post-"+g.buzz_id;j.className="post bf_dom";j.setAttribute("rel:buzz_id",g.buzz_id);g.ago=this.getDateAgo(g.date_added);j.setAttribute("rel:ptool","true");j.setAttribute("rel:bf_bucket","post");var d="";var d=typeof JS_IMAGE_ROOT!="undefined"?JS_IMAGE_ROOT:BF_STATIC.image_root;if(typeof parent!="undefined"&&parent.BF_STATIC!="undefined"){d=typeof JS_IMAGE_ROOT!="undefined"?JS_IMAGE_ROOT:parent.BF_STATIC.image_root}if(g.image==null){g.image="/static/images/public/backgrounds/trans.gif"}g.image_root=d;var k={share_gif:b.templates.share_gif,type:"longform",buzz_id:g.buzz_id,via:"buzzfeed",blurb:g.title.replaceAll('"',"%22").replaceAll("&#39;","%27").replaceAll("&%2339;","%27").replaceAll("'","%27").replaceAll("&amp;","&#38;"),share_url:"http://"+document.domain+BF_STATIC.web_root+"/"+g.username+"/"+g.uri};k.emailbody=encodeURIComponent("Hey, I saw this on BuzzFeed and thought of you.")+"%0D%0A %0D%0A"+encodeURIComponent(k.share_url);j.innerHTML=h.evaluate(g)+this.templates.bmtools;j.select(".bmtools")[0].insert(f.evaluate(k));l.appendChild(j)}$("bookmarks-container").update(l);b.prepareTools()}else{$("bookmarks-count").innerHTML="0";$("bookmarks-container").insert('<div class="default-text">You don\'t have bookmarks yet</div>')}$("bookmark_overlay").hide()};this.getDateAgo=function(e){var d=new Date(0);d.setUTCSeconds(e);var f=Math.floor((new Date()-d)/1000);var c=Math.floor(f/31536000);if(c>=1){return c+" year"+(c>1?"s":"")}c=Math.floor(f/2592000);if(c>=1){return c+" month"+(c>1?"s":"")}c=Math.floor(f/86400);if(c>=1){return c+" day"+(c>1?"s":"")}c=Math.floor(f/3600);if(c>=1){return c+" hour"+(c>1?"s":"")}c=Math.floor(f/60);if(c>=1){return c+" minute"+(c>1?"s":"")}return Math.floor(f)+" seconds"};this.hideTooltips=function(){var c=this.container.select(".bookmark-tooltip");if(!c.length){return}c[0].hide()};this.showTooltips=function(d){var e=this.container.select(".bookmark-tooltip");if(!e.length){return false}e=e[0];e.innerHTML="";if(d=="start"){if(new Date(2014,8,15)>new Date()&&!this.bookmarksData.hasBookmarks){e.insert(this.templates.tooltips.new_tooltip);if(this.container.getAttribute("class")!=="social_share_icons_list"){e.show()}}}if(d=="bookmarked"){e.insert(this.templates.tooltips.bookmarked_tooltip);e.addClassName("bookmarked");e.removeClassName("standart-bookmarked");if(this.bookmarksData.hasBookmarks){this.container.select(".bookmark-tooltip .view-bookmarks")[0].hide();e.addClassName("standart-bookmarked")}else{var c=BF_STATIC.web_root+"/bookmarks/"+this.user.getUserInfo().username;this.container.select(".bookmark-tooltip .view-bookmarks")[0].setAttribute("href",c)}e.show()}};this.onFacebookSignIn=function(){this.spinner();bf_login.loggedInCallbacks.push(function(){b.removeSpinner();if(signin.spin_el){signin.spin_el.hide()}});facebook.FB_login(false,this.removeSpinner.bind(this))};this.onGoogleSignIn=function(c){if(!b.initializedGoogleCallback){signin.spinner()}if(!c.status["signed_in"]){if(signin.spin_el){signin.spin_el.hide()}b.closePopup();return}else{if(c.status["signed_in"]&&!b.initializedGoogleCallback){new Ajax.Request("/buzzfeed/_www_login",{method:"post",parameters:{googleplus:"1",otc:c.code},onSuccess:function(d){b.removeSpinner();gplus._result(d);b.closePopup()},onFailure:function(d){if(signin.spin_el){signin.spin_el.hide()}return}})}}b.initializedGoogleCallback=true};this.spinner=function(){var c=$("bookmark-popup");var d=c.select(".signin_spinner");if(d.length){d[0].show();return}var d=new Element("img",{"class":"signin_spinner",src:BF_STATIC.static_root+"/images/public/spinners/big_on_eee.gif?v="+BF_STATIC.version});c.insert(d)};this.removeSpinner=function(){var c=$$("#bookmark-popup .signin_spinner");if(c.length&&c[0].remove){c[0].remove()}};this.addBookmark=function(e){this.hideTooltips();if(this.user.isLoggedIn()){var d=0;if(BF_STATIC.tt_page=="Videos"){d=videopromo.buzz_id}else{d=BF_STATIC.campaignid}if(!d){console.error("add error - wrong buzz_id");return false}if(e&&typeof e!=="object"){d=e}else{if(e&&typeof e==="object"){var c=e.target.up("div").up();if(c!==this.container){this.container=c}}}new Ajax.Request(this.ajaxUrl,{method:"post",parameters:{buzz_id:d},onComplete:function(g){var f=g.responseText.evalJSON();if(f.success){if(b.maxBookmarkCount-f.bookmarks_remaining==1&&!b.bookmarksData.hasBookmarks){b.openPopup("saved")}b.showTooltips("bookmarked");b.setBookmarkUserData({hasBookmarks:true,addAfterLogin:0});b.container.down(".bookmark_share").addClassName("disabled")}else{console.error("added ajax error",f.error)}}})}else{b.setBookmarkUserData({addAfterLogin:BF_STATIC.campaignid});this.openPopup("login")}};this.shareBookmark=function(c){this.safeVisibilityToggle($(c.currentTarget).up(".bmtools").select(".bookmark-delete-confirm"),false);this.safeVisibilityToggle($(c.currentTarget).up("div").select(".bookmark-share-block"),true);return false};this.safeVisibilityToggle=function(c,d){if(!c.length){return false}if(d){c[0].show()}else{c[0].hide()}};this.hideBookmarkShare=function(c){$(c).hide()};this.hideBookmarkDeleteDialog=function(c){$(c).hide()};this.deleteBookmarkConfirm=function(c){this.safeVisibilityToggle($(c.currentTarget).up(".bmtools").select(".bookmark-delete-confirm"),true);this.safeVisibilityToggle($(c.currentTarget).up("div").select(".bookmark-share-block"),false);return false};this.cancelDeleteBookmark=function(c){this.safeVisibilityToggle($(c.currentTarget).up(".bmtools").select(".bookmark-delete-confirm"),false);return false};this.deleteBookmark=function(d){$(d.currentTarget).up(".bmtools").hide();var c=$(d.currentTarget).getAttribute("rel:buzz_id");if(!c){console.error("delete error - wrong buzz_id");return false}this.safeVisibilityToggle($(d.currentTarget).up(".bmtools").select(".bookmark-delete-confirm"),false);new Ajax.Request(this.ajaxUrl,{method:"post",parameters:{buzz_id:c,_method:"delete"},onComplete:function(f){var e=f.responseText.evalJSON();if(e.success){$("post-"+c).remove();$("bookmarks-count").innerHTML=$("bookmarks-count").innerHTML-1}else{console.error("delete ajax error",e.error)}}});return false};this.prepareTools=function(){var c=$$("#bookmarks_list > li");if(c.length){c.each(function(d){d.select(".bm-tool-track").each(function(e){e.setAttribute("rel:buzz_id",d.getAttribute("rel:buzz_id"));universal_dom.update(e)});d.select(".inlineShareBtn").each(function(e){universal_dom.update(e)});d.select(".shareBtn").each(function(e){universal_dom.update(e)})})}$$(".bookmark-delete-confirm").each(function(d){$(d).observe("mouseleave",function(){b.hideBookmarkDeleteDialog(d)})});$$(".bookmark-share-block").each(function(d){$(d).observe("mouseleave",function(){b.hideBookmarkShare(d)})})};this.hideBookmarkPromo=function(){$("bookmarks-promo").hide();this.setBookmarkUserData({showPromo:false})}};if(BF_STATIC.tt_page=="User"||BF_STATIC.tt_page=="Buzz"||BF_STATIC.tt_page=="Videos"){var bookmarks=new Bookmarks;BuzzLoader.register(bookmarks.init.bind(bookmarks),1)}var BF_share_bar_scroller=function(){var b=this,c;this.showShareBar=function(){if(!c){return}var d=$s(".upper-share-buttons"),j=$s(".bottom_shares"),g=document.viewport.getScrollOffsets().top,e=g+BF_UTIL.browser.dimensions.height(),h=d.cumulativeOffset().top+d.offsetHeight,f=j.cumulativeOffset().top;if(g>=h){if(e<=f){c.addClassName("social_share_icons_sticky_pos")}else{c.removeClassName("social_share_icons_sticky_pos")}}else{c.removeClassName("social_share_icons_sticky_pos")}};this.init=function(){c=$("inline_shares_box");b.showShareBar()}};var share_bar_scroller=new BF_share_bar_scroller();window.onscroll=share_bar_scroller.showShareBar;BuzzLoader.register(share_bar_scroller.init,5);